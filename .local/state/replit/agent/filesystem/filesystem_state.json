{"file_contents":{"3123-main/client/src/index.css":{"content":"@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n/* LIGHT MODE */\n:root {\n  --button-outline: rgba(0,0,0, .10);\n  --badge-outline: rgba(0,0,0, .05);\n  --opaque-button-border-intensity: -8;\n  --elevate-1: rgba(0,0,0, .03);\n  --elevate-2: rgba(0,0,0, .08);\n  --background: 0 0% 100%;\n  --foreground: 0 0% 9%;\n  --border: 0 0% 91%;\n  --card: 0 0% 98%;\n  --card-foreground: 0 0% 9%;\n  --card-border: 0 0% 95%;\n  --sidebar: 0 0% 96%;\n  --sidebar-foreground: 0 0% 9%;\n  --sidebar-border: 0 0% 93%;\n  --sidebar-primary: 47 96% 48%;\n  --sidebar-primary-foreground: 0 0% 100%;\n  --sidebar-accent: 0 0% 92%;\n  --sidebar-accent-foreground: 0 0% 9%;\n  --sidebar-ring: 47 96% 48%;\n  --popover: 0 0% 94%;\n  --popover-foreground: 0 0% 9%;\n  --popover-border: 0 0% 91%;\n  --primary: 47 96% 48%;\n  --primary-foreground: 0 0% 100%;\n  --secondary: 0 0% 90%;\n  --secondary-foreground: 0 0% 9%;\n  --muted: 0 3% 88%;\n  --muted-foreground: 0 0% 35%;\n  --accent: 48 8% 86%;\n  --accent-foreground: 0 0% 9%;\n  --destructive: 0 72% 51%;\n  --destructive-foreground: 0 0% 100%;\n  --input: 0 0% 75%;\n  --ring: 47 96% 48%;\n  --chart-1: 47 96% 35%;\n  --chart-2: 25 95% 45%;\n  --chart-3: 200 90% 40%;\n  --chart-4: 280 65% 45%;\n  --chart-5: 140 70% 35%;\n  --font-sans: Inter, -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, sans-serif;\n  --font-serif: Georgia, serif;\n  --font-mono: JetBrains Mono, Menlo, monospace;\n  --radius: .5rem;\n  --shadow-2xs: 0px 2px 0px 0px hsl(0 0% 0% / 0.00);\n  --shadow-xs: 0px 2px 0px 0px hsl(0 0% 0% / 0.00);\n  --shadow-sm: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 1px 2px -1px hsl(0 0% 0% / 0.00);\n  --shadow: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 1px 2px -1px hsl(0 0% 0% / 0.00);\n  --shadow-md: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 2px 4px -1px hsl(0 0% 0% / 0.00);\n  --shadow-lg: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 4px 6px -1px hsl(0 0% 0% / 0.00);\n  --shadow-xl: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 8px 10px -1px hsl(0 0% 0% / 0.00);\n  --shadow-2xl: 0px 2px 0px 0px hsl(0 0% 0% / 0.00);\n  --tracking-normal: 0em;\n  --spacing: 0.25rem;\n\n/* Fallback for older browsers */\n  --sidebar-primary-border: hsl(var(--sidebar-primary));\n  --sidebar-primary-border: hsl(from hsl(var(--sidebar-primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --sidebar-accent-border: hsl(var(--sidebar-accent));\n  --sidebar-accent-border: hsl(from hsl(var(--sidebar-accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --primary-border: hsl(var(--primary));\n  --primary-border: hsl(from hsl(var(--primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --secondary-border: hsl(var(--secondary));\n  --secondary-border: hsl(from hsl(var(--secondary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --muted-border: hsl(var(--muted));\n  --muted-border: hsl(from hsl(var(--muted)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --accent-border: hsl(var(--accent));\n  --accent-border: hsl(from hsl(var(--accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --destructive-border: hsl(var(--destructive));\n  --destructive-border: hsl(from hsl(var(--destructive)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n}\n\n.dark {\n  --button-outline: rgba(255,255,255, .10);\n  --badge-outline: rgba(255,255,255, .05);\n  --opaque-button-border-intensity: 9;\n  --elevate-1: rgba(255,255,255, .04);\n  --elevate-2: rgba(255,255,255, .09);\n  --background: 0 0% 7%;\n  --foreground: 0 0% 98%;\n  --border: 0 0% 16%;\n  --card: 0 0% 9%;\n  --card-foreground: 0 0% 98%;\n  --card-border: 0 0% 12%;\n  --sidebar: 0 0% 11%;\n  --sidebar-foreground: 0 0% 98%;\n  --sidebar-border: 0 0% 14%;\n  --sidebar-primary: 47 96% 48%;\n  --sidebar-primary-foreground: 0 0% 100%;\n  --sidebar-accent: 0 0% 15%;\n  --sidebar-accent-foreground: 0 0% 98%;\n  --sidebar-ring: 47 96% 48%;\n  --popover: 0 0% 13%;\n  --popover-foreground: 0 0% 98%;\n  --popover-border: 0 0% 16%;\n  --primary: 47 96% 48%;\n  --primary-foreground: 0 0% 100%;\n  --secondary: 0 0% 17%;\n  --secondary-foreground: 0 0% 98%;\n  --muted: 0 3% 19%;\n  --muted-foreground: 0 0% 70%;\n  --accent: 48 8% 21%;\n  --accent-foreground: 0 0% 98%;\n  --destructive: 0 72% 51%;\n  --destructive-foreground: 0 0% 100%;\n  --input: 0 0% 30%;\n  --ring: 47 96% 48%;\n  --chart-1: 47 96% 65%;\n  --chart-2: 25 95% 70%;\n  --chart-3: 200 90% 65%;\n  --chart-4: 280 65% 70%;\n  --chart-5: 140 70% 65%;\n  --shadow-2xs: 0px 2px 0px 0px hsl(0 0% 0% / 0.00);\n  --shadow-xs: 0px 2px 0px 0px hsl(0 0% 0% / 0.00);\n  --shadow-sm: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 1px 2px -1px hsl(0 0% 0% / 0.00);\n  --shadow: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 1px 2px -1px hsl(0 0% 0% / 0.00);\n  --shadow-md: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 2px 4px -1px hsl(0 0% 0% / 0.00);\n  --shadow-lg: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 4px 6px -1px hsl(0 0% 0% / 0.00);\n  --shadow-xl: 0px 2px 0px 0px hsl(0 0% 0% / 0.00), 0px 8px 10px -1px hsl(0 0% 0% / 0.00);\n  --shadow-2xl: 0px 2px 0px 0px hsl(0 0% 0% / 0.00);\n\n/* Fallback for older browsers */\n  --sidebar-primary-border: hsl(var(--sidebar-primary));\n  --sidebar-primary-border: hsl(from hsl(var(--sidebar-primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --sidebar-accent-border: hsl(var(--sidebar-accent));\n  --sidebar-accent-border: hsl(from hsl(var(--sidebar-accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --primary-border: hsl(var(--primary));\n  --primary-border: hsl(from hsl(var(--primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --secondary-border: hsl(var(--secondary));\n  --secondary-border: hsl(from hsl(var(--secondary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --muted-border: hsl(var(--muted));\n  --muted-border: hsl(from hsl(var(--muted)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --accent-border: hsl(var(--accent));\n  --accent-border: hsl(from hsl(var(--accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --destructive-border: hsl(var(--destructive));\n  --destructive-border: hsl(from hsl(var(--destructive)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n}\n\n@layer base {\n  * {\n    @apply border-border;\n  }\n\n  body {\n    @apply font-sans antialiased bg-background text-foreground;\n  }\n}\n\n@layer utilities {\n  input[type=\"search\"]::-webkit-search-cancel-button {\n    @apply hidden;\n  }\n\n  [contenteditable][data-placeholder]:empty::before {\n    content: attr(data-placeholder);\n    color: hsl(var(--muted-foreground));\n    pointer-events: none;\n  }\n\n  .no-default-hover-elevate {}\n\n  .no-default-active-elevate {}\n\n  .toggle-elevate::before,\n  .toggle-elevate-2::before {\n    content: \"\";\n    pointer-events: none;\n    position: absolute;\n    inset: 0px;\n    border-radius: inherit;\n    z-index: -1;\n  }\n\n  .toggle-elevate.toggle-elevated::before {\n    background-color: var(--elevate-2);\n  }\n\n  .border.toggle-elevate::before {\n    inset: -1px;\n  }\n\n  .hover-elevate:not(.no-default-hover-elevate),\n  .active-elevate:not(.no-default-active-elevate),\n  .hover-elevate-2:not(.no-default-hover-elevate),\n  .active-elevate-2:not(.no-default-active-elevate) {\n    position: relative;\n    z-index: 0;\n  }\n\n  .hover-elevate:not(.no-default-hover-elevate)::after,\n  .active-elevate:not(.no-default-active-elevate)::after,\n  .hover-elevate-2:not(.no-default-hover-elevate)::after,\n  .active-elevate-2:not(.no-default-active-elevate)::after {\n    content: \"\";\n    pointer-events: none;\n    position: absolute;\n    inset: 0px;\n    border-radius: inherit;\n    z-index: 999;\n  }\n\n  .hover-elevate:hover:not(.no-default-hover-elevate)::after,\n  .active-elevate:active:not(.no-default-active-elevate)::after {\n    background-color: var(--elevate-1);\n  }\n\n  .hover-elevate-2:hover:not(.no-default-hover-elevate)::after,\n  .active-elevate-2:active:not(.no-default-active-elevate)::after {\n    background-color: var(--elevate-2);\n  }\n\n  .border.hover-elevate:not(.no-hover-interaction-elevate)::after,\n  .border.active-elevate:not(.no-active-interaction-elevate)::after,\n  .border.hover-elevate-2:not(.no-hover-interaction-elevate)::after,\n  .border.active-elevate-2:not(.no-active-interaction-elevate)::after,\n  .border.hover-elevate:not(.no-hover-interaction-elevate)::after {\n    inset: -1px;\n  }\n}\n","size_bytes":8780},"client/src/lib/use-user.ts":{"content":"import { useContext } from \"react\";\nimport { UserContext, type UserContextType } from \"./user-provider\";\n\nexport function useUser(): UserContextType {\n  const context = useContext(UserContext);\n  if (!context) {\n    throw new Error(\"useUser must be used within UserProvider\");\n  }\n  return context;\n}\n","size_bytes":301},"client/src/main.tsx":{"content":"import { StrictMode } from \"react\";\nimport { createRoot } from \"react-dom/client\";\nimport App from \"./App\";\nimport \"./index.css\";\n\nconst root = document.getElementById(\"root\");\n\nif (!root) {\n  throw new Error(\"Failed to find root element\");\n}\n\ncreateRoot(root).render(\n  <StrictMode>\n    <App />\n  </StrictMode>\n);\n","size_bytes":315},"client/src/components/ui/accordion.tsx":{"content":"import * as React from \"react\"\nimport * as AccordionPrimitive from \"@radix-ui/react-accordion\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Accordion = AccordionPrimitive.Root\n\nconst AccordionItem = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <AccordionPrimitive.Item\n    ref={ref}\n    className={cn(\"border-b\", className)}\n    {...props}\n  />\n))\nAccordionItem.displayName = \"AccordionItem\"\n\nconst AccordionTrigger = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Header className=\"flex\">\n    <AccordionPrimitive.Trigger\n      ref={ref}\n      className={cn(\n        \"flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <ChevronDown className=\"h-4 w-4 shrink-0 transition-transform duration-200\" />\n    </AccordionPrimitive.Trigger>\n  </AccordionPrimitive.Header>\n))\nAccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName\n\nconst AccordionContent = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Content\n    ref={ref}\n    className=\"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down\"\n    {...props}\n  >\n    <div className={cn(\"pb-4 pt-0\", className)}>{children}</div>\n  </AccordionPrimitive.Content>\n))\n\nAccordionContent.displayName = AccordionPrimitive.Content.displayName\n\nexport { Accordion, AccordionItem, AccordionTrigger, AccordionContent }\n","size_bytes":1977},"client/src/components/ui/dialog.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogHeader.displayName = \"DialogHeader\"\n\nconst DialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogFooter.displayName = \"DialogFooter\"\n\nconst DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogClose,\n  DialogTrigger,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n}\n","size_bytes":3848},"client/src/components/ui/hover-card.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as HoverCardPrimitive from \"@radix-ui/react-hover-card\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst HoverCard = HoverCardPrimitive.Root\n\nconst HoverCardTrigger = HoverCardPrimitive.Trigger\n\nconst HoverCardContent = React.forwardRef<\n  React.ElementRef<typeof HoverCardPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof HoverCardPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <HoverCardPrimitive.Content\n    ref={ref}\n    align={align}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-hover-card-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nHoverCardContent.displayName = HoverCardPrimitive.Content.displayName\n\nexport { HoverCard, HoverCardTrigger, HoverCardContent }\n","size_bytes":1251},"client/src/components/ui/sheet.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SheetPrimitive from \"@radix-ui/react-dialog\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Sheet = SheetPrimitive.Root\n\nconst SheetTrigger = SheetPrimitive.Trigger\n\nconst SheetClose = SheetPrimitive.Close\n\nconst SheetPortal = SheetPrimitive.Portal\n\nconst SheetOverlay = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nSheetOverlay.displayName = SheetPrimitive.Overlay.displayName\n\nconst sheetVariants = cva(\n  \"fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500\",\n  {\n    variants: {\n      side: {\n        top: \"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\n        bottom:\n          \"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\n        left: \"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\n        right:\n          \"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\n      },\n    },\n    defaultVariants: {\n      side: \"right\",\n    },\n  }\n)\n\ninterface SheetContentProps\n  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,\n    VariantProps<typeof sheetVariants> {}\n\nconst SheetContent = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Content>,\n  SheetContentProps\n>(({ side = \"right\", className, children, ...props }, ref) => (\n  <SheetPortal>\n    <SheetOverlay />\n    <SheetPrimitive.Content\n      ref={ref}\n      className={cn(sheetVariants({ side }), className)}\n      {...props}\n    >\n      {children}\n      <SheetPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </SheetPrimitive.Close>\n    </SheetPrimitive.Content>\n  </SheetPortal>\n))\nSheetContent.displayName = SheetPrimitive.Content.displayName\n\nconst SheetHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetHeader.displayName = \"SheetHeader\"\n\nconst SheetFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetFooter.displayName = \"SheetFooter\"\n\nconst SheetTitle = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold text-foreground\", className)}\n    {...props}\n  />\n))\nSheetTitle.displayName = SheetPrimitive.Title.displayName\n\nconst SheetDescription = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nSheetDescription.displayName = SheetPrimitive.Description.displayName\n\nexport {\n  Sheet,\n  SheetPortal,\n  SheetOverlay,\n  SheetTrigger,\n  SheetClose,\n  SheetContent,\n  SheetHeader,\n  SheetFooter,\n  SheetTitle,\n  SheetDescription,\n}\n","size_bytes":4281},"3123-main/client/src/pages/admin-dashboard.tsx":{"content":"import { useState } from \"react\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription } from \"@/components/ui/dialog\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { Key, Users, Ban, AlertTriangle, Award, Copy, Check } from \"lucide-react\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport type { User, AccessCode } from \"@shared/schema\";\n\nconst adminId = \"admin1\";\n\nexport default function AdminDashboard() {\n  const { toast } = useToast();\n  const [showCodeDialog, setShowCodeDialog] = useState(false);\n  const [generatedCode, setGeneratedCode] = useState<string | null>(null);\n  const [copied, setCopied] = useState(false);\n  const [showWarningDialog, setShowWarningDialog] = useState(false);\n  const [showBonusDialog, setShowBonusDialog] = useState(false);\n  const [selectedDriver, setSelectedDriver] = useState<User | null>(null);\n  const [warningText, setWarningText] = useState(\"\");\n  const [bonusText, setBonusText] = useState(\"\");\n\n  const { data: drivers = [], isLoading } = useQuery<User[]>({\n    queryKey: [\"/api/admin/drivers\"],\n    refetchInterval: 5000,\n  });\n\n  const generateCodeMutation = useMutation({\n    mutationFn: async (): Promise<AccessCode> => {\n      return await apiRequest(\"POST\", \"/api/admin/generate-code\", { adminId });\n    },\n    onSuccess: (code: AccessCode) => {\n      setGeneratedCode(code.code);\n      setShowCodeDialog(true);\n      setCopied(false);\n      toast({\n        title: \"Код згенеровано\",\n        description: `Код доступу: ${code.code}`,\n      });\n    },\n  });\n\n  const blockDriverMutation = useMutation({\n    mutationFn: async (driverId: string) => {\n      return await apiRequest(\"POST\", `/api/admin/drivers/${driverId}/block`, {});\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/drivers\"] });\n    },\n  });\n\n  const addWarningMutation = useMutation({\n    mutationFn: async ({ driverId, text }: { driverId: string; text: string }) => {\n      return await apiRequest(\"POST\", `/api/admin/drivers/${driverId}/warning`, { text });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/drivers\"] });\n      toast({\n        title: \"Попередження видано\",\n        description: `Попередження додано для ${selectedDriver?.name}`,\n      });\n      setShowWarningDialog(false);\n      setWarningText(\"\");\n    },\n  });\n\n  const addBonusMutation = useMutation({\n    mutationFn: async ({ driverId, text }: { driverId: string; text: string }) => {\n      return await apiRequest(\"POST\", `/api/admin/drivers/${driverId}/bonus`, { text });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/drivers\"] });\n      toast({\n        title: \"Бонус видано\",\n        description: `Бонус додано для ${selectedDriver?.name}`,\n      });\n      setShowBonusDialog(false);\n      setBonusText(\"\");\n    },\n  });\n\n  const handleCopyCode = () => {\n    if (generatedCode) {\n      navigator.clipboard.writeText(generatedCode);\n      setCopied(true);\n      setTimeout(() => setCopied(false), 2000);\n      toast({\n        title: \"Скопійовано\",\n        description: \"Код доступу скопійовано в буфер обміну\",\n      });\n    }\n  };\n\n  const handleBlockDriver = (driver: User) => {\n    blockDriverMutation.mutate(driver.id);\n    toast({\n      title: driver.isBlocked ? \"Розблоковано\" : \"Заблоковано\",\n      description: `Водій ${driver.name} ${driver.isBlocked ? \"розблокований\" : \"заблокований\"}`,\n    });\n  };\n\n  const handleAddWarning = () => {\n    if (selectedDriver && warningText) {\n      addWarningMutation.mutate({ driverId: selectedDriver.id, text: warningText });\n    }\n  };\n\n  const handleAddBonus = () => {\n    if (selectedDriver && bonusText) {\n      addBonusMutation.mutate({ driverId: selectedDriver.id, text: bonusText });\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <div className=\"sticky top-0 z-10 bg-card border-b border-card-border\">\n        <div className=\"max-w-4xl mx-auto px-4 py-3\">\n          <h1 className=\"text-lg font-semibold\">Панель адміністратора</h1>\n          <p className=\"text-xs text-muted-foreground\">Керування водіями та кодами доступу</p>\n        </div>\n      </div>\n\n      <div className=\"max-w-4xl mx-auto p-4\">\n        <Tabs defaultValue=\"codes\" className=\"space-y-6\">\n          <TabsList className=\"grid w-full grid-cols-2\">\n            <TabsTrigger value=\"codes\" data-testid=\"tab-codes\">\n              <Key className=\"w-4 h-4 mr-2\" />\n              Коди доступу\n            </TabsTrigger>\n            <TabsTrigger value=\"drivers\" data-testid=\"tab-drivers\">\n              <Users className=\"w-4 h-4 mr-2\" />\n              Водії\n            </TabsTrigger>\n          </TabsList>\n\n          <TabsContent value=\"codes\" className=\"space-y-4\">\n            <Card className=\"border-card-border\">\n              <CardHeader>\n                <CardTitle>Генерація коду доступу</CardTitle>\n                <CardDescription>\n                  Створіть одноразовий код для реєстрації нового водія\n                </CardDescription>\n              </CardHeader>\n              <CardContent>\n                <Button\n                  className=\"w-full h-14 text-lg font-semibold\"\n                  onClick={() => generateCodeMutation.mutate()}\n                  disabled={generateCodeMutation.isPending}\n                  data-testid=\"button-generate-code\"\n                >\n                  <Key className=\"w-5 h-5 mr-2\" />\n                  {generateCodeMutation.isPending ? \"Генерація...\" : \"Згенерувати код\"}\n                </Button>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          <TabsContent value=\"drivers\" className=\"space-y-3\">\n            {isLoading ? (\n              <div className=\"space-y-3\">\n                {[1, 2].map((i) => (\n                  <Card key={i} className=\"border-card-border\">\n                    <CardContent className=\"pt-6\">\n                      <div className=\"flex items-start gap-4\">\n                        <Skeleton className=\"w-12 h-12 rounded-full\" />\n                        <div className=\"flex-1 space-y-2\">\n                          <Skeleton className=\"h-5 w-32\" />\n                          <Skeleton className=\"h-4 w-40\" />\n                        </div>\n                      </div>\n                    </CardContent>\n                  </Card>\n                ))}\n              </div>\n            ) : drivers.length === 0 ? (\n              <div className=\"flex flex-col items-center justify-center py-16 text-center\">\n                <div className=\"w-16 h-16 mb-4 rounded-full bg-muted flex items-center justify-center\">\n                  <Users className=\"w-8 h-8 text-muted-foreground opacity-40\" />\n                </div>\n                <p className=\"text-base text-muted-foreground\">Немає зареєстрованих водіїв</p>\n              </div>\n            ) : (\n              drivers.map((driver) => (\n                <Card key={driver.id} className=\"border-card-border\" data-testid={`card-driver-${driver.id}`}>\n                  <CardContent className=\"pt-6\">\n                    <div className=\"flex items-start gap-4\">\n                      <Avatar className=\"w-12 h-12 flex-shrink-0\">\n                        <AvatarImage src={driver.telegramAvatarUrl || \"\"} alt={driver.name || \"\"} />\n                        <AvatarFallback className=\"bg-primary text-primary-foreground\">\n                          {driver.name?.charAt(0) || \"?\"}\n                        </AvatarFallback>\n                      </Avatar>\n                      <div className=\"flex-1 space-y-3\">\n                        <div>\n                          <div className=\"font-semibold flex items-center gap-2 flex-wrap\">\n                            {driver.name}\n                            {driver.isBlocked && (\n                              <Badge variant=\"destructive\" className=\"rounded-full px-2 py-0.5 text-xs\">\n                                <Ban className=\"w-3 h-3 mr-1\" />\n                                Заблокований\n                              </Badge>\n                            )}\n                          </div>\n                          <div className=\"text-sm text-muted-foreground\">{driver.phone}</div>\n                        </div>\n\n                        {((driver.warnings?.length ?? 0) > 0 || (driver.bonuses?.length ?? 0) > 0) && (\n                          <div className=\"flex flex-wrap gap-2\">\n                            {(driver.warnings || []).map((warning, i) => (\n                              <Badge\n                                key={i}\n                                variant=\"outline\"\n                                className=\"rounded-full px-2 py-1 text-xs\"\n                              >\n                                <AlertTriangle className=\"w-3 h-3 mr-1 text-destructive\" />\n                                {warning}\n                              </Badge>\n                            ))}\n                            {(driver.bonuses || []).map((bonus, i) => (\n                              <Badge\n                                key={i}\n                                variant=\"outline\"\n                                className=\"rounded-full px-2 py-1 text-xs\"\n                              >\n                                <Award className=\"w-3 h-3 mr-1 text-primary\" />\n                                {bonus}\n                              </Badge>\n                            ))}\n                          </div>\n                        )}\n\n                        <div className=\"flex flex-wrap gap-2\">\n                          <Button\n                            size=\"sm\"\n                            variant={driver.isBlocked ? \"default\" : \"destructive\"}\n                            onClick={() => handleBlockDriver(driver)}\n                            data-testid={`button-block-${driver.id}`}\n                            disabled={blockDriverMutation.isPending}\n                          >\n                            <Ban className=\"w-3 h-3 mr-1\" />\n                            {driver.isBlocked ? \"Розблокувати\" : \"Заблокувати\"}\n                          </Button>\n                          <Button\n                            size=\"sm\"\n                            variant=\"outline\"\n                            onClick={() => {\n                              setSelectedDriver(driver);\n                              setShowWarningDialog(true);\n                            }}\n                            data-testid={`button-warning-${driver.id}`}\n                          >\n                            <AlertTriangle className=\"w-3 h-3 mr-1\" />\n                            Попередження\n                          </Button>\n                          <Button\n                            size=\"sm\"\n                            variant=\"outline\"\n                            onClick={() => {\n                              setSelectedDriver(driver);\n                              setShowBonusDialog(true);\n                            }}\n                            data-testid={`button-bonus-${driver.id}`}\n                          >\n                            <Award className=\"w-3 h-3 mr-1\" />\n                            Бонус\n                          </Button>\n                        </div>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              ))\n            )}\n          </TabsContent>\n        </Tabs>\n      </div>\n\n      <Dialog open={showCodeDialog} onOpenChange={setShowCodeDialog}>\n        <DialogContent className=\"max-w-md\">\n          <DialogHeader>\n            <DialogTitle>Код доступу згенеровано</DialogTitle>\n            <DialogDescription>\n              Передайте цей код новому водію для реєстрації\n            </DialogDescription>\n          </DialogHeader>\n          <div className=\"space-y-4 py-4\">\n            <div className=\"bg-muted rounded-lg p-6 text-center\">\n              <div className=\"text-3xl font-mono font-bold tracking-wider text-primary\">\n                {generatedCode}\n              </div>\n            </div>\n            <Button\n              className=\"w-full h-12\"\n              onClick={handleCopyCode}\n              data-testid=\"button-copy-code\"\n            >\n              {copied ? (\n                <>\n                  <Check className=\"w-4 h-4 mr-2\" />\n                  Скопійовано\n                </>\n              ) : (\n                <>\n                  <Copy className=\"w-4 h-4 mr-2\" />\n                  Копіювати код\n                </>\n              )}\n            </Button>\n          </div>\n        </DialogContent>\n      </Dialog>\n\n      <Dialog open={showWarningDialog} onOpenChange={setShowWarningDialog}>\n        <DialogContent className=\"max-w-md\">\n          <DialogHeader>\n            <DialogTitle>Видати попередження</DialogTitle>\n            <DialogDescription>\n              Додайте попередження для водія {selectedDriver?.name}\n            </DialogDescription>\n          </DialogHeader>\n          <div className=\"space-y-4 py-4\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"warning-text\">Текст попередження</Label>\n              <Input\n                id=\"warning-text\"\n                placeholder=\"Наприклад: Запізнення на замовлення\"\n                value={warningText}\n                onChange={(e) => setWarningText(e.target.value)}\n                data-testid=\"input-warning-text\"\n                className=\"h-12\"\n              />\n            </div>\n            <Button\n              className=\"w-full h-12\"\n              onClick={handleAddWarning}\n              disabled={!warningText || addWarningMutation.isPending}\n              data-testid=\"button-submit-warning\"\n            >\n              {addWarningMutation.isPending ? \"Обробка...\" : \"Додати попередження\"}\n            </Button>\n          </div>\n        </DialogContent>\n      </Dialog>\n\n      <Dialog open={showBonusDialog} onOpenChange={setShowBonusDialog}>\n        <DialogContent className=\"max-w-md\">\n          <DialogHeader>\n            <DialogTitle>Видати бонус</DialogTitle>\n            <DialogDescription>\n              Додайте позитивну відмітку для водія {selectedDriver?.name}\n            </DialogDescription>\n          </DialogHeader>\n          <div className=\"space-y-4 py-4\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"bonus-text\">Текст бонусу</Label>\n              <Input\n                id=\"bonus-text\"\n                placeholder=\"Наприклад: Відмінне обслуговування клієнта\"\n                value={bonusText}\n                onChange={(e) => setBonusText(e.target.value)}\n                data-testid=\"input-bonus-text\"\n                className=\"h-12\"\n              />\n            </div>\n            <Button\n              className=\"w-full h-12\"\n              onClick={handleAddBonus}\n              disabled={!bonusText || addBonusMutation.isPending}\n              data-testid=\"button-submit-bonus\"\n            >\n              {addBonusMutation.isPending ? \"Обробка...\" : \"Додати бонус\"}\n            </Button>\n          </div>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}\n","size_bytes":16401},"3123-main/client/src/lib/use-user.ts":{"content":"import { useContext } from \"react\";\nimport type { UserRole } from \"@shared/schema\";\nimport { UserContext } from \"./user-provider\";\n\nexport interface UserContextType {\n  userId: string;\n  role: UserRole;\n  setRole: (role: UserRole) => void;\n}\n\nexport function useUser(): UserContextType {\n  const context = useContext(UserContext);\n  if (!context) {\n    throw new Error(\"useUser must be used within UserProvider\");\n  }\n  return context;\n}\n","size_bytes":438},"replit.md":{"content":"# Telegram Taxi Service Web App\n\n## Overview\n\nThis is a Telegram-based taxi service platform that enables ride-hailing, cargo transport, courier delivery, and towing services. The application features a role-based system with three distinct user types: Clients (who request rides), Drivers (who fulfill orders), and Administrators (who manage the platform). Built as a Telegram Web App, it provides a mobile-first experience optimized for quick interactions and real-time order management.\n\nThe platform implements a bidding system where drivers can propose prices for orders, and clients can accept or reject these proposals. The system includes real-time chat functionality, order tracking, and administrative tools for driver management through access codes.\n\n## User Preferences\n\nPreferred communication style: Simple, everyday language.\n\n## System Architecture\n\n### Frontend Architecture\n\n**Framework**: React 18 with TypeScript, using Vite as the build tool and development server.\n\n**UI Component System**: Shadcn/ui components built on Radix UI primitives with Tailwind CSS for styling. The design follows a Material Design-inspired approach with mobile-first, thumb-friendly interactions. The component library uses the \"new-york\" style variant with custom color theming based on HSL values.\n\n**Routing**: Wouter for lightweight client-side routing, supporting distinct paths for different user roles:\n- Client views: `/`, `/order/:type`, `/chat/:orderId`\n- Driver views: `/driver`, `/driver/profile`, `/chat/:orderId`\n- Admin views: `/admin`\n- Role selection: `/role-selector`\n\n**State Management**: \n- React Context API for global user state (role and userId management via `UserProvider`)\n- TanStack Query (React Query) for server state management with automatic caching and refetching\n- Local component state with React hooks for UI interactions\n\n**Form Handling**: React Hook Form with Zod schema validation for type-safe form management across order creation, driver registration, and profile updates.\n\n**Design System**: Custom Tailwind configuration with:\n- Custom border radius values (9px, 6px, 3px)\n- HSL-based color system with CSS variables for theming\n- Elevation classes for interactive elements\n- Typography hierarchy using Inter (primary) and JetBrains Mono (monospace)\n- Mobile-first responsive breakpoints\n\n### Backend Architecture\n\n**Runtime**: Node.js with Express.js framework, using ESM modules throughout.\n\n**API Design**: RESTful API with the following endpoint structure:\n- User management: `/api/users/:id`, `/api/users/register-driver`\n- Order management: `/api/orders/active`, `/api/orders/:orderId/accept`, `/api/orders/:orderId/propose-bid`, `/api/orders/:orderId/respond-bid`\n- Admin operations: `/api/admin/drivers`, `/api/admin/generate-code`\n- Chat: `/api/chat/:orderId`\n\n**Data Storage Strategy**: The application uses an abstraction layer (`IStorage` interface) allowing multiple storage implementations:\n- Development: In-memory storage (`MemStorage`) for rapid prototyping\n- Production-ready: Configured for PostgreSQL via Drizzle ORM with Neon serverless adapter\n\n**Session Management**: Express sessions with `connect-pg-simple` for PostgreSQL-backed session storage.\n\n**Development/Production Split**: \n- Development mode (`index-dev.ts`): Integrates Vite middleware for HMR and instant client updates\n- Production mode (`index-prod.ts`): Serves pre-built static assets from `dist/public`\n\n### Data Model\n\n**Database Schema** (Drizzle ORM with PostgreSQL):\n\n1. **Users Table**: Stores all platform users with role-based differentiation\n   - Primary key: `id` (Telegram user ID)\n   - Fields: `role` (client/driver/admin), `name`, `phone`, `telegramAvatarUrl`, `isBlocked`, `warnings[]`, `bonuses[]`\n\n2. **Orders Table**: Central entity for all service requests\n   - Primary key: `orderId` (UUID)\n   - Fields: `type` (taxi/cargo/courier/towing), `clientId`, `driverId`, `from`, `to`, `comment`, `requiredDetail`, `status`, `driverBidPrice`, `isTaken`, `proposalAttempts[]`, `createdAt`\n   - Status flow: new → bidding → accepted → in_progress → completed (or rejected_by_client)\n\n3. **Access Codes Table**: Admin-generated codes for driver registration\n   - Primary key: `code`\n   - Fields: `isUsed`, `issuedBy`, `usedBy`, `createdAt`\n\n4. **Chat Messages Table**: Real-time messaging between clients and drivers\n   - Primary key: `id` (UUID)\n   - Fields: `orderId`, `senderId`, `message`, `createdAt`\n\n**Order Workflow**:\n1. Client creates order (status: \"new\")\n2. Driver accepts order (status: \"accepted\", driver assigned)\n3. Driver proposes bid price (status: \"bidding\")\n4. Client responds to bid (accepts → \"in_progress\" or rejects → \"rejected_by_client\")\n5. Order completion (status: \"completed\")\n\n### Authentication & Authorization\n\n**Telegram Integration**: The application is designed to run as a Telegram Web App, leveraging Telegram's built-in authentication through the `telegram-web-app.js` SDK. User identity is derived from Telegram user data.\n\n**Role-Based Access Control**: \n- Roles are stored in the users table and managed through the UserContext\n- Driver registration requires a valid access code issued by administrators\n- Client role is the default for new users\n- Admin role is pre-configured in the system\n\n**Access Code System**: Administrators generate single-use codes that drivers must provide during registration along with their name and phone number.\n\n## External Dependencies\n\n### Third-Party Services\n\n**Telegram Bot API**: Core platform for user authentication and Web App hosting. The application script is loaded via `telegram.org/js/telegram-web-app.js`.\n\n**Database Service**: Configured for Neon serverless PostgreSQL (`@neondatabase/serverless`), a cloud-native PostgreSQL platform optimized for serverless environments. Connection managed via `DATABASE_URL` environment variable.\n\n### Key Libraries & Tools\n\n**UI Framework**:\n- React 18 with TypeScript\n- Radix UI primitives (15+ component primitives for accessibility)\n- Tailwind CSS for utility-first styling\n- Lucide React for iconography\n\n**Data & State Management**:\n- TanStack Query v5 for server state synchronization\n- React Hook Form with Zod resolvers for form validation\n- Drizzle ORM for type-safe database queries\n- Drizzle-Zod for schema-to-Zod validation conversion\n\n**Development Tools**:\n- Vite for fast development builds and HMR\n- TypeScript for type safety across the stack\n- ESBuild for production bundling\n- Drizzle Kit for database migrations\n\n**Build & Deployment**:\n- Express serves built static assets in production\n- Vite dev server with middleware integration for development\n- PostgreSQL for production data persistence\n- In-memory storage fallback for development/testing\n\n### Environment Configuration\n\n**Required Environment Variables**:\n- `DATABASE_URL`: PostgreSQL connection string for Neon or compatible database\n- `NODE_ENV`: Controls development vs production behavior\n\n**Optional Replit-Specific Plugins** (development only):\n- `@replit/vite-plugin-runtime-error-modal`: Error overlay for development\n- `@replit/vite-plugin-cartographer`: Development tooling\n- `@replit/vite-plugin-dev-banner`: Development indicator banner\n\n### Font Assets\n\n**Google Fonts**:\n- Inter: Primary UI font (weights 400, 500, 600, 700)\n- JetBrains Mono: Monospace font for codes and IDs (weights 400, 500, 600)\n\nFonts are preconnected for performance optimization.","size_bytes":7431},"client/src/components/ui/form.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport {\n  Controller,\n  FormProvider,\n  useFormContext,\n  type ControllerProps,\n  type FieldPath,\n  type FieldValues,\n} from \"react-hook-form\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\n\nconst Form = FormProvider\n\ntype FormFieldContextValue<\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n> = {\n  name: TName\n}\n\nconst FormFieldContext = React.createContext<FormFieldContextValue>(\n  {} as FormFieldContextValue\n)\n\nconst FormField = <\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n>({\n  ...props\n}: ControllerProps<TFieldValues, TName>) => {\n  return (\n    <FormFieldContext.Provider value={{ name: props.name }}>\n      <Controller {...props} />\n    </FormFieldContext.Provider>\n  )\n}\n\nconst useFormField = () => {\n  const fieldContext = React.useContext(FormFieldContext)\n  const itemContext = React.useContext(FormItemContext)\n  const { getFieldState, formState } = useFormContext()\n\n  const fieldState = getFieldState(fieldContext.name, formState)\n\n  if (!fieldContext) {\n    throw new Error(\"useFormField should be used within <FormField>\")\n  }\n\n  const { id } = itemContext\n\n  return {\n    id,\n    name: fieldContext.name,\n    formItemId: `${id}-form-item`,\n    formDescriptionId: `${id}-form-item-description`,\n    formMessageId: `${id}-form-item-message`,\n    ...fieldState,\n  }\n}\n\ntype FormItemContextValue = {\n  id: string\n}\n\nconst FormItemContext = React.createContext<FormItemContextValue>(\n  {} as FormItemContextValue\n)\n\nconst FormItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const id = React.useId()\n\n  return (\n    <FormItemContext.Provider value={{ id }}>\n      <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\n    </FormItemContext.Provider>\n  )\n})\nFormItem.displayName = \"FormItem\"\n\nconst FormLabel = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  const { error, formItemId } = useFormField()\n\n  return (\n    <Label\n      ref={ref}\n      className={cn(error && \"text-destructive\", className)}\n      htmlFor={formItemId}\n      {...props}\n    />\n  )\n})\nFormLabel.displayName = \"FormLabel\"\n\nconst FormControl = React.forwardRef<\n  React.ElementRef<typeof Slot>,\n  React.ComponentPropsWithoutRef<typeof Slot>\n>(({ ...props }, ref) => {\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\n\n  return (\n    <Slot\n      ref={ref}\n      id={formItemId}\n      aria-describedby={\n        !error\n          ? `${formDescriptionId}`\n          : `${formDescriptionId} ${formMessageId}`\n      }\n      aria-invalid={!!error}\n      {...props}\n    />\n  )\n})\nFormControl.displayName = \"FormControl\"\n\nconst FormDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => {\n  const { formDescriptionId } = useFormField()\n\n  return (\n    <p\n      ref={ref}\n      id={formDescriptionId}\n      className={cn(\"text-sm text-muted-foreground\", className)}\n      {...props}\n    />\n  )\n})\nFormDescription.displayName = \"FormDescription\"\n\nconst FormMessage = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, children, ...props }, ref) => {\n  const { error, formMessageId } = useFormField()\n  const body = error ? String(error?.message ?? \"\") : children\n\n  if (!body) {\n    return null\n  }\n\n  return (\n    <p\n      ref={ref}\n      id={formMessageId}\n      className={cn(\"text-sm font-medium text-destructive\", className)}\n      {...props}\n    >\n      {body}\n    </p>\n  )\n})\nFormMessage.displayName = \"FormMessage\"\n\nexport {\n  useFormField,\n  Form,\n  FormItem,\n  FormLabel,\n  FormControl,\n  FormDescription,\n  FormMessage,\n  FormField,\n}\n","size_bytes":4120},"client/src/components/ui/label.tsx":{"content":"import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n","size_bytes":710},"client/src/pages/chat-page.tsx":{"content":"import { ArrowLeft } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { useLocation } from \"wouter\";\nimport Chat from \"@/components/chat\";\n\nexport default function ChatPage({ params }: { params: { orderId: string } }) {\n  const [, setLocation] = useLocation();\n\n  return (\n    <div className=\"h-screen flex flex-col bg-background\">\n      <div className=\"sticky top-0 z-10 bg-card border-b border-card-border\">\n        <div className=\"max-w-2xl mx-auto px-4 py-3 flex items-center gap-3\">\n          <Button\n            variant=\"ghost\"\n            size=\"icon\"\n            onClick={() => setLocation(\"/driver\")}\n            data-testid=\"button-back\"\n          >\n            <ArrowLeft className=\"w-5 h-5\" />\n          </Button>\n        </div>\n      </div>\n      <div className=\"flex-1 overflow-hidden\">\n        <div className=\"max-w-2xl mx-auto h-full\">\n          <Chat\n            orderId={params.orderId}\n            currentUserId=\"driver1\"\n            otherUserName=\"Іван Петренко\"\n          />\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":1081},"client/src/components/ui/navigation-menu.tsx":{"content":"import * as React from \"react\"\nimport * as NavigationMenuPrimitive from \"@radix-ui/react-navigation-menu\"\nimport { cva } from \"class-variance-authority\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst NavigationMenu = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative z-10 flex max-w-max flex-1 items-center justify-center\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <NavigationMenuViewport />\n  </NavigationMenuPrimitive.Root>\n))\nNavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName\n\nconst NavigationMenuList = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.List\n    ref={ref}\n    className={cn(\n      \"group flex flex-1 list-none items-center justify-center space-x-1\",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName\n\nconst NavigationMenuItem = NavigationMenuPrimitive.Item\n\nconst navigationMenuTriggerStyle = cva(\n  \"group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[state=open]:text-accent-foreground data-[state=open]:bg-accent/50 data-[state=open]:hover:bg-accent data-[state=open]:focus:bg-accent\"\n)\n\nconst NavigationMenuTrigger = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Trigger\n    ref={ref}\n    className={cn(navigationMenuTriggerStyle(), \"group\", className)}\n    {...props}\n  >\n    {children}{\" \"}\n    <ChevronDown\n      className=\"relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180\"\n      aria-hidden=\"true\"\n    />\n  </NavigationMenuPrimitive.Trigger>\n))\nNavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName\n\nconst NavigationMenuContent = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto \",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName\n\nconst NavigationMenuLink = NavigationMenuPrimitive.Link\n\nconst NavigationMenuViewport = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>\n>(({ className, ...props }, ref) => (\n  <div className={cn(\"absolute left-0 top-full flex justify-center\")}>\n    <NavigationMenuPrimitive.Viewport\n      className={cn(\n        \"origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  </div>\n))\nNavigationMenuViewport.displayName =\n  NavigationMenuPrimitive.Viewport.displayName\n\nconst NavigationMenuIndicator = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Indicator\n    ref={ref}\n    className={cn(\n      \"top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in\",\n      className\n    )}\n    {...props}\n  >\n    <div className=\"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md\" />\n  </NavigationMenuPrimitive.Indicator>\n))\nNavigationMenuIndicator.displayName =\n  NavigationMenuPrimitive.Indicator.displayName\n\nexport {\n  navigationMenuTriggerStyle,\n  NavigationMenu,\n  NavigationMenuList,\n  NavigationMenuItem,\n  NavigationMenuContent,\n  NavigationMenuTrigger,\n  NavigationMenuLink,\n  NavigationMenuIndicator,\n  NavigationMenuViewport,\n}\n","size_bytes":5128},"3123-main/server/index-prod.ts":{"content":"import fs from \"node:fs\";\nimport path from \"node:path\";\nimport { type Server } from \"node:http\";\n\nimport express, { type Express } from \"express\";\nimport runApp from \"./app\";\n\nexport async function serveStatic(app: Express, _server: Server) {\n  const distPath = path.resolve(import.meta.dirname, \"public\");\n\n  if (!fs.existsSync(distPath)) {\n    throw new Error(\n      `Could not find the build directory: ${distPath}, make sure to build the client first`,\n    );\n  }\n\n  app.use(express.static(distPath));\n\n  // fall through to index.html if the file doesn't exist\n  app.use(\"*\", (_req, res) => {\n    res.sendFile(path.resolve(distPath, \"index.html\"));\n  });\n}\n\n(async () => {\n  await runApp(serveStatic);\n})();\n","size_bytes":712},"client/src/components/ui/toast.tsx":{"content":"import * as React from \"react\"\nimport * as ToastPrimitives from \"@radix-ui/react-toast\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ToastProvider = ToastPrimitives.Provider\n\nconst ToastViewport = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Viewport>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Viewport\n    ref={ref}\n    className={cn(\n      \"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\",\n      className\n    )}\n    {...props}\n  />\n))\nToastViewport.displayName = ToastPrimitives.Viewport.displayName\n\nconst toastVariants = cva(\n  \"group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full\",\n  {\n    variants: {\n      variant: {\n        default: \"border bg-background text-foreground\",\n        destructive:\n          \"destructive group border-destructive bg-destructive text-destructive-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Toast = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &\n    VariantProps<typeof toastVariants>\n>(({ className, variant, ...props }, ref) => {\n  return (\n    <ToastPrimitives.Root\n      ref={ref}\n      className={cn(toastVariants({ variant }), className)}\n      {...props}\n    />\n  )\n})\nToast.displayName = ToastPrimitives.Root.displayName\n\nconst ToastAction = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Action>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Action\n    ref={ref}\n    className={cn(\n      \"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive\",\n      className\n    )}\n    {...props}\n  />\n))\nToastAction.displayName = ToastPrimitives.Action.displayName\n\nconst ToastClose = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Close>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Close\n    ref={ref}\n    className={cn(\n      \"absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600\",\n      className\n    )}\n    toast-close=\"\"\n    {...props}\n  >\n    <X className=\"h-4 w-4\" />\n  </ToastPrimitives.Close>\n))\nToastClose.displayName = ToastPrimitives.Close.displayName\n\nconst ToastTitle = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Title>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Title\n    ref={ref}\n    className={cn(\"text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nToastTitle.displayName = ToastPrimitives.Title.displayName\n\nconst ToastDescription = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Description>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Description\n    ref={ref}\n    className={cn(\"text-sm opacity-90\", className)}\n    {...props}\n  />\n))\nToastDescription.displayName = ToastPrimitives.Description.displayName\n\ntype ToastProps = React.ComponentPropsWithoutRef<typeof Toast>\n\ntype ToastActionElement = React.ReactElement<typeof ToastAction>\n\nexport {\n  type ToastProps,\n  type ToastActionElement,\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastClose,\n  ToastAction,\n}\n","size_bytes":4845},"postcss.config.js":{"content":"export default {\n  plugins: {\n    tailwindcss: {\n      config: './tailwind.config.ts',\n    },\n    autoprefixer: {},\n  },\n};\n","size_bytes":124},"client/src/pages/driver-dashboard.tsx":{"content":"import { useEffect } from \"react\";\nimport { Card, CardContent, CardHeader } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { MapPin, Navigation, DollarSign, User, Plus, ArrowLeft } from \"lucide-react\";\nimport { useLocation } from \"wouter\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useUser } from \"@/lib/use-user\";\nimport type { Order } from \"@shared/schema\";\n\nconst orderTypeLabels = {\n  taxi: \"Таксі\",\n  cargo: \"Вантажне\",\n  courier: \"Кур'єр\",\n  towing: \"Евакуатор\",\n};\n\nexport default function DriverDashboard() {\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n  const { userId: driverId, role } = useUser();\n\n  // Защита маршруту - тільки водії можуть тут бути\n  useEffect(() => {\n    if (role !== \"driver\") {\n      setLocation(\"/\");\n    }\n  }, [role, setLocation]);\n  const { data: orders = [], isLoading } = useQuery<Order[]>({\n    queryKey: [\"/api/orders/active\"],\n    refetchInterval: 3000,\n  });\n\n  const acceptOrderMutation = useMutation({\n    mutationFn: async (orderId: string) => {\n      return await apiRequest(\"POST\", `/api/orders/${orderId}/accept`, { driverId });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/orders/active\"] });\n      toast({\n        title: \"Замовлення прийнято\",\n        description: \"Клієнт буде повідомлений про прийняття замовлення\",\n      });\n    },\n    onError: () => {\n      toast({\n        title: \"Помилка\",\n        description: \"Не вдалося прийняти замовлення\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleAcceptOrder = (order: Order) => {\n    acceptOrderMutation.mutate(order.orderId);\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <div className=\"sticky top-0 z-10 bg-card border-b border-card-border\">\n        <div className=\"max-w-2xl mx-auto px-4 py-3\">\n          <div className=\"flex items-center justify-between gap-4\">\n            <Button\n              variant=\"ghost\"\n              size=\"icon\"\n              onClick={() => setLocation(\"/\")}\n              data-testid=\"button-back\"\n            >\n              <ArrowLeft className=\"w-5 h-5\" />\n            </Button>\n            <div className=\"flex-1\">\n              <h1 className=\"text-lg font-semibold\">Активні замовлення</h1>\n              <p className=\"text-xs text-muted-foreground\">Виберіть замовлення для роботи</p>\n            </div>\n            <Button\n              variant=\"ghost\"\n              size=\"icon\"\n              onClick={() => setLocation(\"/driver/profile\")}\n              data-testid=\"button-profile\"\n            >\n              <User className=\"w-5 h-5\" />\n            </Button>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"max-w-2xl mx-auto p-4 space-y-4\">\n        <Button\n          className=\"w-full\"\n          variant=\"outline\"\n          onClick={() => setLocation(\"/\")}\n          data-testid=\"button-create-order-as-client\"\n        >\n          <Plus className=\"w-4 h-4 mr-2\" />\n          Викликати таксі для себе\n        </Button>\n\n        {isLoading ? (\n          <div className=\"space-y-3\">\n            {[1, 2, 3].map((i) => (\n              <Card key={i} className=\"border-card-border\">\n                <CardHeader className=\"space-y-3\">\n                  <Skeleton className=\"h-6 w-24\" />\n                  <Skeleton className=\"h-4 w-full\" />\n                  <Skeleton className=\"h-4 w-full\" />\n                </CardHeader>\n                <CardContent>\n                  <Skeleton className=\"h-12 w-full\" />\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        ) : orders.length === 0 ? (\n          <div className=\"flex flex-col items-center justify-center py-16 text-center\">\n            <div className=\"w-16 h-16 mb-4 rounded-full bg-muted flex items-center justify-center\">\n              <MapPin className=\"w-8 h-8 text-muted-foreground opacity-40\" />\n            </div>\n            <p className=\"text-base text-muted-foreground\">Немає активних замовлень</p>\n            <p className=\"text-sm text-muted-foreground mt-1\">Нові замовлення з'являться тут</p>\n          </div>\n        ) : (\n          <div className=\"space-y-3\">\n            {orders.map((order) => (\n              <Card\n                key={order.orderId}\n                className=\"border-card-border\"\n                data-testid={`card-order-${order.orderId}`}\n              >\n                <CardHeader className=\"space-y-3 pb-3\">\n                  <div className=\"flex items-start justify-between gap-2\">\n                    <Badge variant=\"secondary\" className=\"rounded-full px-3 py-1 text-xs font-semibold\">\n                      {orderTypeLabels[order.type]}\n                    </Badge>\n                    {order.price && (\n                      <Badge variant=\"default\" className=\"rounded-full px-3 py-1 text-xs gap-1\">\n                        <DollarSign className=\"w-3 h-3\" />\n                        {order.price} грн\n                      </Badge>\n                    )}\n                  </div>\n                  <div className=\"space-y-2\">\n                    <div className=\"flex items-start gap-2\">\n                      <MapPin className=\"w-4 h-4 text-primary mt-0.5 flex-shrink-0\" />\n                      <div className=\"text-sm flex-1\">\n                        <span className=\"font-medium\">Звідки:</span> {order.from}\n                      </div>\n                    </div>\n                    <div className=\"flex items-start gap-2\">\n                      <Navigation className=\"w-4 h-4 text-primary mt-0.5 flex-shrink-0\" />\n                      <div className=\"text-sm flex-1\">\n                        <span className=\"font-medium\">Куди:</span> {order.to}\n                      </div>\n                    </div>\n                    {order.distanceKm && (\n                      <div className=\"text-sm text-muted-foreground\">\n                        <span className=\"font-medium\">Відстань:</span> {order.distanceKm} км\n                      </div>\n                    )}\n                  </div>\n                  {order.requiredDetail && (\n                    <div className=\"text-sm bg-muted rounded-lg p-3\">\n                      <span className=\"font-medium\">Деталі:</span> {order.requiredDetail}\n                    </div>\n                  )}\n                  {order.comment && (\n                    <div className=\"text-sm text-muted-foreground\">\n                      <span className=\"font-medium\">Коментар:</span> {order.comment}\n                    </div>\n                  )}\n                </CardHeader>\n                <CardContent className=\"pt-0\">\n                  <Button\n                    className=\"w-full h-12 font-semibold\"\n                    onClick={() => handleAcceptOrder(order)}\n                    data-testid={`button-accept-${order.orderId}`}\n                    disabled={acceptOrderMutation.isPending}\n                  >\n                    {acceptOrderMutation.isPending ? \"Обробка...\" : \"Прийняти замовлення\"}\n                  </Button>\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n","size_bytes":7723},"3123-main/server/app.ts":{"content":"import { type Server } from \"node:http\";\n\nimport express, {\n  type Express,\n  type Request,\n  Response,\n  NextFunction,\n} from \"express\";\n\nimport { registerRoutes } from \"./routes\";\n\nexport function log(message: string, source = \"express\") {\n  const formattedTime = new Date().toLocaleTimeString(\"en-US\", {\n    hour: \"numeric\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    hour12: true,\n  });\n\n  console.log(`${formattedTime} [${source}] ${message}`);\n}\n\nexport const app = express();\n\ndeclare module 'http' {\n  interface IncomingMessage {\n    rawBody: unknown\n  }\n}\napp.use(express.json({\n  verify: (req, _res, buf) => {\n    req.rawBody = buf;\n  }\n}));\napp.use(express.urlencoded({ extended: false }));\n\napp.use((req, res, next) => {\n  const start = Date.now();\n  const path = req.path;\n  let capturedJsonResponse: Record<string, any> | undefined = undefined;\n\n  const originalResJson = res.json;\n  res.json = function (bodyJson, ...args) {\n    capturedJsonResponse = bodyJson;\n    return originalResJson.apply(res, [bodyJson, ...args]);\n  };\n\n  res.on(\"finish\", () => {\n    const duration = Date.now() - start;\n    if (path.startsWith(\"/api\")) {\n      let logLine = `${req.method} ${path} ${res.statusCode} in ${duration}ms`;\n      if (capturedJsonResponse) {\n        logLine += ` :: ${JSON.stringify(capturedJsonResponse)}`;\n      }\n\n      if (logLine.length > 80) {\n        logLine = logLine.slice(0, 79) + \"…\";\n      }\n\n      log(logLine);\n    }\n  });\n\n  next();\n});\n\nexport default async function runApp(\n  setup: (app: Express, server: Server) => Promise<void>,\n) {\n  const server = await registerRoutes(app);\n\n  app.use((err: any, _req: Request, res: Response, _next: NextFunction) => {\n    const status = err.status || err.statusCode || 500;\n    const message = err.message || \"Internal Server Error\";\n\n    res.status(status).json({ message });\n    throw err;\n  });\n\n  // importantly run the final setup after setting up all the other routes so\n  // the catch-all route doesn't interfere with the other routes\n  await setup(app, server);\n\n  // ALWAYS serve the app on the port specified in the environment variable PORT\n  // Other ports are firewalled. Default to 5000 if not specified.\n  // this serves both the API and the client.\n  // It is the only port that is not firewalled.\n  const port = parseInt(process.env.PORT || '5000', 10);\n  server.listen({\n    port,\n    host: \"0.0.0.0\",\n    reusePort: true,\n  }, () => {\n    log(`serving on port ${port}`);\n  });\n}\n","size_bytes":2482},"client/src/components/ui/alert-dialog.tsx":{"content":"import * as React from \"react\"\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\n\nconst AlertDialogTitle = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold\", className)}\n    {...props}\n  />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action\n    ref={ref}\n    className={cn(buttonVariants(), className)}\n    {...props}\n  />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(\n      buttonVariants({ variant: \"outline\" }),\n      \"mt-2 sm:mt-0\",\n      className\n    )}\n    {...props}\n  />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}\n","size_bytes":4420},"server/storage.ts":{"content":"import {\n  type User,\n  type InsertUser,\n  type Order,\n  type InsertOrder,\n  type AccessCode,\n  type InsertAccessCode,\n  type ChatMessage,\n  type InsertChatMessage,\n  type Rating,\n  type InsertRating,\n} from \"@shared/schema\";\nimport { randomUUID } from \"crypto\";\n\nexport interface IStorage {\n  // User methods\n  getUser(id: string): Promise<User | undefined>;\n  createUser(user: InsertUser): Promise<User>;\n  updateUser(id: string, updates: Partial<User>): Promise<User | undefined>;\n  getAllDrivers(): Promise<User[]>;\n  registerDriverWithCode(userId: string, code: string, name: string, phone: string): Promise<User | null>;\n\n  // Order methods\n  getOrder(orderId: string): Promise<Order | undefined>;\n  getAllOrders(): Promise<Order[]>;\n  getActiveOrders(): Promise<Order[]>;\n  getOrdersByClient(clientId: string): Promise<Order[]>;\n  getOrdersByDriver(driverId: string): Promise<Order[]>;\n  createOrder(order: InsertOrder): Promise<Order>;\n  updateOrder(orderId: string, updates: Partial<Order>): Promise<Order | undefined>;\n  acceptOrder(orderId: string, driverId: string): Promise<Order | undefined>;\n\n  // Access Code methods\n  generateAccessCode(issuedBy: string): Promise<AccessCode>;\n  validateAccessCode(code: string): Promise<AccessCode | undefined>;\n  markCodeAsUsed(code: string, userId: string): Promise<boolean>;\n\n  // Chat methods\n  getChatMessages(orderId: string): Promise<ChatMessage[]>;\n  sendChatMessage(message: InsertChatMessage): Promise<ChatMessage>;\n\n  // Rating methods\n  rateOrder(orderId: string, stars: number, comment?: string): Promise<boolean>;\n  getDriverStats(driverId: string): Promise<{completedOrders: number, totalRatings: number, averageRating: number}>;\n  getDriverBadges(driverId: string): Promise<string | null>;\n\n  // Rate limit methods\n  getRateLimitTimestamps(userId: string): Promise<number[]>;\n  saveRateLimitTimestamps(userId: string, timestamps: number[]): Promise<void>;\n  cleanExpiredRateLimits(): Promise<void>;\n}\n\nexport class MemStorage implements IStorage {\n  private users: Map<string, User>;\n  private orders: Map<string, Order>;\n  private accessCodes: Map<string, AccessCode>;\n  private chatMessages: Map<string, ChatMessage[]>;\n  private ratings: Map<string, Rating>;\n  private rateLimits: Map<string, number[]>;\n\n  constructor() {\n    this.users = new Map();\n    this.orders = new Map();\n    this.accessCodes = new Map();\n    this.chatMessages = new Map();\n    this.ratings = new Map();\n    this.rateLimits = new Map();\n\n    // Create default admins\n    this.users.set(\"admin1\", {\n      id: \"admin1\",\n      role: \"admin\",\n      name: \"Адміністратор\",\n      phone: \"+380501111111\",\n      telegramAvatarUrl: null,\n      isBlocked: false,\n      warnings: [],\n      bonuses: [],\n    });\n\n    // Add Telegram admin\n    this.users.set(\"7677921905\", {\n      id: \"7677921905\",\n      role: \"admin\",\n      name: \"Адміністратор\",\n      phone: null,\n      telegramAvatarUrl: null,\n      isBlocked: false,\n      warnings: [],\n      bonuses: [],\n    });\n  }\n\n  // User methods\n  async getUser(id: string): Promise<User | undefined> {\n    return this.users.get(id);\n  }\n\n  async createUser(insertUser: InsertUser): Promise<User> {\n    const user: User = {\n      ...insertUser,\n      isBlocked: false,\n      warnings: [],\n      bonuses: [],\n    };\n    this.users.set(user.id, user);\n    return user;\n  }\n\n  async updateUser(id: string, updates: Partial<User>): Promise<User | undefined> {\n    const user = this.users.get(id);\n    if (!user) return undefined;\n\n    const updatedUser = { ...user, ...updates };\n    this.users.set(id, updatedUser);\n    return updatedUser;\n  }\n\n  async getAllDrivers(): Promise<User[]> {\n    return Array.from(this.users.values()).filter((user) => user.role === \"driver\");\n  }\n\n  async registerDriverWithCode(\n    userId: string,\n    code: string,\n    name: string,\n    phone: string\n  ): Promise<User | null> {\n    const accessCode = await this.validateAccessCode(code);\n    if (!accessCode || accessCode.isUsed) {\n      return null;\n    }\n\n    // Get or create user with driver role\n    let user = await this.getUser(userId);\n    if (!user) {\n      user = await this.createUser({\n        id: userId,\n        role: \"driver\",\n        name,\n        phone,\n        telegramAvatarUrl: null,\n      });\n    } else {\n      // Update existing user to driver role\n      user = await this.updateUser(userId, {\n        role: \"driver\",\n        name,\n        phone,\n      });\n    }\n\n    if (user) {\n      await this.markCodeAsUsed(code, userId);\n    }\n\n    return user ?? null;\n  }\n\n  // Order methods\n  async getOrder(orderId: string): Promise<Order | undefined> {\n    return this.orders.get(orderId);\n  }\n\n  async getAllOrders(): Promise<Order[]> {\n    return Array.from(this.orders.values());\n  }\n\n  async getActiveOrders(): Promise<Order[]> {\n    return Array.from(this.orders.values()).filter(\n      (order) => order.status === \"pending\"\n    );\n  }\n\n  async getOrdersByClient(clientId: string): Promise<Order[]> {\n    return Array.from(this.orders.values()).filter((order) => order.clientId === clientId);\n  }\n\n  async getOrdersByDriver(driverId: string): Promise<Order[]> {\n    return Array.from(this.orders.values()).filter((order) => order.driverId === driverId);\n  }\n\n  async createOrder(insertOrder: InsertOrder): Promise<Order> {\n    const orderId = randomUUID();\n    const order: Order = {\n      orderId,\n      ...insertOrder,\n      status: \"pending\",\n      driverId: null,\n      createdAt: new Date(),\n    };\n    this.orders.set(orderId, order);\n    return order;\n  }\n\n  async updateOrder(orderId: string, updates: Partial<Order>): Promise<Order | undefined> {\n    const order = this.orders.get(orderId);\n    if (!order) return undefined;\n\n    const updatedOrder = { ...order, ...updates };\n    this.orders.set(orderId, updatedOrder);\n    return updatedOrder;\n  }\n\n  async acceptOrder(orderId: string, driverId: string): Promise<Order | undefined> {\n    const order = this.orders.get(orderId);\n    if (!order || order.status !== \"pending\") return undefined;\n\n    const driver = await this.getUser(driverId);\n    if (!driver || driver.role !== \"driver\" || driver.isBlocked) {\n      return undefined;\n    }\n\n    const updatedOrder = {\n      ...order,\n      driverId,\n      status: \"accepted\" as const,\n    };\n    this.orders.set(orderId, updatedOrder);\n    return updatedOrder;\n  }\n\n  // Access Code methods\n  async generateAccessCode(issuedBy: string): Promise<AccessCode> {\n    let code: string;\n    let attempts = 0;\n    const maxAttempts = 10;\n\n    do {\n      code = Math.random().toString(36).substring(2, 8).toUpperCase();\n      attempts++;\n      if (attempts >= maxAttempts) {\n        code = randomUUID().substring(0, 8).toUpperCase();\n        break;\n      }\n    } while (this.accessCodes.has(code));\n\n    const accessCode: AccessCode = {\n      code,\n      isUsed: false,\n      issuedBy,\n      usedBy: null,\n      createdAt: new Date(),\n    };\n    this.accessCodes.set(code, accessCode);\n    return accessCode;\n  }\n\n  async validateAccessCode(code: string): Promise<AccessCode | undefined> {\n    return this.accessCodes.get(code);\n  }\n\n  async markCodeAsUsed(code: string, userId: string): Promise<boolean> {\n    const accessCode = this.accessCodes.get(code);\n    if (!accessCode || accessCode.isUsed) return false;\n\n    const updatedCode = {\n      ...accessCode,\n      isUsed: true,\n      usedBy: userId,\n    };\n    this.accessCodes.set(code, updatedCode);\n    return true;\n  }\n\n  // Chat methods\n  async getChatMessages(orderId: string): Promise<ChatMessage[]> {\n    return this.chatMessages.get(orderId) || [];\n  }\n\n  async sendChatMessage(insertMessage: InsertChatMessage): Promise<ChatMessage> {\n    const id = randomUUID();\n    const message: ChatMessage = {\n      id,\n      ...insertMessage,\n      createdAt: new Date(),\n    };\n\n    const messages = this.chatMessages.get(insertMessage.orderId) || [];\n    messages.push(message);\n    this.chatMessages.set(insertMessage.orderId, messages);\n\n    return message;\n  }\n\n  // Rating methods\n  async rateOrder(orderId: string, stars: number, comment?: string): Promise<boolean> {\n    const order = this.orders.get(orderId);\n    if (!order || order.status !== \"completed\" || !order.driverId) {\n      return false;\n    }\n\n    // Перевірка чи замовлення вже оцінено\n    const existingRating = Array.from(this.ratings.values()).find(\n      (rating) => rating.orderId === orderId\n    );\n    if (existingRating) {\n      return false;\n    }\n\n    const normalizedStars = Math.min(5, Math.max(1, Math.floor(stars)));\n    const ratingId = randomUUID();\n    const rating: Rating = {\n      id: ratingId,\n      orderId,\n      driverId: order.driverId,\n      stars: normalizedStars,\n      comment: comment || null,\n      createdAt: new Date(),\n    };\n\n    this.ratings.set(ratingId, rating);\n    return true;\n  }\n\n  async getDriverStats(driverId: string): Promise<{completedOrders: number, totalRatings: number, averageRating: number}> {\n    const completedOrders = Array.from(this.orders.values()).filter(\n      (order) => order.driverId === driverId && order.status === \"completed\"\n    );\n\n    const driverRatings = Array.from(this.ratings.values()).filter(\n      (rating) => rating.driverId === driverId\n    );\n\n    const totalRatings = driverRatings.length;\n    const averageRating = totalRatings > 0\n      ? driverRatings.reduce((sum, r) => sum + r.stars, 0) / totalRatings\n      : 0;\n\n    return {\n      completedOrders: completedOrders.length,\n      totalRatings,\n      averageRating: Math.round(averageRating * 10) / 10,\n    };\n  }\n\n  async getDriverBadges(driverId: string): Promise<string | null> {\n    const stats = await this.getDriverStats(driverId);\n    const badges: string[] = [];\n\n    if (stats.averageRating >= 4.8) badges.push('⭐ Топ-водій');\n    if (stats.completedOrders >= 100) badges.push('🏆 Легенда');\n    if (stats.completedOrders >= 50) badges.push('🔥 Активний');\n    if (stats.completedOrders >= 20 && stats.averageRating >= 4.5) badges.push('💎 Преміум');\n    if (stats.totalRatings >= 50 && stats.averageRating === 5.0) badges.push('⚡ Ідеальний');\n\n    return badges.length > 0 ? badges.join(' ') : null;\n  }\n\n  // Rate limit methods\n  async getRateLimitTimestamps(userId: string): Promise<number[]> {\n    return this.rateLimits.get(userId) || [];\n  }\n\n  async saveRateLimitTimestamps(userId: string, timestamps: number[]): Promise<void> {\n    this.rateLimits.set(userId, timestamps);\n  }\n\n  async cleanExpiredRateLimits(): Promise<void> {\n    const now = Date.now();\n    const RATE_LIMIT_WINDOW = 60000; // 1 minute\n\n    for (const [userId, timestamps] of this.rateLimits.entries()) {\n      const validTimestamps = timestamps.filter(\n        (timestamp) => now - timestamp < RATE_LIMIT_WINDOW\n      );\n\n      if (validTimestamps.length === 0) {\n        this.rateLimits.delete(userId);\n      } else {\n        this.rateLimits.set(userId, validTimestamps);\n      }\n    }\n  }\n}\n\nexport const storage = new MemStorage();\n","size_bytes":11073},"client/src/components/ui/context-menu.tsx":{"content":"import * as React from \"react\"\nimport * as ContextMenuPrimitive from \"@radix-ui/react-context-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ContextMenu = ContextMenuPrimitive.Root\n\nconst ContextMenuTrigger = ContextMenuPrimitive.Trigger\n\nconst ContextMenuGroup = ContextMenuPrimitive.Group\n\nconst ContextMenuPortal = ContextMenuPrimitive.Portal\n\nconst ContextMenuSub = ContextMenuPrimitive.Sub\n\nconst ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup\n\nconst ContextMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <ContextMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </ContextMenuPrimitive.SubTrigger>\n))\nContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName\n\nconst ContextMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName\n\nconst ContextMenuContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Portal>\n    <ContextMenuPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"z-50 max-h-[--radix-context-menu-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in fade-in-80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </ContextMenuPrimitive.Portal>\n))\nContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName\n\nconst ContextMenuItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName\n\nconst ContextMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <ContextMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.CheckboxItem>\n))\nContextMenuCheckboxItem.displayName =\n  ContextMenuPrimitive.CheckboxItem.displayName\n\nconst ContextMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <ContextMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.RadioItem>\n))\nContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName\n\nconst ContextMenuLabel = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold text-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName\n\nconst ContextMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName\n\nconst ContextMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nContextMenuShortcut.displayName = \"ContextMenuShortcut\"\n\nexport {\n  ContextMenu,\n  ContextMenuTrigger,\n  ContextMenuContent,\n  ContextMenuItem,\n  ContextMenuCheckboxItem,\n  ContextMenuRadioItem,\n  ContextMenuLabel,\n  ContextMenuSeparator,\n  ContextMenuShortcut,\n  ContextMenuGroup,\n  ContextMenuPortal,\n  ContextMenuSub,\n  ContextMenuSubContent,\n  ContextMenuSubTrigger,\n  ContextMenuRadioGroup,\n}\n","size_bytes":7428},"3123-main/client/src/pages/order-form.tsx":{"content":"import { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { ArrowLeft, MapPin, Navigation } from \"lucide-react\";\nimport { useLocation } from \"wouter\";\nimport { insertOrderSchema, type OrderType } from \"@shared/schema\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useUser } from \"@/lib/use-user\";\n\nconst orderTypeConfig = {\n  taxi: {\n    title: \"Замовлення таксі\",\n    description: \"Вкажіть адреси початку та кінця поїздки\",\n    requiredLabel: null,\n    requiredPlaceholder: null,\n  },\n  cargo: {\n    title: \"Вантажне таксі\",\n    description: \"Вкажіть адреси та опис вантажу\",\n    requiredLabel: \"Опис вантажу *\",\n    requiredPlaceholder: \"Наприклад: Меблі, коробки 2х2м, вага ~50кг\",\n  },\n  courier: {\n    title: \"Кур'єр\",\n    description: \"Вкажіть адреси та що потрібно доставити\",\n    requiredLabel: \"Що доставити *\",\n    requiredPlaceholder: \"Наприклад: Документи, посилка, їжа\",\n  },\n  towing: {\n    title: \"Евакуатор\",\n    description: \"Вкажіть адреси та тип автомобіля\",\n    requiredLabel: \"Тип автомобіля *\",\n    requiredPlaceholder: \"Наприклад: Легковий седан, позашляховик\",\n  },\n};\n\nexport default function OrderForm({ params }: { params: { type: string } }) {\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n  const { userId } = useUser();\n  const orderType = params.type as OrderType;\n  const config = orderTypeConfig[orderType];\n\n  const formSchema = insertOrderSchema.extend({\n    from: z.string().min(3, \"Вкажіть адресу початку\"),\n    to: z.string().min(3, \"Вкажіть адресу призначення\"),\n    requiredDetail: config.requiredLabel \n      ? z.string().min(2, `${config.requiredLabel.replace(\" *\", \"\")} обов'язкове`)\n      : z.string().optional(),\n    comment: z.string().optional(),\n  });\n\n  const createOrderMutation = useMutation({\n    mutationFn: async (data: z.infer<typeof formSchema>) => {\n      return await apiRequest(\"POST\", \"/api/orders\", data);\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Замовлення створено\",\n        description: \"Очікуйте на пропозиції від водіїв\",\n      });\n      setLocation(\"/\");\n    },\n    onError: () => {\n      toast({\n        title: \"Помилка\",\n        description: \"Не вдалося створити замовлення\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const form = useForm<z.infer<typeof formSchema>>({\n    resolver: zodResolver(formSchema),\n    defaultValues: {\n      type: orderType,\n      from: \"\",\n      to: \"\",\n      requiredDetail: \"\",\n      comment: \"\",\n      clientId: userId,\n    },\n  });\n\n  const onSubmit = (data: z.infer<typeof formSchema>) => {\n    createOrderMutation.mutate(data);\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <div className=\"sticky top-0 z-10 bg-card border-b border-card-border\">\n        <div className=\"max-w-2xl mx-auto px-4 py-3 flex items-center gap-3\">\n          <Button\n            variant=\"ghost\"\n            size=\"icon\"\n            onClick={() => setLocation(\"/\")}\n            data-testid=\"button-back\"\n          >\n            <ArrowLeft className=\"w-5 h-5\" />\n          </Button>\n          <div className=\"flex-1\">\n            <h1 className=\"text-lg font-semibold\">{config.title}</h1>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"max-w-2xl mx-auto p-4\">\n        <Card className=\"border-card-border\">\n          <CardHeader className=\"space-y-1\">\n            <CardTitle>{config.title}</CardTitle>\n            <CardDescription>{config.description}</CardDescription>\n          </CardHeader>\n          <CardContent>\n            <Form {...form}>\n              <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n                <FormField\n                  control={form.control}\n                  name=\"from\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel className=\"flex items-center gap-2\">\n                        <MapPin className=\"w-4 h-4 text-primary\" />\n                        Звідки *\n                      </FormLabel>\n                      <FormControl>\n                        <Input\n                          placeholder=\"Вкажіть адресу початку\"\n                          {...field}\n                          data-testid=\"input-from\"\n                          className=\"text-base h-12\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={form.control}\n                  name=\"to\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel className=\"flex items-center gap-2\">\n                        <Navigation className=\"w-4 h-4 text-primary\" />\n                        Куди *\n                      </FormLabel>\n                      <FormControl>\n                        <Input\n                          placeholder=\"Вкажіть адресу призначення\"\n                          {...field}\n                          data-testid=\"input-to\"\n                          className=\"text-base h-12\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                {config.requiredLabel && (\n                  <FormField\n                    control={form.control}\n                    name=\"requiredDetail\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>{config.requiredLabel}</FormLabel>\n                        <FormControl>\n                          <Input\n                            placeholder={config.requiredPlaceholder || \"\"}\n                            {...field}\n                            data-testid=\"input-required-detail\"\n                            className=\"text-base h-12\"\n                          />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n                )}\n\n                <FormField\n                  control={form.control}\n                  name=\"comment\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Коментар (опціонально)</FormLabel>\n                      <FormControl>\n                        <Textarea\n                          placeholder=\"Додаткові деталі замовлення\"\n                          {...field}\n                          data-testid=\"input-comment\"\n                          className=\"resize-none text-base min-h-24\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <Button\n                  type=\"submit\"\n                  className=\"w-full h-14 text-lg font-semibold\"\n                  data-testid=\"button-submit-order\"\n                  disabled={createOrderMutation.isPending}\n                >\n                  {createOrderMutation.isPending ? \"Створення...\" : \"Створити замовлення\"}\n                </Button>\n              </form>\n            </Form>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}\n","size_bytes":8355},"client/src/components/ui/tooltip.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst TooltipProvider = TooltipPrimitive.Provider\n\nconst Tooltip = TooltipPrimitive.Root\n\nconst TooltipTrigger = TooltipPrimitive.Trigger\n\nconst TooltipContent = React.forwardRef<\n  React.ElementRef<typeof TooltipPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <TooltipPrimitive.Content\n    ref={ref}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nTooltipContent.displayName = TooltipPrimitive.Content.displayName\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }\n","size_bytes":1209},"3123-main/client/src/lib/user-provider.tsx":{"content":"import { createContext, useState, ReactNode } from \"react\";\nimport type { UserRole } from \"@shared/schema\";\n\nexport interface UserContextType {\n  userId: string;\n  role: UserRole;\n  setRole: (role: UserRole) => void;\n}\n\nexport const UserContext = createContext<UserContextType>({\n  userId: \"\",\n  role: \"client\",\n  setRole: () => {},\n});\n\nexport function UserProvider({ children }: { children: ReactNode }) {\n  const [role, setRole] = useState<UserRole>(\"client\");\n\n  const userId = role === \"admin\" \n    ? \"admin1\" \n    : `${role}-${Math.random().toString(36).substring(7)}`;\n\n  const value: UserContextType = {\n    userId,\n    role,\n    setRole,\n  };\n\n  return (\n    <UserContext.Provider value={value}>\n      {children}\n    </UserContext.Provider>\n  );\n}\n","size_bytes":757},"3123-main/client/src/App.tsx":{"content":"import { Switch, Route } from \"wouter\";\nimport { QueryClientProvider } from \"@tanstack/react-query\";\nimport { queryClient } from \"./lib/queryClient\";\nimport { UserProvider } from \"./lib/user-provider\";\nimport { Toaster } from \"@/components/ui/toaster\";\nimport { TooltipProvider } from \"@/components/ui/tooltip\";\nimport RoleSelector from \"@/pages/role-selector\";\nimport ClientHome from \"@/pages/client-home\";\nimport OrderForm from \"@/pages/order-form\";\nimport DriverDashboard from \"@/pages/driver-dashboard\";\nimport DriverProfile from \"@/pages/driver-profile\";\nimport AdminLogin from \"@/pages/admin-login\";\nimport AdminDashboard from \"@/pages/admin-dashboard\";\nimport ChatPage from \"@/pages/chat-page\";\nimport NotFound from \"@/pages/not-found\";\n\nfunction Router() {\n  return (\n    <Switch>\n      <Route path=\"/role-selector\" component={RoleSelector} />\n      <Route path=\"/\" component={ClientHome} />\n      <Route path=\"/order/:type\" component={OrderForm} />\n      <Route path=\"/driver\" component={DriverDashboard} />\n      <Route path=\"/driver/profile\" component={DriverProfile} />\n      <Route path=\"/admin-login\" component={AdminLogin} />\n      <Route path=\"/admin\" component={AdminDashboard} />\n      <Route path=\"/chat/:orderId\" component={ChatPage} />\n      <Route component={NotFound} />\n    </Switch>\n  );\n}\n\nexport default function App() {\n  return (\n    <QueryClientProvider client={queryClient}>\n      <UserProvider>\n        <TooltipProvider>\n          <Toaster />\n          <Router />\n        </TooltipProvider>\n      </UserProvider>\n    </QueryClientProvider>\n  );\n}\n","size_bytes":1579},"3123-main/client/src/pages/not-found.tsx":{"content":"import { Button } from \"@/components/ui/button\";\nimport { useLocation } from \"wouter\";\nimport { AlertCircle } from \"lucide-react\";\n\nexport default function NotFound() {\n  const [, setLocation] = useLocation();\n\n  return (\n    <div className=\"min-h-screen bg-background flex items-center justify-center p-4\">\n      <div className=\"max-w-md w-full text-center space-y-6\">\n        <div className=\"flex justify-center\">\n          <div className=\"bg-destructive/10 rounded-full p-4\">\n            <AlertCircle className=\"w-8 h-8 text-destructive\" />\n          </div>\n        </div>\n        <div className=\"space-y-2\">\n          <h1 className=\"text-3xl font-bold\">404</h1>\n          <p className=\"text-muted-foreground\">Сторінка не знайдена</p>\n        </div>\n        <Button\n          className=\"w-full\"\n          onClick={() => setLocation(\"/\")}\n          data-testid=\"button-home\"\n        >\n          Повернутися на головну\n        </Button>\n      </div>\n    </div>\n  );\n}\n","size_bytes":1007},"client/src/components/ui/calendar.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight } from \"lucide-react\"\nimport { DayPicker } from \"react-day-picker\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nexport type CalendarProps = React.ComponentProps<typeof DayPicker>\n\nfunction Calendar({\n  className,\n  classNames,\n  showOutsideDays = true,\n  ...props\n}: CalendarProps) {\n  return (\n    <DayPicker\n      showOutsideDays={showOutsideDays}\n      className={cn(\"p-3\", className)}\n      classNames={{\n        months: \"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0\",\n        month: \"space-y-4\",\n        caption: \"flex justify-center pt-1 relative items-center\",\n        caption_label: \"text-sm font-medium\",\n        nav: \"space-x-1 flex items-center\",\n        nav_button: cn(\n          buttonVariants({ variant: \"outline\" }),\n          \"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100\"\n        ),\n        nav_button_previous: \"absolute left-1\",\n        nav_button_next: \"absolute right-1\",\n        table: \"w-full border-collapse space-y-1\",\n        head_row: \"flex\",\n        head_cell:\n          \"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]\",\n        row: \"flex w-full mt-2\",\n        cell: \"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20\",\n        day: cn(\n          buttonVariants({ variant: \"ghost\" }),\n          \"h-9 w-9 p-0 font-normal aria-selected:opacity-100\"\n        ),\n        day_range_end: \"day-range-end\",\n        day_selected:\n          \"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground\",\n        day_today: \"bg-accent text-accent-foreground\",\n        day_outside:\n          \"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground\",\n        day_disabled: \"text-muted-foreground opacity-50\",\n        day_range_middle:\n          \"aria-selected:bg-accent aria-selected:text-accent-foreground\",\n        day_hidden: \"invisible\",\n        ...classNames,\n      }}\n      components={{\n        IconLeft: ({ className, ...props }) => (\n          <ChevronLeft className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n        IconRight: ({ className, ...props }) => (\n          <ChevronRight className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n      }}\n      {...props}\n    />\n  )\n}\nCalendar.displayName = \"Calendar\"\n\nexport { Calendar }\n","size_bytes":2695},"client/src/pages/admin-dashboard.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription } from \"@/components/ui/dialog\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { Key, Users, Ban, AlertTriangle, Award, Copy, Check } from \"lucide-react\";\nimport { useLocation } from \"wouter\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { useUser } from \"@/lib/use-user\";\nimport type { User, AccessCode } from \"@shared/schema\";\n\nconst adminId = \"admin1\";\n\nexport default function AdminDashboard() {\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n  const { role, isLoading } = useUser();\n  \n  const [showCodeDialog, setShowCodeDialog] = useState(false);\n  const [generatedCode, setGeneratedCode] = useState<string | null>(null);\n  const [copied, setCopied] = useState(false);\n  const [showWarningDialog, setShowWarningDialog] = useState(false);\n  const [showBonusDialog, setShowBonusDialog] = useState(false);\n  const [selectedDriver, setSelectedDriver] = useState<User | null>(null);\n  const [warningText, setWarningText] = useState(\"\");\n  const [bonusText, setBonusText] = useState(\"\");\n\n  const { data: drivers = [], isLoading: driversLoading } = useQuery<User[]>({\n    queryKey: [\"/api/admin/drivers\"],\n    refetchInterval: 5000,\n  });\n\n  const generateCodeMutation = useMutation({\n    mutationFn: async (): Promise<AccessCode> => {\n      const response = await apiRequest(\"POST\", \"/api/admin/generate-code\", { adminId });\n      console.log(\"📋 Code response:\", response);\n      return response;\n    },\n    onSuccess: (code: AccessCode) => {\n      console.log(\"✅ Code generated:\", code);\n      const codeValue = code.code || (code as any).code;\n      setGeneratedCode(codeValue);\n      setShowCodeDialog(true);\n      setCopied(false);\n      toast({\n        title: \"Код згенеровано\",\n        description: `Код доступу: ${codeValue}`,\n      });\n    },\n    onError: (error) => {\n      console.error(\"❌ Error generating code:\", error);\n      toast({\n        title: \"Помилка\",\n        description: \"Не вдалося згенерувати код\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const blockDriverMutation = useMutation({\n    mutationFn: async (driverId: string) => {\n      return await apiRequest(\"POST\", `/api/admin/drivers/${driverId}/block`, {});\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/drivers\"] });\n    },\n  });\n\n  const addWarningMutation = useMutation({\n    mutationFn: async ({ driverId, text }: { driverId: string; text: string }) => {\n      return await apiRequest(\"POST\", `/api/admin/drivers/${driverId}/warning`, { text });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/drivers\"] });\n      toast({\n        title: \"Попередження видано\",\n        description: `Попередження додано для ${selectedDriver?.name}`,\n      });\n      setShowWarningDialog(false);\n      setWarningText(\"\");\n    },\n  });\n\n  const addBonusMutation = useMutation({\n    mutationFn: async ({ driverId, text }: { driverId: string; text: string }) => {\n      return await apiRequest(\"POST\", `/api/admin/drivers/${driverId}/bonus`, { text });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/admin/drivers\"] });\n      toast({\n        title: \"Бонус видано\",\n        description: `Бонус додано для ${selectedDriver?.name}`,\n      });\n      setShowBonusDialog(false);\n      setBonusText(\"\");\n    },\n  });\n\n  // Redirect non-admins immediately\n  useEffect(() => {\n    if (!isLoading && role !== \"admin\") {\n      setLocation(\"/\");\n    }\n  }, [role, isLoading, setLocation]);\n\n  // Don't render anything until we know the role\n  if (isLoading) {\n    return (\n      <div className=\"flex items-center justify-center h-screen\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-cyan-500 mx-auto mb-4\"></div>\n          <p className=\"text-secondary-foreground\">Завантаження...</p>\n        </div>\n      </div>\n    );\n  }\n\n  // Don't render admin panel for non-admins\n  if (role !== \"admin\") {\n    return null;\n  }\n\n  const handleCopyCode = () => {\n    if (generatedCode) {\n      navigator.clipboard.writeText(generatedCode);\n      setCopied(true);\n      setTimeout(() => setCopied(false), 2000);\n      toast({\n        title: \"Скопійовано\",\n        description: \"Код доступу скопійовано в буфер обміну\",\n      });\n    }\n  };\n\n  const handleBlockDriver = (driver: User) => {\n    blockDriverMutation.mutate(driver.id);\n    toast({\n      title: driver.isBlocked ? \"Розблоковано\" : \"Заблоковано\",\n      description: `Водій ${driver.name} ${driver.isBlocked ? \"розблокований\" : \"заблокований\"}`,\n    });\n  };\n\n  const handleAddWarning = () => {\n    if (selectedDriver && warningText) {\n      addWarningMutation.mutate({ driverId: selectedDriver.id, text: warningText });\n    }\n  };\n\n  const handleAddBonus = () => {\n    if (selectedDriver && bonusText) {\n      addBonusMutation.mutate({ driverId: selectedDriver.id, text: bonusText });\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <div className=\"sticky top-0 z-10 bg-card border-b border-card-border\">\n        <div className=\"max-w-4xl mx-auto px-4 py-3\">\n          <h1 className=\"text-lg font-semibold\">Панель адміністратора</h1>\n          <p className=\"text-xs text-muted-foreground\">Керування водіями та кодами доступу</p>\n        </div>\n      </div>\n\n      <div className=\"max-w-4xl mx-auto p-4\">\n        <Tabs defaultValue=\"codes\" className=\"space-y-6\">\n          <TabsList className=\"grid w-full grid-cols-2\">\n            <TabsTrigger value=\"codes\" data-testid=\"tab-codes\">\n              <Key className=\"w-4 h-4 mr-2\" />\n              Коди доступу\n            </TabsTrigger>\n            <TabsTrigger value=\"drivers\" data-testid=\"tab-drivers\">\n              <Users className=\"w-4 h-4 mr-2\" />\n              Водії\n            </TabsTrigger>\n          </TabsList>\n\n          <TabsContent value=\"codes\" className=\"space-y-4\">\n            <Card className=\"border-card-border\">\n              <CardHeader>\n                <CardTitle>Генерація коду доступу</CardTitle>\n                <CardDescription>\n                  Створіть одноразовий код для реєстрації нового водія\n                </CardDescription>\n              </CardHeader>\n              <CardContent>\n                <Button\n                  className=\"w-full h-14 text-lg font-semibold\"\n                  onClick={() => generateCodeMutation.mutate()}\n                  disabled={generateCodeMutation.isPending}\n                  data-testid=\"button-generate-code\"\n                >\n                  <Key className=\"w-5 h-5 mr-2\" />\n                  {generateCodeMutation.isPending ? \"Генерація...\" : \"Згенерувати код\"}\n                </Button>\n              </CardContent>\n            </Card>\n          </TabsContent>\n\n          <TabsContent value=\"drivers\" className=\"space-y-3\">\n            {driversLoading ? (\n              <div className=\"space-y-3\">\n                {[1, 2].map((i) => (\n                  <Card key={i} className=\"border-card-border\">\n                    <CardContent className=\"pt-6\">\n                      <div className=\"flex items-start gap-4\">\n                        <Skeleton className=\"w-12 h-12 rounded-full\" />\n                        <div className=\"flex-1 space-y-2\">\n                          <Skeleton className=\"h-5 w-32\" />\n                          <Skeleton className=\"h-4 w-40\" />\n                        </div>\n                      </div>\n                    </CardContent>\n                  </Card>\n                ))}\n              </div>\n            ) : drivers.length === 0 ? (\n              <div className=\"flex flex-col items-center justify-center py-16 text-center\">\n                <div className=\"w-16 h-16 mb-4 rounded-full bg-muted flex items-center justify-center\">\n                  <Users className=\"w-8 h-8 text-muted-foreground opacity-40\" />\n                </div>\n                <p className=\"text-base text-muted-foreground\">Немає зареєстрованих водіїв</p>\n              </div>\n            ) : (\n              drivers.map((driver) => (\n                <Card key={driver.id} className=\"border-card-border\" data-testid={`card-driver-${driver.id}`}>\n                  <CardContent className=\"pt-6\">\n                    <div className=\"flex items-start gap-4\">\n                      <Avatar className=\"w-12 h-12 flex-shrink-0\">\n                        <AvatarImage src={driver.telegramAvatarUrl || \"\"} alt={driver.name || \"\"} />\n                        <AvatarFallback className=\"bg-primary text-primary-foreground\">\n                          {driver.name?.charAt(0) || \"?\"}\n                        </AvatarFallback>\n                      </Avatar>\n                      <div className=\"flex-1 space-y-3\">\n                        <div>\n                          <div className=\"font-semibold flex items-center gap-2 flex-wrap\">\n                            {driver.name}\n                            {driver.isBlocked && (\n                              <Badge variant=\"destructive\" className=\"rounded-full px-2 py-0.5 text-xs\">\n                                <Ban className=\"w-3 h-3 mr-1\" />\n                                Заблокований\n                              </Badge>\n                            )}\n                          </div>\n                          <div className=\"text-sm text-muted-foreground\">{driver.phone}</div>\n                        </div>\n\n                        {((driver.warnings?.length ?? 0) > 0 || (driver.bonuses?.length ?? 0) > 0) && (\n                          <div className=\"flex flex-wrap gap-2\">\n                            {(driver.warnings || []).map((warning, i) => (\n                              <Badge\n                                key={i}\n                                variant=\"outline\"\n                                className=\"rounded-full px-2 py-1 text-xs\"\n                              >\n                                <AlertTriangle className=\"w-3 h-3 mr-1 text-destructive\" />\n                                {warning}\n                              </Badge>\n                            ))}\n                            {(driver.bonuses || []).map((bonus, i) => (\n                              <Badge\n                                key={i}\n                                variant=\"outline\"\n                                className=\"rounded-full px-2 py-1 text-xs\"\n                              >\n                                <Award className=\"w-3 h-3 mr-1 text-primary\" />\n                                {bonus}\n                              </Badge>\n                            ))}\n                          </div>\n                        )}\n\n                        <div className=\"flex flex-wrap gap-2\">\n                          <Button\n                            size=\"sm\"\n                            variant={driver.isBlocked ? \"default\" : \"destructive\"}\n                            onClick={() => handleBlockDriver(driver)}\n                            data-testid={`button-block-${driver.id}`}\n                            disabled={blockDriverMutation.isPending}\n                          >\n                            <Ban className=\"w-3 h-3 mr-1\" />\n                            {driver.isBlocked ? \"Розблокувати\" : \"Заблокувати\"}\n                          </Button>\n                          <Button\n                            size=\"sm\"\n                            variant=\"outline\"\n                            onClick={() => {\n                              setSelectedDriver(driver);\n                              setShowWarningDialog(true);\n                            }}\n                            data-testid={`button-warning-${driver.id}`}\n                          >\n                            <AlertTriangle className=\"w-3 h-3 mr-1\" />\n                            Попередження\n                          </Button>\n                          <Button\n                            size=\"sm\"\n                            variant=\"outline\"\n                            onClick={() => {\n                              setSelectedDriver(driver);\n                              setShowBonusDialog(true);\n                            }}\n                            data-testid={`button-bonus-${driver.id}`}\n                          >\n                            <Award className=\"w-3 h-3 mr-1\" />\n                            Бонус\n                          </Button>\n                        </div>\n                      </div>\n                    </div>\n                  </CardContent>\n                </Card>\n              ))\n            )}\n          </TabsContent>\n        </Tabs>\n      </div>\n\n      <Dialog open={showCodeDialog} onOpenChange={setShowCodeDialog}>\n        <DialogContent className=\"max-w-md\">\n          <DialogHeader>\n            <DialogTitle>Код доступу згенеровано</DialogTitle>\n            <DialogDescription>\n              Передайте цей код новому водію для реєстрації\n            </DialogDescription>\n          </DialogHeader>\n          <div className=\"space-y-4 py-4\">\n            <div className=\"bg-muted rounded-lg p-6 text-center\">\n              <div className=\"text-3xl font-mono font-bold tracking-wider text-primary\">\n                {generatedCode}\n              </div>\n            </div>\n            <Button\n              className=\"w-full h-12\"\n              onClick={handleCopyCode}\n              data-testid=\"button-copy-code\"\n            >\n              {copied ? (\n                <>\n                  <Check className=\"w-4 h-4 mr-2\" />\n                  Скопійовано\n                </>\n              ) : (\n                <>\n                  <Copy className=\"w-4 h-4 mr-2\" />\n                  Копіювати код\n                </>\n              )}\n            </Button>\n          </div>\n        </DialogContent>\n      </Dialog>\n\n      <Dialog open={showWarningDialog} onOpenChange={setShowWarningDialog}>\n        <DialogContent className=\"max-w-md\">\n          <DialogHeader>\n            <DialogTitle>Видати попередження</DialogTitle>\n            <DialogDescription>\n              Додайте попередження для водія {selectedDriver?.name}\n            </DialogDescription>\n          </DialogHeader>\n          <div className=\"space-y-4 py-4\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"warning-text\">Текст попередження</Label>\n              <Input\n                id=\"warning-text\"\n                placeholder=\"Наприклад: Запізнення на замовлення\"\n                value={warningText}\n                onChange={(e) => setWarningText(e.target.value)}\n                data-testid=\"input-warning-text\"\n                className=\"h-12\"\n              />\n            </div>\n            <Button\n              className=\"w-full h-12\"\n              onClick={handleAddWarning}\n              disabled={!warningText || addWarningMutation.isPending}\n              data-testid=\"button-submit-warning\"\n            >\n              {addWarningMutation.isPending ? \"Обробка...\" : \"Додати попередження\"}\n            </Button>\n          </div>\n        </DialogContent>\n      </Dialog>\n\n      <Dialog open={showBonusDialog} onOpenChange={setShowBonusDialog}>\n        <DialogContent className=\"max-w-md\">\n          <DialogHeader>\n            <DialogTitle>Видати бонус</DialogTitle>\n            <DialogDescription>\n              Додайте позитивну відмітку для водія {selectedDriver?.name}\n            </DialogDescription>\n          </DialogHeader>\n          <div className=\"space-y-4 py-4\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"bonus-text\">Текст бонусу</Label>\n              <Input\n                id=\"bonus-text\"\n                placeholder=\"Наприклад: Відмінне обслуговування клієнта\"\n                value={bonusText}\n                onChange={(e) => setBonusText(e.target.value)}\n                data-testid=\"input-bonus-text\"\n                className=\"h-12\"\n              />\n            </div>\n            <Button\n              className=\"w-full h-12\"\n              onClick={handleAddBonus}\n              disabled={!bonusText || addBonusMutation.isPending}\n              data-testid=\"button-submit-bonus\"\n            >\n              {addBonusMutation.isPending ? \"Обробка...\" : \"Додати бонус\"}\n            </Button>\n          </div>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}\n","size_bytes":17722},"client/src/components/ui/menubar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as MenubarPrimitive from \"@radix-ui/react-menubar\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction MenubarMenu({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Menu>) {\n  return <MenubarPrimitive.Menu {...props} />\n}\n\nfunction MenubarGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Group>) {\n  return <MenubarPrimitive.Group {...props} />\n}\n\nfunction MenubarPortal({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Portal>) {\n  return <MenubarPrimitive.Portal {...props} />\n}\n\nfunction MenubarRadioGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.RadioGroup>) {\n  return <MenubarPrimitive.RadioGroup {...props} />\n}\n\nfunction MenubarSub({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Sub>) {\n  return <MenubarPrimitive.Sub data-slot=\"menubar-sub\" {...props} />\n}\n\nconst Menubar = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"flex h-10 items-center space-x-1 rounded-md border bg-background p-1\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubar.displayName = MenubarPrimitive.Root.displayName\n\nconst MenubarTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName\n\nconst MenubarSubTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <MenubarPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </MenubarPrimitive.SubTrigger>\n))\nMenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName\n\nconst MenubarSubContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName\n\nconst MenubarContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>\n>(\n  (\n    { className, align = \"start\", alignOffset = -4, sideOffset = 8, ...props },\n    ref\n  ) => (\n    <MenubarPrimitive.Portal>\n      <MenubarPrimitive.Content\n        ref={ref}\n        align={align}\n        alignOffset={alignOffset}\n        sideOffset={sideOffset}\n        className={cn(\n          \"z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n          className\n        )}\n        {...props}\n      />\n    </MenubarPrimitive.Portal>\n  )\n)\nMenubarContent.displayName = MenubarPrimitive.Content.displayName\n\nconst MenubarItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarItem.displayName = MenubarPrimitive.Item.displayName\n\nconst MenubarCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <MenubarPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.CheckboxItem>\n))\nMenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName\n\nconst MenubarRadioItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <MenubarPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.RadioItem>\n))\nMenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName\n\nconst MenubarLabel = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarLabel.displayName = MenubarPrimitive.Label.displayName\n\nconst MenubarSeparator = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nMenubarSeparator.displayName = MenubarPrimitive.Separator.displayName\n\nconst MenubarShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nMenubarShortcut.displayname = \"MenubarShortcut\"\n\nexport {\n  Menubar,\n  MenubarMenu,\n  MenubarTrigger,\n  MenubarContent,\n  MenubarItem,\n  MenubarSeparator,\n  MenubarLabel,\n  MenubarCheckboxItem,\n  MenubarRadioGroup,\n  MenubarRadioItem,\n  MenubarPortal,\n  MenubarSubContent,\n  MenubarSubTrigger,\n  MenubarGroup,\n  MenubarSub,\n  MenubarShortcut,\n}\n","size_bytes":8605},"client/src/components/ui/pagination.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { ButtonProps, buttonVariants } from \"@/components/ui/button\"\n\nconst Pagination = ({ className, ...props }: React.ComponentProps<\"nav\">) => (\n  <nav\n    role=\"navigation\"\n    aria-label=\"pagination\"\n    className={cn(\"mx-auto flex w-full justify-center\", className)}\n    {...props}\n  />\n)\nPagination.displayName = \"Pagination\"\n\nconst PaginationContent = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    className={cn(\"flex flex-row items-center gap-1\", className)}\n    {...props}\n  />\n))\nPaginationContent.displayName = \"PaginationContent\"\n\nconst PaginationItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li ref={ref} className={cn(\"\", className)} {...props} />\n))\nPaginationItem.displayName = \"PaginationItem\"\n\ntype PaginationLinkProps = {\n  isActive?: boolean\n} & Pick<ButtonProps, \"size\"> &\n  React.ComponentProps<\"a\">\n\nconst PaginationLink = ({\n  className,\n  isActive,\n  size = \"icon\",\n  ...props\n}: PaginationLinkProps) => (\n  <a\n    aria-current={isActive ? \"page\" : undefined}\n    className={cn(\n      buttonVariants({\n        variant: isActive ? \"outline\" : \"ghost\",\n        size,\n      }),\n      className\n    )}\n    {...props}\n  />\n)\nPaginationLink.displayName = \"PaginationLink\"\n\nconst PaginationPrevious = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to previous page\"\n    size=\"default\"\n    className={cn(\"gap-1 pl-2.5\", className)}\n    {...props}\n  >\n    <ChevronLeft className=\"h-4 w-4\" />\n    <span>Previous</span>\n  </PaginationLink>\n)\nPaginationPrevious.displayName = \"PaginationPrevious\"\n\nconst PaginationNext = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to next page\"\n    size=\"default\"\n    className={cn(\"gap-1 pr-2.5\", className)}\n    {...props}\n  >\n    <span>Next</span>\n    <ChevronRight className=\"h-4 w-4\" />\n  </PaginationLink>\n)\nPaginationNext.displayName = \"PaginationNext\"\n\nconst PaginationEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    aria-hidden\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More pages</span>\n  </span>\n)\nPaginationEllipsis.displayName = \"PaginationEllipsis\"\n\nexport {\n  Pagination,\n  PaginationContent,\n  PaginationEllipsis,\n  PaginationItem,\n  PaginationLink,\n  PaginationNext,\n  PaginationPrevious,\n}\n","size_bytes":2751},"client/src/components/ui/tabs.tsx":{"content":"import * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n","size_bytes":1883},"INSTALLATION_GUIDE.md":{"content":"# Посібник установки для вашого проекту\n\n## Быстрий старт (5 хвилин)\n\n### 1. На Replit\n```bash\n# Скопіюйте мій проект\ngit clone https://github.com/ваш-репо taxi-service\ncd taxi-service\n\n# Встановіть залежності\nnpm install\n\n# Запустіть\nnpm run dev\n```\n\n### 2. У Telegram\n1. Напишіть `@BotFather`\n2. `/newbot` → отримайте токен\n3. На Replit встановіть SECRET: `TELEGRAM_BOT_TOKEN`\n4. Напишіть своєму боту `/start`\n\n### 3. Готово!\n- Клієнт: вибирає роль → замовляє таксі\n- Водій: переглядає замовлення → пропонує ціну\n- Адмін: пароль `admin123` → управління\n\n---\n\n## Структура папок для копіювання\n\n### Мінімум для повної функціональності:\n\n```\nyour-project/\n├── shared/schema.ts          ← Копіюйте ЦЕ\n├── server/\n│   ├── storage.ts            ← Копіюйте ЦЕ (усь CRUD)\n│   ├── routes.ts             ← Копіюйте ЦЕ (всі API)\n│   ├── telegram.ts           ← Копіюйте ЦЕ (бот)\n│   └── index-dev.ts, index-prod.ts, vite.ts, index.ts\n├── client/src/\n│   ├── pages/                ← Копіюйте ЦЕ (9 сторінок)\n│   ├── components/ui/        ← Копіюйте ЦЕ (Shadcn компоненти)\n│   ├── lib/                  ← Копіюйте ЦЕ (контекст + квері)\n│   ├── App.tsx               ← Копіюйте ЦЕ\n│   ├── main.tsx\n│   └── index.css             ← Копіюйте ЦЕ (дизайн)\n├── package.json              ← Переконайтесь у залежностях\n├── tailwind.config.ts        ← Копіюйте ЦЕ (дизайн конфіг)\n└── vite.config.ts\n```\n\n---\n\n## Що змінити для свого проекту\n\n1. **Назва бота** - в `server/telegram.ts` лінія 86: `Привіт, ${firstName}!` → змініть текст\n2. **Пароль адміна** - в `client/src/pages/admin-login.tsx`: `admin123` → ваш пароль\n3. **Кольори** - в `client/src/index.css`: замініть HSL значення\n4. **Компанія/логотип** - в `client/src/pages/role-selector.tsx`: додайте свій логотип\n5. **API URL** - в `server/telegram.ts`: встановіть свій APP_URL\n\n---\n\n## Залежності (package.json)\n\n```json\n{\n  \"dependencies\": {\n    \"express\": \"^4.18.2\",\n    \"react\": \"^18.x\",\n    \"react-dom\": \"^18.x\",\n    \"@tanstack/react-query\": \"^5.x\",\n    \"react-hook-form\": \"^7.x\",\n    \"@hookform/resolvers\": \"^3.x\",\n    \"zod\": \"^3.x\",\n    \"drizzle-orm\": \"^0.29.x\",\n    \"@neondatabase/serverless\": \"^0.x\",\n    \"tailwindcss\": \"^3.x\",\n    \"@radix-ui/*\": \"various\"\n  }\n}\n```\n\n---\n\n## Типові помилки і як їх виправити\n\n| Помилка | Причина | Рішення |\n|---------|---------|----------|\n| EADDRINUSE port 5000 | Порт зайнятий | `pkill -f \"node.*server\"` |\n| Bot not responding | TELEGRAM_BOT_TOKEN не встановлено | Встановіть SECRET на Replit |\n| Cannot find module | Неправильний імпорт | Перевіріть відносні шляхи |\n| LSP errors | TypeScript помилки | Нагнайте чинні типи в `shared/schema.ts` |\n\n---\n\n## Як тестувати\n\n### Сценарій 1: Клієнт замовляє таксі\n1. Вибери роль \"Клієнт\"\n2. Натисни \"Таксі\"\n3. Вкажи адресу \"Звідки\" та \"Куди\"\n4. Відправ замовлення\n\n### Сценарій 2: Водій приймає замовлення\n1. Вибери роль \"Водій\"\n2. Побачиш список активних замовлень\n3. Натисни \"Прийняти\"\n4. Запропонуй ціну\n5. Чекай відповіді клієнта\n\n### Сценарій 3: Адміністратор управляє\n1. Вибери \"Адміністратор\"\n2. Введи пароль `admin123`\n3. Генеруй коди для водіїв\n4. Видавай попередження/бонуси\n\n---\n\n## Налаштування для продакшену\n\n1. Встановіть `NODE_ENV=production`\n2. Встановіть `DATABASE_URL` для своєї БД\n3. Змініть пароль адміна на надійний\n4. Встановіть WEBHOOK_URL для webhook (замість polling)\n5. Включіть HTTPS для webhook\n\n","size_bytes":4764},"3123-main/server/telegram.ts":{"content":"import { storage } from \"./storage\";\n\nconst TELEGRAM_API = \"https://api.telegram.org\";\nconst BOT_TOKEN = process.env.TELEGRAM_BOT_TOKEN;\n\ninterface TelegramMessage {\n  message_id: number;\n  chat: { id: number };\n  from: { id: number; first_name: string };\n  text?: string;\n}\n\ninterface TelegramUpdate {\n  update_id: number;\n  message?: TelegramMessage;\n}\n\nexport async function handleTelegramUpdate(update: TelegramUpdate) {\n  if (!update.message || !update.message.text) return;\n\n  const message = update.message;\n  const chatId = message.chat.id;\n  const userId = String(message.from.id);\n  const firstName = message.from.first_name;\n  const text = message.text.trim();\n\n  try {\n    // Handle /start command\n    if (text === \"/start\") {\n      await sendTelegramMessage(\n        chatId,\n        `👋 Привіт, ${firstName}!\\n\\nДобро пожалувати до Таксі-Сервісу!\\n\\nВиберіть вашу роль:\\n🚖 Клієнт\\n🚗 Водій\\n🛡️ Адміністратор (пароль захищено)\\n\\nТапни кнопку нижче, щоб запустити додаток:`,\n        [\n          [\n            {\n              text: \"🚀 Запустити додаток\",\n              web_app: {\n                url: process.env.APP_URL || \"https://taxi-app.replit.dev\",\n              },\n            },\n          ],\n        ]\n      );\n      return;\n    }\n\n    // Handle /generate_code command (admin only)\n    if (text === \"/generate_code\") {\n      const user = await storage.getUser(userId);\n      if (!user || user.role !== \"admin\") {\n        await sendTelegramMessage(\n          chatId,\n          \"❌ Ви не маєте прав для цієї команди. Тільки адміністратори можуть генерувати коди.\"\n        );\n        return;\n      }\n\n      const code = Math.random().toString(36).substring(2, 8).toUpperCase();\n      await storage.generateAccessCode(userId);\n\n      await sendTelegramMessage(\n        chatId,\n        `✅ Новий код доступу сгенерований:\\n\\n🔑 <code>${code}</code>\\n\\nПоділіться цим кодом з водієм для реєстрації.`,\n        undefined,\n        { parse_mode: \"HTML\" }\n      );\n      return;\n    }\n\n    // Handle /help command\n    if (text === \"/help\") {\n      await sendTelegramMessage(\n        chatId,\n        `📖 Доступні команди:\\n\\n/start - Запустити додаток\\n/help - Цей пункт\\n/generate_code - Генерувати код доступу (тільки для адміна)\\n\\n🎯 Натисніть кнопку \"Запустити додаток\" для отримання повного доступу.`\n      );\n      return;\n    }\n\n    // Default response\n    await sendTelegramMessage(\n      chatId,\n      `Я не розумію цю команду. Введіть /help для списку команд.`\n    );\n  } catch (error) {\n    console.error(\"Telegram update error:\", error);\n    await sendTelegramMessage(\n      chatId,\n      \"❌ Сталася помилка. Спробуйте пізніше.\"\n    ).catch(() => {});\n  }\n}\n\nexport async function sendTelegramMessage(\n  chatId: number,\n  text: string,\n  replyMarkup?: any[],\n  options?: Record<string, any>\n) {\n  if (!BOT_TOKEN) {\n    console.error(\"TELEGRAM_BOT_TOKEN not configured\");\n    return;\n  }\n\n  try {\n    const payload: Record<string, any> = {\n      chat_id: chatId,\n      text,\n      parse_mode: \"Markdown\",\n      ...options,\n    };\n\n    if (replyMarkup) {\n      payload.reply_markup = {\n        inline_keyboard: replyMarkup,\n      };\n    }\n\n    const response = await fetch(`${TELEGRAM_API}/bot${BOT_TOKEN}/sendMessage`, {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify(payload),\n    });\n\n    if (!response.ok) {\n      console.error(\"Telegram API error:\", await response.text());\n    }\n  } catch (error) {\n    console.error(\"Error sending Telegram message:\", error);\n  }\n}\n\nexport async function setWebhook(url: string) {\n  if (!BOT_TOKEN) {\n    console.error(\"TELEGRAM_BOT_TOKEN not configured\");\n    return false;\n  }\n\n  try {\n    const webhookUrl = `${url}/api/telegram/webhook`;\n    const response = await fetch(\n      `${TELEGRAM_API}/bot${BOT_TOKEN}/setWebhook`,\n      {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          url: webhookUrl,\n          allowed_updates: [\"message\"],\n        }),\n      }\n    );\n\n    const result = await response.json();\n    if (result.ok) {\n      console.log(`✅ Telegram webhook configured: ${webhookUrl}`);\n    } else {\n      console.error(\"❌ Webhook error:\", result.description);\n    }\n    return result.ok;\n  } catch (error) {\n    console.error(\"Error setting Telegram webhook:\", error);\n    return false;\n  }\n}\n\nlet webhookSetupPromise: Promise<boolean> | null = null;\n\nexport async function autoSetupWebhook(baseUrl?: string) {\n  if (!BOT_TOKEN) {\n    return false;\n  }\n\n  // Return existing promise if setup is already in progress\n  if (webhookSetupPromise) {\n    return webhookSetupPromise;\n  }\n\n  const url = baseUrl || process.env.APP_URL;\n  \n  if (!url) {\n    return false;\n  }\n\n  webhookSetupPromise = setWebhook(url);\n  return webhookSetupPromise;\n}\n\nexport async function getBotInfo() {\n  if (!BOT_TOKEN) {\n    console.error(\"TELEGRAM_BOT_TOKEN not configured\");\n    return null;\n  }\n\n  try {\n    const response = await fetch(`${TELEGRAM_API}/bot${BOT_TOKEN}/getMe`);\n    const data = await response.json();\n    if (data.ok) {\n      console.log(`✅ Telegram Bot Connected: @${data.result.username}`);\n      return data.result;\n    }\n    return null;\n  } catch (error) {\n    console.error(\"Error getting bot info:\", error);\n    return null;\n  }\n}\n","size_bytes":5843},"drizzle.config.ts":{"content":"import { defineConfig } from \"drizzle-kit\";\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\"DATABASE_URL, ensure the database is provisioned\");\n}\n\nexport default defineConfig({\n  out: \"./migrations\",\n  schema: \"./shared/schema.ts\",\n  dialect: \"postgresql\",\n  dbCredentials: {\n    url: process.env.DATABASE_URL,\n  },\n});\n","size_bytes":325},"client/src/components/ui/drawer.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Drawer as DrawerPrimitive } from \"vaul\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Drawer = ({\n  shouldScaleBackground = true,\n  ...props\n}: React.ComponentProps<typeof DrawerPrimitive.Root>) => (\n  <DrawerPrimitive.Root\n    shouldScaleBackground={shouldScaleBackground}\n    {...props}\n  />\n)\nDrawer.displayName = \"Drawer\"\n\nconst DrawerTrigger = DrawerPrimitive.Trigger\n\nconst DrawerPortal = DrawerPrimitive.Portal\n\nconst DrawerClose = DrawerPrimitive.Close\n\nconst DrawerOverlay = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Overlay\n    ref={ref}\n    className={cn(\"fixed inset-0 z-50 bg-black/80\", className)}\n    {...props}\n  />\n))\nDrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName\n\nconst DrawerContent = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DrawerPortal>\n    <DrawerOverlay />\n    <DrawerPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background\",\n        className\n      )}\n      {...props}\n    >\n      <div className=\"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted\" />\n      {children}\n    </DrawerPrimitive.Content>\n  </DrawerPortal>\n))\nDrawerContent.displayName = \"DrawerContent\"\n\nconst DrawerHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"grid gap-1.5 p-4 text-center sm:text-left\", className)}\n    {...props}\n  />\n)\nDrawerHeader.displayName = \"DrawerHeader\"\n\nconst DrawerFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"mt-auto flex flex-col gap-2 p-4\", className)}\n    {...props}\n  />\n)\nDrawerFooter.displayName = \"DrawerFooter\"\n\nconst DrawerTitle = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDrawerTitle.displayName = DrawerPrimitive.Title.displayName\n\nconst DrawerDescription = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDrawerDescription.displayName = DrawerPrimitive.Description.displayName\n\nexport {\n  Drawer,\n  DrawerPortal,\n  DrawerOverlay,\n  DrawerTrigger,\n  DrawerClose,\n  DrawerContent,\n  DrawerHeader,\n  DrawerFooter,\n  DrawerTitle,\n  DrawerDescription,\n}\n","size_bytes":3021},"server/index-dev.ts":{"content":"import fs from \"node:fs\";\nimport path from \"node:path\";\nimport { type Server } from \"node:http\";\n\nimport { nanoid } from \"nanoid\";\nimport { type Express } from \"express\";\nimport { createServer as createViteServer, createLogger } from \"vite\";\n\nimport viteConfig from \"../vite.config\";\nimport runApp from \"./app\";\n\nexport async function setupVite(app: Express, server: Server) {\n  const viteLogger = createLogger();\n  const serverOptions = {\n    middlewareMode: true,\n    hmr: { server },\n    allowedHosts: true as const,\n  };\n\n  const vite = await createViteServer({\n    ...viteConfig,\n    configFile: false,\n    customLogger: {\n      ...viteLogger,\n      error: (msg, options) => {\n        viteLogger.error(msg, options);\n        process.exit(1);\n      },\n    },\n    server: serverOptions,\n    appType: \"custom\",\n  });\n\n  app.use(vite.middlewares);\n  app.use(\"*\", async (req, res, next) => {\n    const url = req.originalUrl;\n\n    try {\n      const clientTemplate = path.resolve(\n        import.meta.dirname,\n        \"..\",\n        \"client\",\n        \"index.html\",\n      );\n\n      // always reload the index.html file from disk incase it changes\n      let template = await fs.promises.readFile(clientTemplate, \"utf-8\");\n      template = template.replace(\n        `src=\"/src/main.tsx\"`,\n        `src=\"/src/main.tsx?v=${nanoid()}\"`,\n      );\n      const page = await vite.transformIndexHtml(url, template);\n      res.status(200).set({ \"Content-Type\": \"text/html\" }).end(page);\n    } catch (e) {\n      vite.ssrFixStacktrace(e as Error);\n      next(e);\n    }\n  });\n}\n\n(async () => {\n  await runApp(setupVite);\n})();\n","size_bytes":1609},"shared/schema.ts":{"content":"import { sql } from \"drizzle-orm\";\nimport { pgTable, text, varchar, boolean, timestamp, integer, real } from \"drizzle-orm/pg-core\";\nimport { createInsertSchema } from \"drizzle-zod\";\nimport { z } from \"zod\";\n\nexport const users = pgTable(\"users\", {\n  id: varchar(\"id\").primaryKey(),\n  role: text(\"role\", { enum: [\"client\", \"driver\", \"admin\"] }).notNull().default(\"client\"),\n  name: text(\"name\"),\n  phone: text(\"phone\"),\n  telegramAvatarUrl: text(\"telegram_avatar_url\"),\n  isBlocked: boolean(\"is_blocked\").default(false),\n  warnings: text(\"warnings\").array().default([]),\n  bonuses: text(\"bonuses\").array().default([]),\n});\n\nexport const orders = pgTable(\"orders\", {\n  orderId: varchar(\"order_id\").primaryKey().default(sql`gen_random_uuid()`),\n  type: text(\"type\", { enum: [\"taxi\", \"cargo\", \"courier\", \"towing\"] }).notNull(),\n  clientId: varchar(\"client_id\").notNull(),\n  driverId: varchar(\"driver_id\"),\n  from: text(\"from\").notNull(),\n  to: text(\"to\").notNull(),\n  comment: text(\"comment\"),\n  requiredDetail: text(\"required_detail\"),\n  status: text(\"status\", { \n    enum: [\"pending\", \"accepted\", \"in_progress\", \"completed\", \"cancelled\"] \n  }).notNull().default(\"pending\"),\n  price: real(\"price\"),\n  distanceKm: real(\"distance_km\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const accessCodes = pgTable(\"access_codes\", {\n  code: varchar(\"code\").primaryKey(),\n  isUsed: boolean(\"is_used\").default(false),\n  issuedBy: varchar(\"issued_by\").notNull(),\n  usedBy: varchar(\"used_by\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const chatMessages = pgTable(\"chat_messages\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  orderId: varchar(\"order_id\").notNull(),\n  senderId: varchar(\"sender_id\").notNull(),\n  message: text(\"message\").notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const ratings = pgTable(\"ratings\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  orderId: varchar(\"order_id\").notNull(),\n  driverId: varchar(\"driver_id\").notNull(),\n  stars: integer(\"stars\").notNull(),\n  comment: text(\"comment\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const insertUserSchema = createInsertSchema(users).omit({\n  warnings: true,\n  bonuses: true,\n});\n\nexport const insertOrderSchema = createInsertSchema(orders).omit({\n  orderId: true,\n  createdAt: true,\n  status: true,\n  driverId: true,\n}).extend({\n  type: z.enum([\"taxi\", \"cargo\", \"courier\", \"towing\"]),\n  from: z.string().min(1),\n  to: z.string().min(1),\n  clientId: z.string().min(1),\n  comment: z.string().optional(),\n  requiredDetail: z.string().optional(),\n  price: z.number().optional(),\n  distanceKm: z.number().optional(),\n});\n\nexport const insertAccessCodeSchema = createInsertSchema(accessCodes).omit({\n  createdAt: true,\n});\n\nexport const insertChatMessageSchema = createInsertSchema(chatMessages).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertRatingSchema = createInsertSchema(ratings).omit({\n  id: true,\n  createdAt: true,\n}).extend({\n  stars: z.number().min(1).max(5),\n  comment: z.string().optional(),\n});\n\nexport type User = typeof users.$inferSelect;\nexport type InsertUser = z.infer<typeof insertUserSchema>;\n\nexport type Order = typeof orders.$inferSelect;\nexport type InsertOrder = z.infer<typeof insertOrderSchema>;\n\nexport type AccessCode = typeof accessCodes.$inferSelect;\nexport type InsertAccessCode = z.infer<typeof insertAccessCodeSchema>;\n\nexport type ChatMessage = typeof chatMessages.$inferSelect;\nexport type InsertChatMessage = z.infer<typeof insertChatMessageSchema>;\n\nexport type Rating = typeof ratings.$inferSelect;\nexport type InsertRating = z.infer<typeof insertRatingSchema>;\n\nexport type OrderType = \"taxi\" | \"cargo\" | \"courier\" | \"towing\";\nexport type OrderStatus = \"pending\" | \"accepted\" | \"in_progress\" | \"completed\" | \"cancelled\";\nexport type UserRole = \"client\" | \"driver\" | \"admin\";\n","size_bytes":3922},"client/src/pages/driver-register.tsx":{"content":"import { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { ArrowLeft, Key } from \"lucide-react\";\nimport { useLocation } from \"wouter\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useUser } from \"@/lib/use-user\";\n\nconst registerSchema = z.object({\n  code: z.string().min(5, \"Вкажіть код доступу\"),\n  name: z.string().min(2, \"Ім'я має містити мінімум 2 символи\"),\n  phone: z.string().min(10, \"Вкажіть коректний номер телефону\"),\n});\n\nexport default function DriverRegister() {\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n  const { userId, setRole } = useUser();\n\n  const registerMutation = useMutation({\n    mutationFn: async (data: z.infer<typeof registerSchema>) => {\n      return await apiRequest(\"POST\", \"/api/users/register-driver\", {\n        userId,\n        ...data,\n      });\n    },\n    onSuccess: () => {\n      setRole(\"driver\");\n      toast({\n        title: \"Успіх\",\n        description: \"Ви зареєстровані як водій!\",\n      });\n      setLocation(\"/driver\");\n    },\n    onError: () => {\n      toast({\n        title: \"Помилка\",\n        description: \"Неправильний код доступу або дані\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const form = useForm<z.infer<typeof registerSchema>>({\n    resolver: zodResolver(registerSchema),\n    defaultValues: {\n      code: \"\",\n      name: \"\",\n      phone: \"\",\n    },\n  });\n\n  const onSubmit = (data: z.infer<typeof registerSchema>) => {\n    registerMutation.mutate(data);\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <div className=\"sticky top-0 z-10 bg-card border-b border-card-border\">\n        <div className=\"max-w-2xl mx-auto px-4 py-3 flex items-center gap-3\">\n          <Button\n            variant=\"ghost\"\n            size=\"icon\"\n            onClick={() => setLocation(\"/\")}\n            data-testid=\"button-back\"\n          >\n            <ArrowLeft className=\"w-5 h-5\" />\n          </Button>\n          <div className=\"flex-1\">\n            <h1 className=\"text-lg font-semibold\">Реєстрація водія</h1>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"max-w-2xl mx-auto p-4\">\n        <Card className=\"border-card-border\">\n          <CardHeader className=\"space-y-1\">\n            <CardTitle>Введіть дані для реєстрації</CardTitle>\n            <CardDescription>Адміністратор повинен надати вам код доступу</CardDescription>\n          </CardHeader>\n          <CardContent>\n            <Form {...form}>\n              <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n                <FormField\n                  control={form.control}\n                  name=\"code\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel className=\"flex items-center gap-2\">\n                        <Key className=\"w-4 h-4 text-primary\" />\n                        Код доступу *\n                      </FormLabel>\n                      <FormControl>\n                        <Input\n                          placeholder=\"Вкажіть код від адміна\"\n                          {...field}\n                          data-testid=\"input-access-code\"\n                          className=\"text-base h-12 font-mono tracking-widest\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={form.control}\n                  name=\"name\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Ім'я *</FormLabel>\n                      <FormControl>\n                        <Input\n                          placeholder=\"Ваше ім'я\"\n                          {...field}\n                          data-testid=\"input-name\"\n                          className=\"text-base h-12\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={form.control}\n                  name=\"phone\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Номер телефону *</FormLabel>\n                      <FormControl>\n                        <Input\n                          type=\"tel\"\n                          placeholder=\"+380 XX XXX XX XX\"\n                          {...field}\n                          data-testid=\"input-phone\"\n                          className=\"text-base h-12\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <Button\n                  type=\"submit\"\n                  className=\"w-full h-14 text-lg font-semibold\"\n                  data-testid=\"button-register\"\n                  disabled={registerMutation.isPending}\n                >\n                  {registerMutation.isPending ? \"Реєстрація...\" : \"Зареєструватися\"}\n                </Button>\n              </form>\n            </Form>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}\n","size_bytes":5985},"client/src/components/ui/alert.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-background text-foreground\",\n        destructive:\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Alert = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = \"Alert\"\n\nconst AlertTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = \"AlertTitle\"\n\nconst AlertDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = \"AlertDescription\"\n\nexport { Alert, AlertTitle, AlertDescription }\n","size_bytes":1584},"client/src/pages/not-found.tsx":{"content":"import { Button } from \"@/components/ui/button\";\nimport { useLocation } from \"wouter\";\nimport { AlertCircle } from \"lucide-react\";\n\nexport default function NotFound() {\n  const [, setLocation] = useLocation();\n\n  return (\n    <div className=\"min-h-screen bg-background flex items-center justify-center p-4\">\n      <div className=\"max-w-md w-full text-center space-y-6\">\n        <div className=\"flex justify-center\">\n          <div className=\"bg-destructive/10 rounded-full p-4\">\n            <AlertCircle className=\"w-8 h-8 text-destructive\" />\n          </div>\n        </div>\n        <div className=\"space-y-2\">\n          <h1 className=\"text-3xl font-bold\">404</h1>\n          <p className=\"text-muted-foreground\">Сторінка не знайдена</p>\n        </div>\n        <Button\n          className=\"w-full\"\n          onClick={() => setLocation(\"/\")}\n          data-testid=\"button-home\"\n        >\n          Повернутися на головну\n        </Button>\n      </div>\n    </div>\n  );\n}\n","size_bytes":1007},"client/src/components/ui/breadcrumb.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Breadcrumb = React.forwardRef<\n  HTMLElement,\n  React.ComponentPropsWithoutRef<\"nav\"> & {\n    separator?: React.ReactNode\n  }\n>(({ ...props }, ref) => <nav ref={ref} aria-label=\"breadcrumb\" {...props} />)\nBreadcrumb.displayName = \"Breadcrumb\"\n\nconst BreadcrumbList = React.forwardRef<\n  HTMLOListElement,\n  React.ComponentPropsWithoutRef<\"ol\">\n>(({ className, ...props }, ref) => (\n  <ol\n    ref={ref}\n    className={cn(\n      \"flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5\",\n      className\n    )}\n    {...props}\n  />\n))\nBreadcrumbList.displayName = \"BreadcrumbList\"\n\nconst BreadcrumbItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentPropsWithoutRef<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    className={cn(\"inline-flex items-center gap-1.5\", className)}\n    {...props}\n  />\n))\nBreadcrumbItem.displayName = \"BreadcrumbItem\"\n\nconst BreadcrumbLink = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentPropsWithoutRef<\"a\"> & {\n    asChild?: boolean\n  }\n>(({ asChild, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      className={cn(\"transition-colors hover:text-foreground\", className)}\n      {...props}\n    />\n  )\n})\nBreadcrumbLink.displayName = \"BreadcrumbLink\"\n\nconst BreadcrumbPage = React.forwardRef<\n  HTMLSpanElement,\n  React.ComponentPropsWithoutRef<\"span\">\n>(({ className, ...props }, ref) => (\n  <span\n    ref={ref}\n    role=\"link\"\n    aria-disabled=\"true\"\n    aria-current=\"page\"\n    className={cn(\"font-normal text-foreground\", className)}\n    {...props}\n  />\n))\nBreadcrumbPage.displayName = \"BreadcrumbPage\"\n\nconst BreadcrumbSeparator = ({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) => (\n  <li\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"[&>svg]:w-3.5 [&>svg]:h-3.5\", className)}\n    {...props}\n  >\n    {children ?? <ChevronRight />}\n  </li>\n)\nBreadcrumbSeparator.displayName = \"BreadcrumbSeparator\"\n\nconst BreadcrumbEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More</span>\n  </span>\n)\nBreadcrumbEllipsis.displayName = \"BreadcrumbElipssis\"\n\nexport {\n  Breadcrumb,\n  BreadcrumbList,\n  BreadcrumbItem,\n  BreadcrumbLink,\n  BreadcrumbPage,\n  BreadcrumbSeparator,\n  BreadcrumbEllipsis,\n}\n","size_bytes":2712},"client/src/components/ui/carousel.tsx":{"content":"import * as React from \"react\"\nimport useEmblaCarousel, {\n  type UseEmblaCarouselType,\n} from \"embla-carousel-react\"\nimport { ArrowLeft, ArrowRight } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\n\ntype CarouselApi = UseEmblaCarouselType[1]\ntype UseCarouselParameters = Parameters<typeof useEmblaCarousel>\ntype CarouselOptions = UseCarouselParameters[0]\ntype CarouselPlugin = UseCarouselParameters[1]\n\ntype CarouselProps = {\n  opts?: CarouselOptions\n  plugins?: CarouselPlugin\n  orientation?: \"horizontal\" | \"vertical\"\n  setApi?: (api: CarouselApi) => void\n}\n\ntype CarouselContextProps = {\n  carouselRef: ReturnType<typeof useEmblaCarousel>[0]\n  api: ReturnType<typeof useEmblaCarousel>[1]\n  scrollPrev: () => void\n  scrollNext: () => void\n  canScrollPrev: boolean\n  canScrollNext: boolean\n} & CarouselProps\n\nconst CarouselContext = React.createContext<CarouselContextProps | null>(null)\n\nfunction useCarousel() {\n  const context = React.useContext(CarouselContext)\n\n  if (!context) {\n    throw new Error(\"useCarousel must be used within a <Carousel />\")\n  }\n\n  return context\n}\n\nconst Carousel = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & CarouselProps\n>(\n  (\n    {\n      orientation = \"horizontal\",\n      opts,\n      setApi,\n      plugins,\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const [carouselRef, api] = useEmblaCarousel(\n      {\n        ...opts,\n        axis: orientation === \"horizontal\" ? \"x\" : \"y\",\n      },\n      plugins\n    )\n    const [canScrollPrev, setCanScrollPrev] = React.useState(false)\n    const [canScrollNext, setCanScrollNext] = React.useState(false)\n\n    const onSelect = React.useCallback((api: CarouselApi) => {\n      if (!api) {\n        return\n      }\n\n      setCanScrollPrev(api.canScrollPrev())\n      setCanScrollNext(api.canScrollNext())\n    }, [])\n\n    const scrollPrev = React.useCallback(() => {\n      api?.scrollPrev()\n    }, [api])\n\n    const scrollNext = React.useCallback(() => {\n      api?.scrollNext()\n    }, [api])\n\n    const handleKeyDown = React.useCallback(\n      (event: React.KeyboardEvent<HTMLDivElement>) => {\n        if (event.key === \"ArrowLeft\") {\n          event.preventDefault()\n          scrollPrev()\n        } else if (event.key === \"ArrowRight\") {\n          event.preventDefault()\n          scrollNext()\n        }\n      },\n      [scrollPrev, scrollNext]\n    )\n\n    React.useEffect(() => {\n      if (!api || !setApi) {\n        return\n      }\n\n      setApi(api)\n    }, [api, setApi])\n\n    React.useEffect(() => {\n      if (!api) {\n        return\n      }\n\n      onSelect(api)\n      api.on(\"reInit\", onSelect)\n      api.on(\"select\", onSelect)\n\n      return () => {\n        api?.off(\"select\", onSelect)\n      }\n    }, [api, onSelect])\n\n    return (\n      <CarouselContext.Provider\n        value={{\n          carouselRef,\n          api: api,\n          opts,\n          orientation:\n            orientation || (opts?.axis === \"y\" ? \"vertical\" : \"horizontal\"),\n          scrollPrev,\n          scrollNext,\n          canScrollPrev,\n          canScrollNext,\n        }}\n      >\n        <div\n          ref={ref}\n          onKeyDownCapture={handleKeyDown}\n          className={cn(\"relative\", className)}\n          role=\"region\"\n          aria-roledescription=\"carousel\"\n          {...props}\n        >\n          {children}\n        </div>\n      </CarouselContext.Provider>\n    )\n  }\n)\nCarousel.displayName = \"Carousel\"\n\nconst CarouselContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { carouselRef, orientation } = useCarousel()\n\n  return (\n    <div ref={carouselRef} className=\"overflow-hidden\">\n      <div\n        ref={ref}\n        className={cn(\n          \"flex\",\n          orientation === \"horizontal\" ? \"-ml-4\" : \"-mt-4 flex-col\",\n          className\n        )}\n        {...props}\n      />\n    </div>\n  )\n})\nCarouselContent.displayName = \"CarouselContent\"\n\nconst CarouselItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { orientation } = useCarousel()\n\n  return (\n    <div\n      ref={ref}\n      role=\"group\"\n      aria-roledescription=\"slide\"\n      className={cn(\n        \"min-w-0 shrink-0 grow-0 basis-full\",\n        orientation === \"horizontal\" ? \"pl-4\" : \"pt-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nCarouselItem.displayName = \"CarouselItem\"\n\nconst CarouselPrevious = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollPrev, canScrollPrev } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute  h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-left-12 top-1/2 -translate-y-1/2\"\n          : \"-top-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollPrev}\n      onClick={scrollPrev}\n      {...props}\n    >\n      <ArrowLeft className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Previous slide</span>\n    </Button>\n  )\n})\nCarouselPrevious.displayName = \"CarouselPrevious\"\n\nconst CarouselNext = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollNext, canScrollNext } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-right-12 top-1/2 -translate-y-1/2\"\n          : \"-bottom-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollNext}\n      onClick={scrollNext}\n      {...props}\n    >\n      <ArrowRight className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Next slide</span>\n    </Button>\n  )\n})\nCarouselNext.displayName = \"CarouselNext\"\n\nexport {\n  type CarouselApi,\n  Carousel,\n  CarouselContent,\n  CarouselItem,\n  CarouselPrevious,\n  CarouselNext,\n}\n","size_bytes":6210},"3123-main/client/src/pages/driver-dashboard.tsx":{"content":"import { useState } from \"react\";\nimport { Card, CardContent, CardHeader } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription } from \"@/components/ui/dialog\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { MapPin, Navigation, DollarSign, Lock, User, Plus, LogOut } from \"lucide-react\";\nimport { useLocation } from \"wouter\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useUser } from \"@/lib/use-user\";\nimport type { Order } from \"@shared/schema\";\n\nconst orderTypeLabels = {\n  taxi: \"Таксі\",\n  cargo: \"Вантажне\",\n  courier: \"Кур'єр\",\n  towing: \"Евакуатор\",\n};\n\nexport default function DriverDashboard() {\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n  const { userId: driverId } = useUser();\n  const [selectedOrder, setSelectedOrder] = useState<Order | null>(null);\n  const [bidPrice, setBidPrice] = useState(\"\");\n  const [showBidModal, setShowBidModal] = useState(false);\n\n  const { data: orders = [], isLoading } = useQuery<Order[]>({\n    queryKey: [\"/api/orders/active\"],\n    refetchInterval: 3000,\n  });\n\n  const acceptOrderMutation = useMutation({\n    mutationFn: async (orderId: string) => {\n      return await apiRequest(\"POST\", `/api/orders/${orderId}/accept`, { driverId });\n    },\n    onSuccess: (updatedOrder) => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/orders/active\"] });\n      setSelectedOrder(updatedOrder);\n      setShowBidModal(true);\n      setBidPrice(\"\");\n    },\n    onError: () => {\n      toast({\n        title: \"Помилка\",\n        description: \"Не вдалося прийняти замовлення\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const proposeBidMutation = useMutation({\n    mutationFn: async ({ orderId, price }: { orderId: string; price: number }) => {\n      return await apiRequest(\"POST\", `/api/orders/${orderId}/bid`, {\n        driverId,\n        price,\n      });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/orders/active\"] });\n      toast({\n        title: \"Ціну запропоновано\",\n        description: \"Очікуйте відповіді від клієнта\",\n      });\n      setShowBidModal(false);\n      setSelectedOrder(null);\n    },\n    onError: () => {\n      toast({\n        title: \"Помилка\",\n        description: \"Не вдалося запропонувати ціну\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const handleAcceptOrder = (order: Order) => {\n    acceptOrderMutation.mutate(order.orderId);\n  };\n\n  const handleSubmitBid = () => {\n    if (selectedOrder && bidPrice) {\n      proposeBidMutation.mutate({\n        orderId: selectedOrder.orderId,\n        price: Number(bidPrice),\n      });\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <div className=\"sticky top-0 z-10 bg-card border-b border-card-border\">\n        <div className=\"max-w-2xl mx-auto px-4 py-3\">\n          <div className=\"flex items-center justify-between gap-4\">\n            <div>\n              <h1 className=\"text-lg font-semibold\">Активні замовлення</h1>\n              <p className=\"text-xs text-muted-foreground\">Виберіть замовлення для роботи</p>\n            </div>\n            <Button\n              variant=\"ghost\"\n              size=\"icon\"\n              onClick={() => setLocation(\"/driver/profile\")}\n              data-testid=\"button-profile\"\n            >\n              <User className=\"w-5 h-5\" />\n            </Button>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"max-w-2xl mx-auto p-4 space-y-4\">\n        <Button\n          className=\"w-full\"\n          variant=\"outline\"\n          onClick={() => setLocation(\"/\")}\n          data-testid=\"button-create-order-as-client\"\n        >\n          <Plus className=\"w-4 h-4 mr-2\" />\n          Викликати таксі для себе\n        </Button>\n\n        {isLoading ? (\n          <div className=\"space-y-3\">\n            {[1, 2, 3].map((i) => (\n              <Card key={i} className=\"border-card-border\">\n                <CardHeader className=\"space-y-3\">\n                  <Skeleton className=\"h-6 w-24\" />\n                  <Skeleton className=\"h-4 w-full\" />\n                  <Skeleton className=\"h-4 w-full\" />\n                </CardHeader>\n                <CardContent>\n                  <Skeleton className=\"h-12 w-full\" />\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        ) : orders.length === 0 ? (\n          <div className=\"flex flex-col items-center justify-center py-16 text-center\">\n            <div className=\"w-16 h-16 mb-4 rounded-full bg-muted flex items-center justify-center\">\n              <MapPin className=\"w-8 h-8 text-muted-foreground opacity-40\" />\n            </div>\n            <p className=\"text-base text-muted-foreground\">Немає активних замовлень</p>\n            <p className=\"text-sm text-muted-foreground mt-1\">Нові замовлення з'являться тут</p>\n          </div>\n        ) : (\n          <div className=\"space-y-3\">\n            {orders.map((order) => (\n              <Card\n                key={order.orderId}\n                className={`border-card-border ${order.isTaken && order.driverId !== driverId ? \"opacity-60\" : \"\"}`}\n                data-testid={`card-order-${order.orderId}`}\n              >\n                <CardHeader className=\"space-y-3 pb-3\">\n                  <div className=\"flex items-start justify-between gap-2\">\n                    <Badge variant=\"secondary\" className=\"rounded-full px-3 py-1 text-xs font-semibold\">\n                      {orderTypeLabels[order.type]}\n                    </Badge>\n                    {order.isTaken && order.driverId !== driverId && (\n                      <Badge variant=\"outline\" className=\"rounded-full px-3 py-1 text-xs gap-1\">\n                        <Lock className=\"w-3 h-3\" />\n                        Зайнято\n                      </Badge>\n                    )}\n                    {order.status === \"bidding\" && order.driverId === driverId && (\n                      <Badge variant=\"default\" className=\"rounded-full px-3 py-1 text-xs\">\n                        Очікування відповіді\n                      </Badge>\n                    )}\n                  </div>\n                  <div className=\"space-y-2\">\n                    <div className=\"flex items-start gap-2\">\n                      <MapPin className=\"w-4 h-4 text-primary mt-0.5 flex-shrink-0\" />\n                      <div className=\"text-sm flex-1\">\n                        <span className=\"font-medium\">Звідки:</span> {order.from}\n                      </div>\n                    </div>\n                    <div className=\"flex items-start gap-2\">\n                      <Navigation className=\"w-4 h-4 text-primary mt-0.5 flex-shrink-0\" />\n                      <div className=\"text-sm flex-1\">\n                        <span className=\"font-medium\">Куди:</span> {order.to}\n                      </div>\n                    </div>\n                  </div>\n                  {order.requiredDetail && (\n                    <div className=\"text-sm bg-muted rounded-lg p-3\">\n                      <span className=\"font-medium\">Деталі:</span> {order.requiredDetail}\n                    </div>\n                  )}\n                  {order.comment && (\n                    <div className=\"text-sm text-muted-foreground\">\n                      <span className=\"font-medium\">Коментар:</span> {order.comment}\n                    </div>\n                  )}\n                </CardHeader>\n                <CardContent className=\"pt-0\">\n                  {!order.isTaken ? (\n                    <Button\n                      className=\"w-full h-12 font-semibold\"\n                      onClick={() => handleAcceptOrder(order)}\n                      data-testid={`button-accept-${order.orderId}`}\n                      disabled={acceptOrderMutation.isPending}\n                    >\n                      {acceptOrderMutation.isPending ? \"Обробка...\" : \"Прийняти замовлення\"}\n                    </Button>\n                  ) : order.driverId === driverId ? (\n                    <Button\n                      className=\"w-full h-12\"\n                      variant=\"outline\"\n                      disabled\n                    >\n                      Ваше замовлення - очікуйте відповіді\n                    </Button>\n                  ) : (\n                    <Button\n                      className=\"w-full h-12\"\n                      variant=\"secondary\"\n                      disabled\n                    >\n                      Зайнято іншим водієм\n                    </Button>\n                  )}\n                </CardContent>\n              </Card>\n            ))}\n          </div>\n        )}\n      </div>\n\n      <Dialog open={showBidModal} onOpenChange={setShowBidModal}>\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle>Запропонувати ціну</DialogTitle>\n            <DialogDescription>\n              Вкажіть вашу ціну для замовлення\n            </DialogDescription>\n          </DialogHeader>\n          <div className=\"space-y-4\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"price\">Ціна (грн) *</Label>\n              <Input\n                id=\"price\"\n                type=\"number\"\n                placeholder=\"0\"\n                value={bidPrice}\n                onChange={(e) => setBidPrice(e.target.value)}\n                data-testid=\"input-bid-price\"\n                className=\"text-base h-12\"\n              />\n            </div>\n            <Button\n              className=\"w-full h-12\"\n              onClick={handleSubmitBid}\n              disabled={!bidPrice || proposeBidMutation.isPending}\n              data-testid=\"button-submit-bid\"\n            >\n              {proposeBidMutation.isPending ? \"Відправка...\" : \"Відправити пропозицію\"}\n            </Button>\n          </div>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}\n","size_bytes":10590},"client/src/components/ui/separator.tsx":{"content":"import * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Separator = React.forwardRef<\n  React.ElementRef<typeof SeparatorPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\n>(\n  (\n    { className, orientation = \"horizontal\", decorative = true, ...props },\n    ref\n  ) => (\n    <SeparatorPrimitive.Root\n      ref={ref}\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"shrink-0 bg-border\",\n        orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n)\nSeparator.displayName = SeparatorPrimitive.Root.displayName\n\nexport { Separator }\n","size_bytes":756},"client/src/components/ui/aspect-ratio.tsx":{"content":"import * as AspectRatioPrimitive from \"@radix-ui/react-aspect-ratio\"\n\nconst AspectRatio = AspectRatioPrimitive.Root\n\nexport { AspectRatio }\n","size_bytes":140},"client/src/components/ui/resizable.tsx":{"content":"\"use client\"\n\nimport { GripVertical } from \"lucide-react\"\nimport * as ResizablePrimitive from \"react-resizable-panels\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ResizablePanelGroup = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) => (\n  <ResizablePrimitive.PanelGroup\n    className={cn(\n      \"flex h-full w-full data-[panel-group-direction=vertical]:flex-col\",\n      className\n    )}\n    {...props}\n  />\n)\n\nconst ResizablePanel = ResizablePrimitive.Panel\n\nconst ResizableHandle = ({\n  withHandle,\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {\n  withHandle?: boolean\n}) => (\n  <ResizablePrimitive.PanelResizeHandle\n    className={cn(\n      \"relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90\",\n      className\n    )}\n    {...props}\n  >\n    {withHandle && (\n      <div className=\"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border\">\n        <GripVertical className=\"h-2.5 w-2.5\" />\n      </div>\n    )}\n  </ResizablePrimitive.PanelResizeHandle>\n)\n\nexport { ResizablePanelGroup, ResizablePanel, ResizableHandle }\n","size_bytes":1723},"vite.config.ts":{"content":"import { defineConfig } from \"vite\";\nimport react from \"@vitejs/plugin-react\";\nimport path from \"path\";\nimport runtimeErrorOverlay from \"@replit/vite-plugin-runtime-error-modal\";\n\nexport default defineConfig({\n  plugins: [\n    react(),\n    runtimeErrorOverlay(),\n    ...(process.env.NODE_ENV !== \"production\" &&\n    process.env.REPL_ID !== undefined\n      ? [\n          await import(\"@replit/vite-plugin-cartographer\").then((m) =>\n            m.cartographer(),\n          ),\n          await import(\"@replit/vite-plugin-dev-banner\").then((m) =>\n            m.devBanner(),\n          ),\n        ]\n      : []),\n  ],\n  resolve: {\n    alias: {\n      \"@\": path.resolve(import.meta.dirname, \"client\", \"src\"),\n      \"@shared\": path.resolve(import.meta.dirname, \"shared\"),\n      \"@assets\": path.resolve(import.meta.dirname, \"attached_assets\"),\n    },\n  },\n  root: path.resolve(import.meta.dirname, \"client\"),\n  build: {\n    outDir: path.resolve(import.meta.dirname, \"dist/public\"),\n    emptyOutDir: true,\n  },\n  server: {\n    fs: {\n      strict: true,\n      deny: [\"**/.*\"],\n    },\n  },\n});\n","size_bytes":1080},"3123-main/replit.md":{"content":"# Taxi Bot UA\n\n## Overview\n\nTaxi Bot UA is a Telegram-based taxi dispatch system that connects clients with drivers through a web application integrated with Telegram's Web App API. The system supports multiple service types (taxi, cargo, courier, and tow truck services) with dynamic pricing based on distance. It features real-time order management, driver ratings, notifications, and an administrative dashboard for monitoring and managing the platform.\n\n## User Preferences\n\nPreferred communication style: Simple, everyday language.\n\n## System Architecture\n\n### Frontend Architecture\n\n**Multi-page Web Application**\n- The system uses separate HTML pages for different user roles (client, driver, admin)\n- Each page is a standalone single-page application with embedded JavaScript\n- Telegram Web App SDK integration for seamless Telegram bot interaction\n- Real-time updates via polling to backend REST API endpoints\n- Responsive design optimized for mobile devices within Telegram\n\n**Key Pages:**\n- `index.html` - Landing page with bot information\n- `client.html` - Client interface for placing orders\n- `driver.html` - Driver dashboard for viewing and accepting orders\n- `admin.html` - Administrative panel for system monitoring\n- `announcements.html` - System-wide announcements display\n\n**Design Pattern:**\n- CSS-in-HTML approach with shared `style-enhancements.css` for common animations\n- Gradient-based dark theme UI for consistency across pages\n- Animation-heavy interface with skeleton loaders for better UX\n\n### Backend Architecture\n\n**Node.js + Express Server**\n- RESTful API architecture serving both static files and API endpoints\n- Single `server.js` file containing all backend logic (monolithic approach)\n- No framework-level routing separation - all endpoints defined in main server file\n- CORS enabled for cross-origin requests\n\n**Data Storage:**\n- File-based JSON database (`db.json`) for data persistence\n- No traditional database (PostgreSQL, MongoDB, etc.) - uses simple JSON file reads/writes\n- Synchronous file operations for data consistency\n- In-memory caching for statistics with 30-second TTL to reduce file I/O\n\n**Data Models:**\n```\n- users: User profiles with roles (client/driver/admin)\n- driverCodes: Authentication codes for driver registration\n- orders: Service requests with status tracking\n- ratings: Driver rating system\n- messages: Communication between clients and drivers\n- notifications: System notifications for users\n- rateLimits: Anti-spam protection tracking\n```\n\n**Architectural Decisions:**\n\n1. **File-based Database vs Traditional Database**\n   - Chosen: JSON file storage\n   - Rationale: Simpler deployment, no database server required, suitable for small-to-medium scale\n   - Trade-off: Limited scalability, no ACID guarantees, potential file lock issues under high concurrency\n\n2. **Monolithic Server Structure**\n   - Chosen: Single server.js file with all logic\n   - Rationale: Easier to understand and deploy for small applications\n   - Trade-off: Harder to maintain as application grows, no separation of concerns\n\n3. **Polling vs WebSockets**\n   - Chosen: Client-side polling for real-time updates\n   - Rationale: Simpler implementation, works with static hosting\n   - Trade-off: Higher latency, more server requests, less efficient than WebSockets\n\n4. **Statistics Caching**\n   - Chosen: 30-second in-memory cache for dashboard stats\n   - Rationale: Reduce file I/O operations for frequently accessed data\n   - Trade-off: Slightly stale data, cache invalidation complexity\n\n### Authentication & Authorization\n\n**Multi-level Access Control:**\n- Admin: Password-protected with environment variable configuration\n- Drivers: Code-based registration system with admin-generated access codes\n- Clients: Telegram user ID based authentication (no separate login)\n\n**Rate Limiting:**\n- Order creation limited to 5 requests per minute per user\n- Prevents spam and abuse through in-memory tracking\n- Configurable window and limits via constants\n\n### Service Pricing Engine\n\n**Distance-based Dynamic Pricing:**\n```javascript\nTARIFFS = {\n    'Taxi': { basePrice: 50, perKm: 15 },\n    'Cargo': { basePrice: 100, perKm: 25 },\n    'Courier': { basePrice: 80, perKm: 20 },\n    'Tow Truck': { basePrice: 200, perKm: 30 }\n}\n```\n- Base price + per-kilometer rate calculation\n- Client sees estimated price before order confirmation\n- No surge pricing or time-based variations currently implemented\n\n## External Dependencies\n\n### Third-Party Services\n\n**Telegram Bot API**\n- Primary integration: `node-telegram-bot-api` package\n- Used for bot commands, notifications, and Web App launching\n- Requires `TELEGRAM_BOT_TOKEN` from BotFather\n- Polling mode for receiving updates (not webhook)\n\n**Telegram Web App SDK**\n- Loaded via CDN: `https://telegram.org/js/telegram-web-app.js`\n- Provides theme integration, user data access, and native UI controls\n- Enables launching web interfaces from Telegram chat\n\n### NPM Packages\n\n**Core Dependencies:**\n- `express` (^4.19.2) - Web server framework\n- `node-telegram-bot-api` (^0.66.0) - Telegram bot integration\n- `cors` (^2.8.5) - Cross-origin resource sharing\n- `qrcode` (^1.5.4) - QR code generation for driver codes\n- `leaflet` (^1.9.4) - Map integration (referenced but usage unclear from provided files)\n\n### Environment Configuration\n\n**Required Environment Variables:**\n- `TELEGRAM_BOT_TOKEN` - Bot authentication token\n- `ADMIN_ID` - Telegram user ID of primary administrator\n- `WEB_APP_URL` - Public URL where web app is hosted\n- `ADMIN_PASSWORD` - Password for admin panel access\n- `PORT` - Server port (defaults to 5000)\n\n**Deployment Notes:**\n- Designed for deployment on NomadHost shared hosting\n- Instructions include cPanel setup steps\n- `.env.nomadhost` template provided for production configuration\n- No build process required - direct file upload deployment\n\n### Data Persistence\n\n**File System Dependency:**\n- Writes to `db.json` in application directory\n- Requires write permissions on hosting environment\n- No backup or replication strategy evident\n- No migration system for schema changes","size_bytes":6089},"client/src/components/ui/table.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Table = React.forwardRef<\n  HTMLTableElement,\n  React.HTMLAttributes<HTMLTableElement>\n>(({ className, ...props }, ref) => (\n  <div className=\"relative w-full overflow-auto\">\n    <table\n      ref={ref}\n      className={cn(\"w-full caption-bottom text-sm\", className)}\n      {...props}\n    />\n  </div>\n))\nTable.displayName = \"Table\"\n\nconst TableHeader = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <thead ref={ref} className={cn(\"[&_tr]:border-b\", className)} {...props} />\n))\nTableHeader.displayName = \"TableHeader\"\n\nconst TableBody = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tbody\n    ref={ref}\n    className={cn(\"[&_tr:last-child]:border-0\", className)}\n    {...props}\n  />\n))\nTableBody.displayName = \"TableBody\"\n\nconst TableFooter = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tfoot\n    ref={ref}\n    className={cn(\n      \"border-t bg-muted/50 font-medium [&>tr]:last:border-b-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableFooter.displayName = \"TableFooter\"\n\nconst TableRow = React.forwardRef<\n  HTMLTableRowElement,\n  React.HTMLAttributes<HTMLTableRowElement>\n>(({ className, ...props }, ref) => (\n  <tr\n    ref={ref}\n    className={cn(\n      \"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nTableRow.displayName = \"TableRow\"\n\nconst TableHead = React.forwardRef<\n  HTMLTableCellElement,\n  React.ThHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <th\n    ref={ref}\n    className={cn(\n      \"h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableHead.displayName = \"TableHead\"\n\nconst TableCell = React.forwardRef<\n  HTMLTableCellElement,\n  React.TdHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <td\n    ref={ref}\n    className={cn(\"p-4 align-middle [&:has([role=checkbox])]:pr-0\", className)}\n    {...props}\n  />\n))\nTableCell.displayName = \"TableCell\"\n\nconst TableCaption = React.forwardRef<\n  HTMLTableCaptionElement,\n  React.HTMLAttributes<HTMLTableCaptionElement>\n>(({ className, ...props }, ref) => (\n  <caption\n    ref={ref}\n    className={cn(\"mt-4 text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nTableCaption.displayName = \"TableCaption\"\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n","size_bytes":2765},"client/src/components/ui/input.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n  ({ className, type, ...props }, ref) => {\n    // h-9 to match icon buttons and default buttons.\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n","size_bytes":844},"3123-main/client/src/components/chat.tsx":{"content":"import { useState, useEffect, useRef } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Send } from \"lucide-react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport type { ChatMessage } from \"@shared/schema\";\n\ninterface ChatProps {\n  orderId: string;\n  currentUserId: string;\n  otherUserName: string;\n}\n\nexport default function Chat({ orderId, currentUserId, otherUserName }: ChatProps) {\n  const [newMessage, setNewMessage] = useState(\"\");\n  const messagesEndRef = useRef<HTMLDivElement>(null);\n\n  const { data: messages = [] } = useQuery<ChatMessage[]>({\n    queryKey: [\"/api/chat\", orderId],\n    refetchInterval: 2000,\n  });\n\n  const sendMessageMutation = useMutation({\n    mutationFn: async (message: string) => {\n      return await apiRequest(\"POST\", \"/api/chat\", {\n        orderId,\n        senderId: currentUserId,\n        message,\n      });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/chat\", orderId] });\n      setNewMessage(\"\");\n    },\n  });\n\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\n  };\n\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n\n  const handleSendMessage = () => {\n    if (!newMessage.trim()) return;\n    sendMessageMutation.mutate(newMessage);\n  };\n\n  const handleKeyPress = (e: React.KeyboardEvent) => {\n    if (e.key === \"Enter\" && !e.shiftKey) {\n      e.preventDefault();\n      handleSendMessage();\n    }\n  };\n\n  return (\n    <div className=\"flex flex-col h-full\">\n      <div className=\"sticky top-0 z-10 bg-card border-b border-card-border px-4 py-3\">\n        <h2 className=\"font-semibold\">Чат з {otherUserName}</h2>\n        <p className=\"text-xs text-muted-foreground\">Замовлення #{orderId.slice(0, 8)}</p>\n      </div>\n\n      <div className=\"flex-1 overflow-y-auto p-4 space-y-3\">\n        {messages.length === 0 ? (\n          <div className=\"flex items-center justify-center h-full text-sm text-muted-foreground\">\n            Немає повідомлень. Почніть розмову!\n          </div>\n        ) : (\n          messages.map((msg) => {\n            const isOwn = msg.senderId === currentUserId;\n            return (\n              <div\n                key={msg.id}\n                className={`flex ${isOwn ? \"justify-end\" : \"justify-start\"}`}\n                data-testid={`message-${msg.id}`}\n              >\n                <div\n                  className={`max-w-[80%] rounded-2xl p-3 ${\n                    isOwn\n                      ? \"bg-primary text-primary-foreground rounded-br-sm\"\n                      : \"bg-muted text-foreground rounded-bl-sm\"\n                  }`}\n                >\n                  <div className=\"text-sm break-words\">{msg.message}</div>\n                  <div\n                    className={`text-xs mt-1 ${\n                      isOwn ? \"text-primary-foreground/70\" : \"text-muted-foreground\"\n                    }`}\n                  >\n                    {new Date(msg.createdAt).toLocaleTimeString(\"uk-UA\", {\n                      hour: \"2-digit\",\n                      minute: \"2-digit\",\n                    })}\n                  </div>\n                </div>\n              </div>\n            );\n          })\n        )}\n        <div ref={messagesEndRef} />\n      </div>\n\n      <div className=\"sticky bottom-0 bg-card border-t border-card-border p-4\">\n        <div className=\"flex items-center gap-2\">\n          <Input\n            placeholder=\"Введіть повідомлення...\"\n            value={newMessage}\n            onChange={(e) => setNewMessage(e.target.value)}\n            onKeyPress={handleKeyPress}\n            className=\"flex-1 rounded-full h-12\"\n            data-testid=\"input-message\"\n          />\n          <Button\n            size=\"icon\"\n            onClick={handleSendMessage}\n            disabled={!newMessage.trim() || sendMessageMutation.isPending}\n            className=\"rounded-full h-12 w-12 flex-shrink-0\"\n            data-testid=\"button-send-message\"\n          >\n            <Send className=\"w-5 h-5\" />\n          </Button>\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":4265},"3123-main/server/routes.ts":{"content":"import type { Express } from \"express\";\nimport { createServer, type Server } from \"http\";\nimport { storage } from \"./storage\";\nimport { z } from \"zod\";\nimport {\n  insertUserSchema,\n  insertOrderSchema,\n  insertChatMessageSchema,\n} from \"@shared/schema\";\nimport { handleTelegramUpdate, getBotInfo, autoSetupWebhook } from \"./telegram\";\n\nexport async function registerRoutes(app: Express): Promise<Server> {\n  // User routes\n  app.get(\"/api/users/:id\", async (req, res) => {\n    const user = await storage.getUser(req.params.id);\n    if (!user) {\n      return res.status(404).json({ error: \"User not found\" });\n    }\n    res.json(user);\n  });\n\n  app.post(\"/api/users\", async (req, res) => {\n    try {\n      const data = insertUserSchema.parse(req.body);\n      const user = await storage.createUser(data);\n      res.status(201).json(user);\n    } catch (error) {\n      res.status(400).json({ error: \"Invalid user data\" });\n    }\n  });\n\n  app.patch(\"/api/users/:id\", async (req, res) => {\n    try {\n      const updates = req.body;\n      const user = await storage.updateUser(req.params.id, updates);\n      if (!user) {\n        return res.status(404).json({ error: \"User not found\" });\n      }\n      res.json(user);\n    } catch (error) {\n      res.status(400).json({ error: \"Invalid update data\" });\n    }\n  });\n\n  app.post(\"/api/users/register-driver\", async (req, res) => {\n    try {\n      const schema = z.object({\n        userId: z.string(),\n        code: z.string(),\n        name: z.string(),\n        phone: z.string(),\n      });\n      const data = schema.parse(req.body);\n\n      const user = await storage.registerDriverWithCode(\n        data.userId,\n        data.code,\n        data.name,\n        data.phone\n      );\n\n      if (!user) {\n        return res.status(400).json({ error: \"Invalid or used access code\" });\n      }\n\n      res.status(201).json(user);\n    } catch (error) {\n      res.status(400).json({ error: \"Invalid registration data\" });\n    }\n  });\n\n  // Order routes\n  app.get(\"/api/orders/active\", async (req, res) => {\n    const orders = await storage.getActiveOrders();\n    res.json(orders);\n  });\n\n  app.get(\"/api/orders/:id\", async (req, res) => {\n    const order = await storage.getOrder(req.params.id);\n    if (!order) {\n      return res.status(404).json({ error: \"Order not found\" });\n    }\n    res.json(order);\n  });\n\n  app.get(\"/api/orders/client/:clientId\", async (req, res) => {\n    const orders = await storage.getOrdersByClient(req.params.clientId);\n    res.json(orders);\n  });\n\n  app.get(\"/api/orders/driver/:driverId\", async (req, res) => {\n    const orders = await storage.getOrdersByDriver(req.params.driverId);\n    res.json(orders);\n  });\n\n  app.post(\"/api/orders\", async (req, res) => {\n    try {\n      const data = insertOrderSchema.parse(req.body);\n      const order = await storage.createOrder(data);\n      res.status(201).json(order);\n    } catch (error) {\n      res.status(400).json({ error: \"Invalid order data\" });\n    }\n  });\n\n  app.post(\"/api/orders/:id/accept\", async (req, res) => {\n    try {\n      const schema = z.object({\n        driverId: z.string(),\n      });\n      const data = schema.parse(req.body);\n\n      const order = await storage.acceptOrder(req.params.id, data.driverId);\n      if (!order) {\n        return res.status(400).json({ error: \"Cannot accept order\" });\n      }\n\n      res.json(order);\n    } catch (error) {\n      res.status(400).json({ error: \"Invalid request\" });\n    }\n  });\n\n  app.post(\"/api/orders/:id/bid\", async (req, res) => {\n    try {\n      const schema = z.object({\n        driverId: z.string(),\n        price: z.number().positive(),\n      });\n      const data = schema.parse(req.body);\n\n      const order = await storage.proposeBid(req.params.id, data.driverId, data.price);\n      if (!order) {\n        return res.status(400).json({ error: \"Cannot propose bid\" });\n      }\n\n      res.json(order);\n    } catch (error) {\n      res.status(400).json({ error: \"Invalid bid data\" });\n    }\n  });\n\n  app.post(\"/api/orders/:id/respond\", async (req, res) => {\n    try {\n      const schema = z.object({\n        clientId: z.string(),\n        accepted: z.boolean(),\n      });\n      const data = schema.parse(req.body);\n\n      const order = await storage.respondToBid(req.params.id, data.clientId, data.accepted);\n      if (!order) {\n        return res.status(400).json({ error: \"Cannot respond to bid\" });\n      }\n\n      res.json(order);\n    } catch (error) {\n      res.status(400).json({ error: \"Invalid response data\" });\n    }\n  });\n\n  app.patch(\"/api/orders/:id\", async (req, res) => {\n    try {\n      const updates = req.body;\n      const order = await storage.updateOrder(req.params.id, updates);\n      if (!order) {\n        return res.status(404).json({ error: \"Order not found\" });\n      }\n      res.json(order);\n    } catch (error) {\n      res.status(400).json({ error: \"Invalid update data\" });\n    }\n  });\n\n  // Admin routes\n  app.get(\"/api/admin/drivers\", async (req, res) => {\n    const drivers = await storage.getAllDrivers();\n    res.json(drivers);\n  });\n\n  app.post(\"/api/admin/generate-code\", async (req, res) => {\n    try {\n      const schema = z.object({\n        adminId: z.string(),\n      });\n      const data = schema.parse(req.body);\n\n      const code = await storage.generateAccessCode(data.adminId);\n      res.status(201).json(code);\n    } catch (error) {\n      res.status(400).json({ error: \"Invalid request\" });\n    }\n  });\n\n  app.post(\"/api/admin/drivers/:id/block\", async (req, res) => {\n    try {\n      const driver = await storage.getUser(req.params.id);\n      if (!driver || driver.role !== \"driver\") {\n        return res.status(404).json({ error: \"Driver not found\" });\n      }\n\n      const updated = await storage.updateUser(req.params.id, {\n        isBlocked: !driver.isBlocked,\n      });\n      res.json(updated);\n    } catch (error) {\n      res.status(400).json({ error: \"Cannot block driver\" });\n    }\n  });\n\n  app.post(\"/api/admin/drivers/:id/warning\", async (req, res) => {\n    try {\n      const schema = z.object({\n        text: z.string(),\n      });\n      const data = schema.parse(req.body);\n\n      const driver = await storage.getUser(req.params.id);\n      if (!driver || driver.role !== \"driver\") {\n        return res.status(404).json({ error: \"Driver not found\" });\n      }\n\n      const warnings = driver.warnings || [];\n      const updated = await storage.updateUser(req.params.id, {\n        warnings: [...warnings, data.text],\n      });\n      res.json(updated);\n    } catch (error) {\n      res.status(400).json({ error: \"Cannot add warning\" });\n    }\n  });\n\n  app.post(\"/api/admin/drivers/:id/bonus\", async (req, res) => {\n    try {\n      const schema = z.object({\n        text: z.string(),\n      });\n      const data = schema.parse(req.body);\n\n      const driver = await storage.getUser(req.params.id);\n      if (!driver || driver.role !== \"driver\") {\n        return res.status(404).json({ error: \"Driver not found\" });\n      }\n\n      const bonuses = driver.bonuses || [];\n      const updated = await storage.updateUser(req.params.id, {\n        bonuses: [...bonuses, data.text],\n      });\n      res.json(updated);\n    } catch (error) {\n      res.status(400).json({ error: \"Cannot add bonus\" });\n    }\n  });\n\n  // Chat routes\n  app.get(\"/api/chat/:orderId\", async (req, res) => {\n    const messages = await storage.getChatMessages(req.params.orderId);\n    res.json(messages);\n  });\n\n  app.post(\"/api/chat\", async (req, res) => {\n    try {\n      const data = insertChatMessageSchema.parse(req.body);\n      const message = await storage.sendChatMessage(data);\n      res.status(201).json(message);\n    } catch (error) {\n      res.status(400).json({ error: \"Invalid message data\" });\n    }\n  });\n\n  // Telegram webhook\n  app.post(\"/api/telegram/webhook\", async (req, res) => {\n    try {\n      // Setup webhook on first telegram message (auto-detect from request)\n      if (!process.env.WEBHOOK_SETUP_DONE) {\n        const protocol = req.headers[\"x-forwarded-proto\"] || \"https\";\n        const host = req.headers[\"x-forwarded-host\"] || req.headers.host;\n        if (host) {\n          const baseUrl = `${protocol}://${host}`;\n          await autoSetupWebhook(baseUrl);\n          process.env.WEBHOOK_SETUP_DONE = \"true\";\n        }\n      }\n\n      const update = req.body;\n      await handleTelegramUpdate(update);\n      res.json({ ok: true });\n    } catch (error) {\n      console.error(\"Telegram webhook error:\", error);\n      res.status(500).json({ error: \"Internal server error\" });\n    }\n  });\n\n  // Check bot connection on startup\n  await getBotInfo();\n\n  const httpServer = createServer(app);\n  return httpServer;\n}\n","size_bytes":8625},"client/src/components/ui/skeleton.tsx":{"content":"import { cn } from \"@/lib/utils\"\n\nfunction Skeleton({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\"animate-pulse rounded-md bg-muted\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Skeleton }\n","size_bytes":261},"client/src/pages/role-selector.tsx":{"content":"import { Card } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { User, Car, Shield } from \"lucide-react\";\nimport { useLocation } from \"wouter\";\nimport { useUser } from \"@/lib/use-user\";\nimport type { UserRole } from \"@shared/schema\";\n\ntype RoleWithPath = { role: UserRole; icon: React.ComponentType<{ className?: string }>; label: string; description: string; color: string; path: string }\n\nexport default function RoleSelector() {\n  const [, setLocation] = useLocation();\n  const { setRole } = useUser();\n\n  const roles: RoleWithPath[] = [\n    {\n      role: \"client\",\n      icon: User,\n      label: \"Клієнт\",\n      description: \"Замовити таксі\",\n      color: \"bg-primary text-primary-foreground\",\n      path: \"/client\",\n    },\n    {\n      role: \"driver\",\n      icon: Car,\n      label: \"Водій\",\n      description: \"Приймати замовлення\",\n      color: \"bg-primary text-primary-foreground\",\n      path: \"/driver-register\",\n    },\n  ];\n\n  const handleRoleSelect = (role: UserRole, path: string) => {\n    setRole(role);\n    setLocation(path);\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background flex items-center justify-center p-4\">\n      <div className=\"max-w-md w-full space-y-8\">\n        <div className=\"text-center space-y-2\">\n          <h1 className=\"text-3xl font-bold\">Таксі-Сервіс</h1>\n          <p className=\"text-muted-foreground\">Оберіть вашу роль</p>\n        </div>\n\n        <div className=\"space-y-3\">\n          {roles.map((item) => {\n            const Icon = item.icon;\n            return (\n              <Card\n                key={item.role}\n                className=\"overflow-hidden hover-elevate active-elevate-2 cursor-pointer border-card-border\"\n                onClick={() => handleRoleSelect(item.role, item.path)}\n                data-testid={`button-role-${item.role}`}\n              >\n                <div className=\"p-4 flex items-center gap-4\">\n                  <div className={`${item.color} rounded-xl p-3 flex-shrink-0`}>\n                    <Icon className=\"w-6 h-6\" />\n                  </div>\n                  <div className=\"flex-1\">\n                    <div className=\"font-semibold text-lg\">{item.label}</div>\n                    <div className=\"text-sm text-muted-foreground\">{item.description}</div>\n                  </div>\n                </div>\n              </Card>\n            );\n          })}\n        </div>\n\n        <div className=\"text-center space-y-3\">\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={() => setLocation(\"/admin-login\")}\n            data-testid=\"button-admin-access\"\n            className=\"w-full\"\n          >\n            Доступ для адміністратора\n          </Button>\n          <p className=\"text-xs text-muted-foreground\">\n            Telegram Web App • Версія 1.0\n          </p>\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":2980},"client/src/pages/admin-login.tsx":{"content":"import { useState } from \"react\";\nimport { Card } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { useLocation } from \"wouter\";\nimport { useUser } from \"@/lib/use-user\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { ArrowLeft, Shield } from \"lucide-react\";\n\nconst ADMIN_PASSWORD = \"Kotya11032025!\";\n\nexport default function AdminLogin() {\n  const [, setLocation] = useLocation();\n  const { setRole } = useUser();\n  const { toast } = useToast();\n  const [password, setPassword] = useState(\"\");\n  const [isLoading, setIsLoading] = useState(false);\n\n  const handleLogin = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setIsLoading(true);\n\n    await new Promise((resolve) => setTimeout(resolve, 500));\n\n    if (password === ADMIN_PASSWORD) {\n      setRole(\"admin\");\n      toast({\n        title: \"Успіх\",\n        description: \"Ви увійшли як адміністратор\",\n      });\n      setLocation(\"/admin\");\n    } else {\n      toast({\n        title: \"Помилка\",\n        description: \"Неправильний пароль\",\n        variant: \"destructive\",\n      });\n      setPassword(\"\");\n    }\n\n    setIsLoading(false);\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background flex items-center justify-center p-4\">\n      <div className=\"max-w-md w-full space-y-8\">\n        <Button\n          variant=\"ghost\"\n          size=\"sm\"\n          onClick={() => setLocation(\"/role-selector\")}\n          className=\"mb-4\"\n          data-testid=\"button-back\"\n        >\n          <ArrowLeft className=\"w-4 h-4 mr-2\" />\n          Назад\n        </Button>\n\n        <div className=\"text-center space-y-2\">\n          <div className=\"flex justify-center mb-4\">\n            <div className=\"bg-primary text-primary-foreground rounded-xl p-4\">\n              <Shield className=\"w-8 h-8\" />\n            </div>\n          </div>\n          <h1 className=\"text-3xl font-bold\">Адміністратор</h1>\n          <p className=\"text-muted-foreground\">Введіть пароль для входу</p>\n        </div>\n\n        <Card className=\"p-6\">\n          <form onSubmit={handleLogin} className=\"space-y-4\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"password\">Пароль</Label>\n              <Input\n                id=\"password\"\n                type=\"password\"\n                placeholder=\"••••••••\"\n                value={password}\n                onChange={(e) => setPassword(e.target.value)}\n                disabled={isLoading}\n                data-testid=\"input-admin-password\"\n              />\n            </div>\n\n            <Button\n              type=\"submit\"\n              className=\"w-full\"\n              disabled={isLoading}\n              data-testid=\"button-admin-login\"\n            >\n              {isLoading ? \"Вхід...\" : \"Увійти\"}\n            </Button>\n          </form>\n        </Card>\n\n        <div className=\"text-center text-xs text-muted-foreground pt-4 space-y-1\">\n          <p>Пароль: admin123</p>\n          <p className=\"text-xs text-muted-foreground/70\">\n            (У продакшені пароль зберігатиметься безпечно на сервері)\n          </p>\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":3386},"client/src/components/ui/chart.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as RechartsPrimitive from \"recharts\"\n\nimport { cn } from \"@/lib/utils\"\n\n// Format: { THEME_NAME: CSS_SELECTOR }\nconst THEMES = { light: \"\", dark: \".dark\" } as const\n\nexport type ChartConfig = {\n  [k in string]: {\n    label?: React.ReactNode\n    icon?: React.ComponentType\n  } & (\n    | { color?: string; theme?: never }\n    | { color?: never; theme: Record<keyof typeof THEMES, string> }\n  )\n}\n\ntype ChartContextProps = {\n  config: ChartConfig\n}\n\nconst ChartContext = React.createContext<ChartContextProps | null>(null)\n\nfunction useChart() {\n  const context = React.useContext(ChartContext)\n\n  if (!context) {\n    throw new Error(\"useChart must be used within a <ChartContainer />\")\n  }\n\n  return context\n}\n\nconst ChartContainer = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    config: ChartConfig\n    children: React.ComponentProps<\n      typeof RechartsPrimitive.ResponsiveContainer\n    >[\"children\"]\n  }\n>(({ id, className, children, config, ...props }, ref) => {\n  const uniqueId = React.useId()\n  const chartId = `chart-${id || uniqueId.replace(/:/g, \"\")}`\n\n  return (\n    <ChartContext.Provider value={{ config }}>\n      <div\n        data-chart={chartId}\n        ref={ref}\n        className={cn(\n          \"flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none\",\n          className\n        )}\n        {...props}\n      >\n        <ChartStyle id={chartId} config={config} />\n        <RechartsPrimitive.ResponsiveContainer>\n          {children}\n        </RechartsPrimitive.ResponsiveContainer>\n      </div>\n    </ChartContext.Provider>\n  )\n})\nChartContainer.displayName = \"Chart\"\n\nconst ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {\n  const colorConfig = Object.entries(config).filter(\n    ([, config]) => config.theme || config.color\n  )\n\n  if (!colorConfig.length) {\n    return null\n  }\n\n  return (\n    <style\n      dangerouslySetInnerHTML={{\n        __html: Object.entries(THEMES)\n          .map(\n            ([theme, prefix]) => `\n${prefix} [data-chart=${id}] {\n${colorConfig\n  .map(([key, itemConfig]) => {\n    const color =\n      itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||\n      itemConfig.color\n    return color ? `  --color-${key}: ${color};` : null\n  })\n  .join(\"\\n\")}\n}\n`\n          )\n          .join(\"\\n\"),\n      }}\n    />\n  )\n}\n\nconst ChartTooltip = RechartsPrimitive.Tooltip\n\nconst ChartTooltipContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<typeof RechartsPrimitive.Tooltip> &\n    React.ComponentProps<\"div\"> & {\n      hideLabel?: boolean\n      hideIndicator?: boolean\n      indicator?: \"line\" | \"dot\" | \"dashed\"\n      nameKey?: string\n      labelKey?: string\n    }\n>(\n  (\n    {\n      active,\n      payload,\n      className,\n      indicator = \"dot\",\n      hideLabel = false,\n      hideIndicator = false,\n      label,\n      labelFormatter,\n      labelClassName,\n      formatter,\n      color,\n      nameKey,\n      labelKey,\n    },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    const tooltipLabel = React.useMemo(() => {\n      if (hideLabel || !payload?.length) {\n        return null\n      }\n\n      const [item] = payload\n      const key = `${labelKey || item?.dataKey || item?.name || \"value\"}`\n      const itemConfig = getPayloadConfigFromPayload(config, item, key)\n      const value =\n        !labelKey && typeof label === \"string\"\n          ? config[label as keyof typeof config]?.label || label\n          : itemConfig?.label\n\n      if (labelFormatter) {\n        return (\n          <div className={cn(\"font-medium\", labelClassName)}>\n            {labelFormatter(value, payload)}\n          </div>\n        )\n      }\n\n      if (!value) {\n        return null\n      }\n\n      return <div className={cn(\"font-medium\", labelClassName)}>{value}</div>\n    }, [\n      label,\n      labelFormatter,\n      payload,\n      hideLabel,\n      labelClassName,\n      config,\n      labelKey,\n    ])\n\n    if (!active || !payload?.length) {\n      return null\n    }\n\n    const nestLabel = payload.length === 1 && indicator !== \"dot\"\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl\",\n          className\n        )}\n      >\n        {!nestLabel ? tooltipLabel : null}\n        <div className=\"grid gap-1.5\">\n          {payload.map((item, index) => {\n            const key = `${nameKey || item.name || item.dataKey || \"value\"}`\n            const itemConfig = getPayloadConfigFromPayload(config, item, key)\n            const indicatorColor = color || item.payload.fill || item.color\n\n            return (\n              <div\n                key={item.dataKey}\n                className={cn(\n                  \"flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground\",\n                  indicator === \"dot\" && \"items-center\"\n                )}\n              >\n                {formatter && item?.value !== undefined && item.name ? (\n                  formatter(item.value, item.name, item, index, item.payload)\n                ) : (\n                  <>\n                    {itemConfig?.icon ? (\n                      <itemConfig.icon />\n                    ) : (\n                      !hideIndicator && (\n                        <div\n                          className={cn(\n                            \"shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]\",\n                            {\n                              \"h-2.5 w-2.5\": indicator === \"dot\",\n                              \"w-1\": indicator === \"line\",\n                              \"w-0 border-[1.5px] border-dashed bg-transparent\":\n                                indicator === \"dashed\",\n                              \"my-0.5\": nestLabel && indicator === \"dashed\",\n                            }\n                          )}\n                          style={\n                            {\n                              \"--color-bg\": indicatorColor,\n                              \"--color-border\": indicatorColor,\n                            } as React.CSSProperties\n                          }\n                        />\n                      )\n                    )}\n                    <div\n                      className={cn(\n                        \"flex flex-1 justify-between leading-none\",\n                        nestLabel ? \"items-end\" : \"items-center\"\n                      )}\n                    >\n                      <div className=\"grid gap-1.5\">\n                        {nestLabel ? tooltipLabel : null}\n                        <span className=\"text-muted-foreground\">\n                          {itemConfig?.label || item.name}\n                        </span>\n                      </div>\n                      {item.value && (\n                        <span className=\"font-mono font-medium tabular-nums text-foreground\">\n                          {item.value.toLocaleString()}\n                        </span>\n                      )}\n                    </div>\n                  </>\n                )}\n              </div>\n            )\n          })}\n        </div>\n      </div>\n    )\n  }\n)\nChartTooltipContent.displayName = \"ChartTooltip\"\n\nconst ChartLegend = RechartsPrimitive.Legend\n\nconst ChartLegendContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> &\n    Pick<RechartsPrimitive.LegendProps, \"payload\" | \"verticalAlign\"> & {\n      hideIcon?: boolean\n      nameKey?: string\n    }\n>(\n  (\n    { className, hideIcon = false, payload, verticalAlign = \"bottom\", nameKey },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    if (!payload?.length) {\n      return null\n    }\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"flex items-center justify-center gap-4\",\n          verticalAlign === \"top\" ? \"pb-3\" : \"pt-3\",\n          className\n        )}\n      >\n        {payload.map((item) => {\n          const key = `${nameKey || item.dataKey || \"value\"}`\n          const itemConfig = getPayloadConfigFromPayload(config, item, key)\n\n          return (\n            <div\n              key={item.value}\n              className={cn(\n                \"flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground\"\n              )}\n            >\n              {itemConfig?.icon && !hideIcon ? (\n                <itemConfig.icon />\n              ) : (\n                <div\n                  className=\"h-2 w-2 shrink-0 rounded-[2px]\"\n                  style={{\n                    backgroundColor: item.color,\n                  }}\n                />\n              )}\n              {itemConfig?.label}\n            </div>\n          )\n        })}\n      </div>\n    )\n  }\n)\nChartLegendContent.displayName = \"ChartLegend\"\n\n// Helper to extract item config from a payload.\nfunction getPayloadConfigFromPayload(\n  config: ChartConfig,\n  payload: unknown,\n  key: string\n) {\n  if (typeof payload !== \"object\" || payload === null) {\n    return undefined\n  }\n\n  const payloadPayload =\n    \"payload\" in payload &&\n    typeof payload.payload === \"object\" &&\n    payload.payload !== null\n      ? payload.payload\n      : undefined\n\n  let configLabelKey: string = key\n\n  if (\n    key in payload &&\n    typeof payload[key as keyof typeof payload] === \"string\"\n  ) {\n    configLabelKey = payload[key as keyof typeof payload] as string\n  } else if (\n    payloadPayload &&\n    key in payloadPayload &&\n    typeof payloadPayload[key as keyof typeof payloadPayload] === \"string\"\n  ) {\n    configLabelKey = payloadPayload[\n      key as keyof typeof payloadPayload\n    ] as string\n  }\n\n  return configLabelKey in config\n    ? config[configLabelKey]\n    : config[key as keyof typeof config]\n}\n\nexport {\n  ChartContainer,\n  ChartTooltip,\n  ChartTooltipContent,\n  ChartLegend,\n  ChartLegendContent,\n  ChartStyle,\n}\n","size_bytes":10481},"client/src/components/ui/textarea.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Textarea = React.forwardRef<\n  HTMLTextAreaElement,\n  React.ComponentProps<\"textarea\">\n>(({ className, ...props }, ref) => {\n  return (\n    <textarea\n      className={cn(\n        \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  )\n})\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n","size_bytes":689},"server/app.ts":{"content":"import { type Server } from \"node:http\";\n\nimport express, {\n  type Express,\n  type Request,\n  Response,\n  NextFunction,\n} from \"express\";\n\nimport { registerRoutes } from \"./routes\";\nimport { initTelegramBot } from \"./telegram-bot\";\nimport { storage } from \"./storage\";\n\nexport function log(message: string, source = \"express\") {\n  const formattedTime = new Date().toLocaleTimeString(\"en-US\", {\n    hour: \"numeric\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    hour12: true,\n  });\n\n  console.log(`${formattedTime} [${source}] ${message}`);\n}\n\nexport const app = express();\n\ndeclare module 'http' {\n  interface IncomingMessage {\n    rawBody: unknown\n  }\n}\napp.use(express.json({\n  verify: (req, _res, buf) => {\n    req.rawBody = buf;\n  }\n}));\napp.use(express.urlencoded({ extended: false }));\n\napp.use((req, res, next) => {\n  const start = Date.now();\n  const path = req.path;\n  let capturedJsonResponse: Record<string, any> | undefined = undefined;\n\n  const originalResJson = res.json;\n  res.json = function (bodyJson, ...args) {\n    capturedJsonResponse = bodyJson;\n    return originalResJson.apply(res, [bodyJson, ...args]);\n  };\n\n  res.on(\"finish\", () => {\n    const duration = Date.now() - start;\n    if (path.startsWith(\"/api\")) {\n      let logLine = `${req.method} ${path} ${res.statusCode} in ${duration}ms`;\n      if (capturedJsonResponse) {\n        logLine += ` :: ${JSON.stringify(capturedJsonResponse)}`;\n      }\n\n      if (logLine.length > 80) {\n        logLine = logLine.slice(0, 79) + \"…\";\n      }\n\n      log(logLine);\n    }\n  });\n\n  next();\n});\n\nexport default async function runApp(\n  setup: (app: Express, server: Server) => Promise<void>,\n) {\n  const server = await registerRoutes(app);\n\n  const bot = initTelegramBot(storage);\n  if (bot) {\n    log(\"Telegram bot initialized successfully\", \"telegram\");\n  }\n\n  app.use((err: any, _req: Request, res: Response, _next: NextFunction) => {\n    const status = err.status || err.statusCode || 500;\n    const message = err.message || \"Internal Server Error\";\n\n    res.status(status).json({ message });\n    throw err;\n  });\n\n  // importantly run the final setup after setting up all the other routes so\n  // the catch-all route doesn't interfere with the other routes\n  await setup(app, server);\n\n  // ALWAYS serve the app on the port specified in the environment variable PORT\n  // Other ports are firewalled. Default to 5000 if not specified.\n  // this serves both the API and the client.\n  // It is the only port that is not firewalled.\n  const port = parseInt(process.env.PORT || '5000', 10);\n  server.listen({\n    port,\n    host: \"0.0.0.0\",\n    reusePort: true,\n  }, () => {\n    log(`serving on port ${port}`);\n  });\n}\n","size_bytes":2689},"client/src/hooks/use-toast.ts":{"content":"import * as React from \"react\"\n\nimport type {\n  ToastActionElement,\n  ToastProps,\n} from \"@/components/ui/toast\"\n\nconst TOAST_LIMIT = 1\nconst TOAST_REMOVE_DELAY = 1000000\n\ntype ToasterToast = ToastProps & {\n  id: string\n  title?: React.ReactNode\n  description?: React.ReactNode\n  action?: ToastActionElement\n}\n\nconst actionTypes = {\n  ADD_TOAST: \"ADD_TOAST\",\n  UPDATE_TOAST: \"UPDATE_TOAST\",\n  DISMISS_TOAST: \"DISMISS_TOAST\",\n  REMOVE_TOAST: \"REMOVE_TOAST\",\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType[\"ADD_TOAST\"]\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType[\"UPDATE_TOAST\"]\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType[\"DISMISS_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n  | {\n      type: ActionType[\"REMOVE_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: \"REMOVE_TOAST\",\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case \"ADD_TOAST\":\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case \"UPDATE_TOAST\":\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t\n        ),\n      }\n\n    case \"DISMISS_TOAST\": {\n      const { toastId } = action\n\n      // ! Side effects ! - This could be extracted into a dismissToast() action,\n      // but I'll keep it here for simplicity\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t\n        ),\n      }\n    }\n    case \"REMOVE_TOAST\":\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, \"id\">\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: \"UPDATE_TOAST\",\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: \"DISMISS_TOAST\", toastId: id })\n\n  dispatch({\n    type: \"ADD_TOAST\",\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss()\n      },\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState)\n\n  React.useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: \"DISMISS_TOAST\", toastId }),\n  }\n}\n\nexport { useToast, toast }\n","size_bytes":3895},"3123-main/client/src/pages/driver-profile.tsx":{"content":"import { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { ArrowLeft, User } from \"lucide-react\";\nimport { useLocation } from \"wouter\";\nimport { useMutation, useQuery } from \"@tanstack/react-query\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useUser } from \"@/lib/use-user\";\nimport type { User as UserType } from \"@shared/schema\";\n\nconst profileSchema = z.object({\n  name: z.string().min(2, \"Ім'я має містити мінімум 2 символи\"),\n  phone: z.string().min(10, \"Вкажіть коректний номер телефону\"),\n});\n\nexport default function DriverProfile() {\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n  const { userId: driverId } = useUser();\n\n  const { data: user } = useQuery<UserType>({\n    queryKey: [`/api/users/${driverId}`],\n  });\n\n  const updateProfileMutation = useMutation({\n    mutationFn: async (data: z.infer<typeof profileSchema>) => {\n      return await apiRequest(\"PATCH\", `/api/users/${driverId}`, data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [`/api/users/${driverId}`] });\n      toast({\n        title: \"Профіль оновлено\",\n        description: \"Зміни успішно збережено\",\n      });\n      setLocation(\"/driver\");\n    },\n    onError: () => {\n      toast({\n        title: \"Помилка\",\n        description: \"Не вдалося оновити профіль\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const form = useForm<z.infer<typeof profileSchema>>({\n    resolver: zodResolver(profileSchema),\n    defaultValues: {\n      name: user?.name || \"\",\n      phone: user?.phone || \"\",\n    },\n  });\n\n  const onSubmit = (data: z.infer<typeof profileSchema>) => {\n    updateProfileMutation.mutate(data);\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <div className=\"sticky top-0 z-10 bg-card border-b border-card-border\">\n        <div className=\"max-w-2xl mx-auto px-4 py-3 flex items-center gap-3\">\n          <Button\n            variant=\"ghost\"\n            size=\"icon\"\n            onClick={() => setLocation(\"/driver\")}\n            data-testid=\"button-back\"\n          >\n            <ArrowLeft className=\"w-5 h-5\" />\n          </Button>\n          <div className=\"flex-1\">\n            <h1 className=\"text-lg font-semibold\">Профіль водія</h1>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"max-w-2xl mx-auto p-4\">\n        <Card className=\"border-card-border\">\n          <CardHeader>\n            <CardTitle>Налаштування профілю</CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-6\">\n            <div className=\"flex justify-center\">\n              <Avatar className=\"w-24 h-24\">\n                <AvatarImage src={user?.telegramAvatarUrl || \"\"} alt=\"Аватар водія\" />\n                <AvatarFallback className=\"bg-primary text-primary-foreground text-2xl\">\n                  <User className=\"w-12 h-12\" />\n                </AvatarFallback>\n              </Avatar>\n            </div>\n            <p className=\"text-sm text-center text-muted-foreground\">\n              Аватар автоматично завантажується з вашого профілю Telegram\n            </p>\n\n            <Form {...form}>\n              <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n                <FormField\n                  control={form.control}\n                  name=\"name\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Ім'я *</FormLabel>\n                      <FormControl>\n                        <Input\n                          placeholder=\"Ваше ім'я\"\n                          {...field}\n                          data-testid=\"input-name\"\n                          className=\"text-base h-12\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={form.control}\n                  name=\"phone\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Номер телефону *</FormLabel>\n                      <FormControl>\n                        <Input\n                          type=\"tel\"\n                          placeholder=\"+380 XX XXX XX XX\"\n                          {...field}\n                          data-testid=\"input-phone\"\n                          className=\"text-base h-12\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <Button\n                  type=\"submit\"\n                  className=\"w-full h-14 text-lg font-semibold\"\n                  data-testid=\"button-save-profile\"\n                  disabled={updateProfileMutation.isPending}\n                >\n                  {updateProfileMutation.isPending ? \"Збереження...\" : \"Зберегти профіль\"}\n                </Button>\n              </form>\n            </Form>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}\n","size_bytes":5788},"3123-main/shared/schema.ts":{"content":"import { sql } from \"drizzle-orm\";\nimport { pgTable, text, varchar, boolean, timestamp, integer, real } from \"drizzle-orm/pg-core\";\nimport { createInsertSchema } from \"drizzle-zod\";\nimport { z } from \"zod\";\n\nexport const users = pgTable(\"users\", {\n  id: varchar(\"id\").primaryKey(),\n  role: text(\"role\", { enum: [\"client\", \"driver\", \"admin\"] }).notNull().default(\"client\"),\n  name: text(\"name\"),\n  phone: text(\"phone\"),\n  telegramAvatarUrl: text(\"telegram_avatar_url\"),\n  isBlocked: boolean(\"is_blocked\").default(false),\n  warnings: text(\"warnings\").array().default([]),\n  bonuses: text(\"bonuses\").array().default([]),\n});\n\nexport const orders = pgTable(\"orders\", {\n  orderId: varchar(\"order_id\").primaryKey().default(sql`gen_random_uuid()`),\n  type: text(\"type\", { enum: [\"taxi\", \"cargo\", \"courier\", \"towing\"] }).notNull(),\n  clientId: varchar(\"client_id\").notNull(),\n  driverId: varchar(\"driver_id\"),\n  from: text(\"from\").notNull(),\n  to: text(\"to\").notNull(),\n  comment: text(\"comment\"),\n  requiredDetail: text(\"required_detail\"),\n  status: text(\"status\", { \n    enum: [\"new\", \"bidding\", \"accepted\", \"in_progress\", \"rejected_by_client\", \"completed\"] \n  }).notNull().default(\"new\"),\n  driverBidPrice: real(\"driver_bid_price\"),\n  isTaken: boolean(\"is_taken\").default(false),\n  proposalAttempts: text(\"proposal_attempts\").array().default([]),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const accessCodes = pgTable(\"access_codes\", {\n  code: varchar(\"code\").primaryKey(),\n  isUsed: boolean(\"is_used\").default(false),\n  issuedBy: varchar(\"issued_by\").notNull(),\n  usedBy: varchar(\"used_by\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const chatMessages = pgTable(\"chat_messages\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  orderId: varchar(\"order_id\").notNull(),\n  senderId: varchar(\"sender_id\").notNull(),\n  message: text(\"message\").notNull(),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n});\n\nexport const insertUserSchema = createInsertSchema(users).omit({\n  warnings: true,\n  bonuses: true,\n});\n\nexport const insertOrderSchema = createInsertSchema(orders).omit({\n  orderId: true,\n  createdAt: true,\n  status: true,\n  driverId: true,\n  driverBidPrice: true,\n  isTaken: true,\n  proposalAttempts: true,\n}).extend({\n  type: z.enum([\"taxi\", \"cargo\", \"courier\", \"towing\"]),\n  from: z.string().min(1),\n  to: z.string().min(1),\n  clientId: z.string().min(1),\n  comment: z.string().optional(),\n  requiredDetail: z.string().optional(),\n});\n\nexport const insertAccessCodeSchema = createInsertSchema(accessCodes).omit({\n  createdAt: true,\n});\n\nexport const insertChatMessageSchema = createInsertSchema(chatMessages).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport type User = typeof users.$inferSelect;\nexport type InsertUser = z.infer<typeof insertUserSchema>;\n\nexport type Order = typeof orders.$inferSelect;\nexport type InsertOrder = z.infer<typeof insertOrderSchema>;\n\nexport type AccessCode = typeof accessCodes.$inferSelect;\nexport type InsertAccessCode = z.infer<typeof insertAccessCodeSchema>;\n\nexport type ChatMessage = typeof chatMessages.$inferSelect;\nexport type InsertChatMessage = z.infer<typeof insertChatMessageSchema>;\n\nexport type OrderType = \"taxi\" | \"cargo\" | \"courier\" | \"towing\";\nexport type OrderStatus = \"new\" | \"bidding\" | \"accepted\" | \"in_progress\" | \"rejected_by_client\" | \"completed\";\nexport type UserRole = \"client\" | \"driver\" | \"admin\";\n","size_bytes":3431},"3123-main/public/style-enhancements.css":{"content":"/* АНІМАЦІЇ КАРТОК */\n@keyframes slideInUp {\n    from { opacity: 0; transform: translateY(20px); }\n    to { opacity: 1; transform: translateY(0); }\n}\n\n@keyframes fadeIn {\n    from { opacity: 0; }\n    to { opacity: 1; }\n}\n\n@keyframes shimmer {\n    0% { background-position: -1000px 0; }\n    100% { background-position: 1000px 0; }\n}\n\n@keyframes countUp {\n    from { transform: scale(0.8); opacity: 0; }\n    to { transform: scale(1); opacity: 1; }\n}\n\n@keyframes slideDown {\n    from { transform: translateY(-100%); opacity: 0; }\n    to { transform: translateY(0); opacity: 1; }\n}\n\n@keyframes pulse-glow {\n    0%, 100% { box-shadow: 0 0 5px rgba(102, 126, 234, 0.5); }\n    50% { box-shadow: 0 0 20px rgba(102, 126, 234, 0.8); }\n}\n\n/* СКЕЛЕТОНИ ЗАВАНТАЖЕННЯ */\n.skeleton {\n    background: linear-gradient(90deg, #2a2a3e 25%, #353550 50%, #2a2a3e 75%);\n    background-size: 200% 100%;\n    animation: shimmer 2s infinite;\n    border-radius: 10px;\n}\n\n.skeleton-card {\n    height: 120px;\n    margin-bottom: 15px;\n}\n\n.skeleton-text {\n    height: 16px;\n    margin-bottom: 8px;\n}\n\n/* АНІМАЦІЯ РЕЙТИНГУ */\n.star-animate {\n    animation: countUp 0.3s ease-out;\n}\n\n/* ПРОГРЕС БАР */\n.progress-container {\n    background: #2a2a3e;\n    border-radius: 10px;\n    height: 8px;\n    margin: 15px 0;\n    overflow: hidden;\n}\n\n.progress-bar {\n    height: 100%;\n    background: linear-gradient(90deg, #667eea, #764ba2);\n    animation: slideInUp 0.5s ease-out;\n    transition: width 0.3s ease;\n}\n\n.progress-labels {\n    display: flex;\n    justify-content: space-between;\n    font-size: 12px;\n    color: #b0b0b0;\n    margin-top: 8px;\n}\n\n.progress-label {\n    flex: 1;\n    text-align: center;\n    padding: 5px;\n}\n\n.progress-label.active {\n    color: #667eea;\n    font-weight: 600;\n}\n\n/* МОБІЛЬНЕ МЕНЮ ВНИЗУ */\n.bottom-nav {\n    position: fixed;\n    bottom: 0;\n    left: 0;\n    right: 0;\n    background: rgba(30, 30, 45, 0.98);\n    border-top: 1px solid #3a3a4e;\n    display: flex;\n    justify-content: space-around;\n    padding: 10px 0;\n    z-index: 1000;\n}\n\n.bottom-nav-item {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    gap: 4px;\n    padding: 8px 12px;\n    cursor: pointer;\n    color: #b0b0b0;\n    transition: all 0.2s;\n}\n\n.bottom-nav-item.active {\n    color: #667eea;\n}\n\n.bottom-nav-item:active {\n    transform: scale(0.95);\n}\n\n/* ТЕМА TOGGLE */\n.theme-toggle {\n    position: fixed;\n    top: 20px;\n    right: 20px;\n    width: 50px;\n    height: 50px;\n    background: #2a2a3e;\n    border: 2px solid #3a3a4e;\n    border-radius: 50%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    cursor: pointer;\n    font-size: 24px;\n    z-index: 999;\n    animation: slideDown 0.3s ease-out;\n}\n\n.theme-toggle:hover {\n    box-shadow: 0 0 15px rgba(102, 126, 234, 0.3);\n}\n\n/* СВІТЛА ТЕМА */\nbody.light-theme {\n    background: linear-gradient(135deg, #f5f7fa 0%, #e9ecef 100%);\n    color: #2c3e50;\n}\n\nbody.light-theme .app-container,\nbody.light-theme .card,\nbody.light-theme .empty-state {\n    background: rgba(255, 255, 255, 0.98);\n}\n\nbody.light-theme input, \nbody.light-theme textarea,\nbody.light-theme .service-card,\nbody.light-theme .stat,\nbody.light-theme .driver-stat,\nbody.light-theme .order-item {\n    background: #f5f5f7;\n    color: #1d1d1f;\n}\n\nbody.light-theme .status-text,\nbody.light-theme .driver-name,\nbody.light-theme h1, \nbody.light-theme h2 {\n    color: #1d1d1f;\n}\n\nbody.light-theme .label,\nbody.light-theme .status-info,\nbody.light-theme .status-text {\n    color: #86868b;\n}\n\n/* ЖИВІ ЛІЧИЛЬНИКИ */\n.counter {\n    font-size: 40px;\n    font-weight: 700;\n    color: #667eea;\n    animation: countUp 0.5s ease-out;\n}\n\n/* ФІЛЬТРИ */\n.filters-container {\n    display: flex;\n    gap: 10px;\n    margin-bottom: 20px;\n    overflow-x: auto;\n    padding-bottom: 10px;\n}\n\n.filter-btn {\n    padding: 8px 16px;\n    background: #2a2a3e;\n    color: #b0b0b0;\n    border: 1px solid #3a3a4e;\n    border-radius: 20px;\n    cursor: pointer;\n    white-space: nowrap;\n    transition: all 0.2s;\n    font-size: 14px;\n}\n\n.filter-btn.active {\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    color: white;\n    border-color: #667eea;\n}\n\n.filter-btn:active {\n    transform: scale(0.95);\n}\n\n/* ПОЛІПШЕНІ ЗВУКОВІ СПОВІЩЕННЯ */\n.notification-sound {\n    animation: pulse-glow 0.5s ease-out;\n}\n\n/* ПРОФЕСІЙНІ ЗНАЧКИ */\n.badges-container {\n    display: flex;\n    gap: 8px;\n    flex-wrap: wrap;\n    margin: 10px 0;\n    padding: 10px;\n    background: rgba(102, 126, 234, 0.1);\n    border-radius: 12px;\n}\n\n.badge {\n    display: inline-block;\n    padding: 6px 12px;\n    border-radius: 20px;\n    font-size: 13px;\n    font-weight: 600;\n    background: linear-gradient(135deg, #667eea, #764ba2);\n    color: white;\n    animation: slideInUp 0.3s ease-out;\n    box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);\n}\n\n.badge.legend {\n    background: linear-gradient(135deg, #ffd700, #ffed4e);\n    color: #1d1d1f;\n}\n\n.badge.active {\n    background: linear-gradient(135deg, #ff6b6b, #ff8e72);\n}\n\n.badge.premium {\n    background: linear-gradient(135deg, #667eea, #764ba2);\n    box-shadow: 0 0 15px rgba(102, 126, 234, 0.5);\n}\n\n.badge.perfect {\n    background: linear-gradient(135deg, #00d4ff, #0099ff);\n    animation: pulse-glow 1s infinite;\n}\n","size_bytes":5398},"client/src/components/ui/select.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-9 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronUp className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronDown className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName =\n  SelectPrimitive.ScrollDownButton.displayName\n\nconst SelectContent = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = \"popper\", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]\",\n        position === \"popper\" &&\n          \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectScrollUpButton />\n      <SelectPrimitive.Viewport\n        className={cn(\n          \"p-1\",\n          position === \"popper\" &&\n            \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n        )}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n      <SelectScrollDownButton />\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectLabel = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label\n    ref={ref}\n    className={cn(\"py-1.5 pl-8 pr-2 text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\nconst SelectItem = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nconst SelectSeparator = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n}\n","size_bytes":5741},"3123-main/client/src/main.tsx":{"content":"import { StrictMode } from \"react\";\nimport { createRoot } from \"react-dom/client\";\nimport App from \"./App\";\nimport \"./index.css\";\n\nconst root = document.getElementById(\"root\");\n\nif (!root) {\n  throw new Error(\"Failed to find root element\");\n}\n\ncreateRoot(root).render(\n  <StrictMode>\n    <App />\n  </StrictMode>\n);\n","size_bytes":315},"tailwind.config.ts":{"content":"import type { Config } from \"tailwindcss\";\n\nexport default {\n  darkMode: [\"class\"],\n  content: [\"./client/index.html\", \"./client/src/**/*.{js,jsx,ts,tsx}\"],\n  theme: {\n    extend: {\n      borderRadius: {\n        lg: \".5625rem\", /* 9px */\n        md: \".375rem\", /* 6px */\n        sm: \".1875rem\", /* 3px */\n      },\n      colors: {\n        // Flat / base colors (regular buttons)\n        background: \"hsl(var(--background) / <alpha-value>)\",\n        foreground: \"hsl(var(--foreground) / <alpha-value>)\",\n        border: \"hsl(var(--border) / <alpha-value>)\",\n        input: \"hsl(var(--input) / <alpha-value>)\",\n        card: {\n          DEFAULT: \"hsl(var(--card) / <alpha-value>)\",\n          foreground: \"hsl(var(--card-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--card-border) / <alpha-value>)\",\n        },\n        popover: {\n          DEFAULT: \"hsl(var(--popover) / <alpha-value>)\",\n          foreground: \"hsl(var(--popover-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--popover-border) / <alpha-value>)\",\n        },\n        primary: {\n          DEFAULT: \"hsl(var(--primary) / <alpha-value>)\",\n          foreground: \"hsl(var(--primary-foreground) / <alpha-value>)\",\n          border: \"var(--primary-border)\",\n        },\n        secondary: {\n          DEFAULT: \"hsl(var(--secondary) / <alpha-value>)\",\n          foreground: \"hsl(var(--secondary-foreground) / <alpha-value>)\",\n          border: \"var(--secondary-border)\",\n        },\n        muted: {\n          DEFAULT: \"hsl(var(--muted) / <alpha-value>)\",\n          foreground: \"hsl(var(--muted-foreground) / <alpha-value>)\",\n          border: \"var(--muted-border)\",\n        },\n        accent: {\n          DEFAULT: \"hsl(var(--accent) / <alpha-value>)\",\n          foreground: \"hsl(var(--accent-foreground) / <alpha-value>)\",\n          border: \"var(--accent-border)\",\n        },\n        destructive: {\n          DEFAULT: \"hsl(var(--destructive) / <alpha-value>)\",\n          foreground: \"hsl(var(--destructive-foreground) / <alpha-value>)\",\n          border: \"var(--destructive-border)\",\n        },\n        ring: \"hsl(var(--ring) / <alpha-value>)\",\n        chart: {\n          \"1\": \"hsl(var(--chart-1) / <alpha-value>)\",\n          \"2\": \"hsl(var(--chart-2) / <alpha-value>)\",\n          \"3\": \"hsl(var(--chart-3) / <alpha-value>)\",\n          \"4\": \"hsl(var(--chart-4) / <alpha-value>)\",\n          \"5\": \"hsl(var(--chart-5) / <alpha-value>)\",\n        },\n        sidebar: {\n          ring: \"hsl(var(--sidebar-ring) / <alpha-value>)\",\n          DEFAULT: \"hsl(var(--sidebar) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--sidebar-border) / <alpha-value>)\",\n        },\n        \"sidebar-primary\": {\n          DEFAULT: \"hsl(var(--sidebar-primary) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-primary-foreground) / <alpha-value>)\",\n          border: \"var(--sidebar-primary-border)\",\n        },\n        \"sidebar-accent\": {\n          DEFAULT: \"hsl(var(--sidebar-accent) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-accent-foreground) / <alpha-value>)\",\n          border: \"var(--sidebar-accent-border)\"\n        },\n        status: {\n          online: \"rgb(34 197 94)\",\n          away: \"rgb(245 158 11)\",\n          busy: \"rgb(239 68 68)\",\n          offline: \"rgb(156 163 175)\",\n        },\n      },\n      fontFamily: {\n        sans: [\"var(--font-sans)\"],\n        serif: [\"var(--font-serif)\"],\n        mono: [\"var(--font-mono)\"],\n      },\n      keyframes: {\n        \"accordion-down\": {\n          from: { height: \"0\" },\n          to: { height: \"var(--radix-accordion-content-height)\" },\n        },\n        \"accordion-up\": {\n          from: { height: \"var(--radix-accordion-content-height)\" },\n          to: { height: \"0\" },\n        },\n      },\n      animation: {\n        \"accordion-down\": \"accordion-down 0.2s ease-out\",\n        \"accordion-up\": \"accordion-up 0.2s ease-out\",\n      },\n    },\n  },\n  plugins: [require(\"tailwindcss-animate\"), require(\"@tailwindcss/typography\")],\n} satisfies Config;\n","size_bytes":4050},"client/src/components/ui/toggle.tsx":{"content":"import * as React from \"react\"\nimport * as TogglePrimitive from \"@radix-ui/react-toggle\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst toggleVariants = cva(\n  \"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 gap-2\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline:\n          \"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground\",\n      },\n      size: {\n        default: \"h-10 px-3 min-w-10\",\n        sm: \"h-9 px-2.5 min-w-9\",\n        lg: \"h-11 px-5 min-w-11\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst Toggle = React.forwardRef<\n  React.ElementRef<typeof TogglePrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, ...props }, ref) => (\n  <TogglePrimitive.Root\n    ref={ref}\n    className={cn(toggleVariants({ variant, size, className }))}\n    {...props}\n  />\n))\n\nToggle.displayName = TogglePrimitive.Root.displayName\n\nexport { Toggle, toggleVariants }\n","size_bytes":1527},"3123-main/client/src/pages/role-selector.tsx":{"content":"import { Card } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { User, Car, Shield } from \"lucide-react\";\nimport { useLocation } from \"wouter\";\nimport { useUser } from \"@/lib/use-user\";\nimport type { UserRole } from \"@shared/schema\";\n\ntype RoleWithPath = { role: UserRole; icon: React.ComponentType<{ className?: string }>; label: string; description: string; color: string; path: string }\n\nexport default function RoleSelector() {\n  const [, setLocation] = useLocation();\n  const { setRole } = useUser();\n\n  const roles: RoleWithPath[] = [\n    {\n      role: \"client\",\n      icon: User,\n      label: \"Клієнт\",\n      description: \"Замовити таксі\",\n      color: \"bg-primary text-primary-foreground\",\n      path: \"/\",\n    },\n    {\n      role: \"driver\",\n      icon: Car,\n      label: \"Водій\",\n      description: \"Приймати замовлення\",\n      color: \"bg-primary text-primary-foreground\",\n      path: \"/driver\",\n    },\n  ];\n\n  const handleRoleSelect = (role: UserRole, path: string) => {\n    setRole(role);\n    setLocation(path);\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background flex items-center justify-center p-4\">\n      <div className=\"max-w-md w-full space-y-8\">\n        <div className=\"text-center space-y-2\">\n          <h1 className=\"text-3xl font-bold\">Таксі-Сервіс</h1>\n          <p className=\"text-muted-foreground\">Оберіть вашу роль</p>\n        </div>\n\n        <div className=\"space-y-3\">\n          {roles.map((item) => {\n            const Icon = item.icon;\n            return (\n              <Card\n                key={item.role}\n                className=\"overflow-hidden hover-elevate active-elevate-2 cursor-pointer border-card-border\"\n                onClick={() => handleRoleSelect(item.role, item.path)}\n                data-testid={`button-role-${item.role}`}\n              >\n                <div className=\"p-4 flex items-center gap-4\">\n                  <div className={`${item.color} rounded-xl p-3 flex-shrink-0`}>\n                    <Icon className=\"w-6 h-6\" />\n                  </div>\n                  <div className=\"flex-1\">\n                    <div className=\"font-semibold text-lg\">{item.label}</div>\n                    <div className=\"text-sm text-muted-foreground\">{item.description}</div>\n                  </div>\n                </div>\n              </Card>\n            );\n          })}\n        </div>\n\n        <div className=\"text-center space-y-3\">\n          <Button\n            variant=\"outline\"\n            size=\"sm\"\n            onClick={() => setLocation(\"/admin-login\")}\n            data-testid=\"button-admin-access\"\n            className=\"w-full\"\n          >\n            Доступ для адміністратора\n          </Button>\n          <p className=\"text-xs text-muted-foreground\">\n            Telegram Web App • Версія 1.0\n          </p>\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":2965},"client/src/components/ui/avatar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as AvatarPrimitive from \"@radix-ui/react-avatar\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Avatar = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Root\n    ref={ref}\n    className={cn(`\n      after:content-[''] after:block after:absolute after:inset-0 after:rounded-full after:pointer-events-none after:border after:border-black/10 dark:after:border-white/10\n      relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full`,\n      className\n    )}\n    {...props}\n  />\n))\nAvatar.displayName = AvatarPrimitive.Root.displayName\n\nconst AvatarImage = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Image>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Image\n    ref={ref}\n    className={cn(\"aspect-square h-full w-full\", className)}\n    {...props}\n  />\n))\nAvatarImage.displayName = AvatarPrimitive.Image.displayName\n\nconst AvatarFallback = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Fallback>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Fallback\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full items-center justify-center rounded-full bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatarFallback.displayName = AvatarPrimitive.Fallback.displayName\n\nexport { Avatar, AvatarImage, AvatarFallback }\n","size_bytes":1592},"3123-main/server/storage.ts":{"content":"import {\n  type User,\n  type InsertUser,\n  type Order,\n  type InsertOrder,\n  type AccessCode,\n  type InsertAccessCode,\n  type ChatMessage,\n  type InsertChatMessage,\n} from \"@shared/schema\";\nimport { randomUUID } from \"crypto\";\n\nexport interface IStorage {\n  // User methods\n  getUser(id: string): Promise<User | undefined>;\n  createUser(user: InsertUser): Promise<User>;\n  updateUser(id: string, updates: Partial<User>): Promise<User | undefined>;\n  getAllDrivers(): Promise<User[]>;\n  registerDriverWithCode(userId: string, code: string, name: string, phone: string): Promise<User | null>;\n\n  // Order methods\n  getOrder(orderId: string): Promise<Order | undefined>;\n  getActiveOrders(): Promise<Order[]>;\n  getOrdersByClient(clientId: string): Promise<Order[]>;\n  getOrdersByDriver(driverId: string): Promise<Order[]>;\n  createOrder(order: InsertOrder): Promise<Order>;\n  updateOrder(orderId: string, updates: Partial<Order>): Promise<Order | undefined>;\n  acceptOrder(orderId: string, driverId: string): Promise<Order | undefined>;\n  proposeBid(orderId: string, driverId: string, price: number): Promise<Order | undefined>;\n  respondToBid(orderId: string, clientId: string, accepted: boolean): Promise<Order | undefined>;\n\n  // Access Code methods\n  generateAccessCode(issuedBy: string): Promise<AccessCode>;\n  validateAccessCode(code: string): Promise<AccessCode | undefined>;\n  markCodeAsUsed(code: string, userId: string): Promise<boolean>;\n\n  // Chat methods\n  getChatMessages(orderId: string): Promise<ChatMessage[]>;\n  sendChatMessage(message: InsertChatMessage): Promise<ChatMessage>;\n}\n\nexport class MemStorage implements IStorage {\n  private users: Map<string, User>;\n  private orders: Map<string, Order>;\n  private accessCodes: Map<string, AccessCode>;\n  private chatMessages: Map<string, ChatMessage[]>;\n\n  constructor() {\n    this.users = new Map();\n    this.orders = new Map();\n    this.accessCodes = new Map();\n    this.chatMessages = new Map();\n\n    // Create a default admin for testing\n    this.users.set(\"admin1\", {\n      id: \"admin1\",\n      role: \"admin\",\n      name: \"Адміністратор\",\n      phone: \"+380501111111\",\n      telegramAvatarUrl: null,\n      isBlocked: false,\n      warnings: [],\n      bonuses: [],\n    });\n  }\n\n  // User methods\n  async getUser(id: string): Promise<User | undefined> {\n    return this.users.get(id);\n  }\n\n  async createUser(insertUser: InsertUser): Promise<User> {\n    const user: User = {\n      ...insertUser,\n      isBlocked: false,\n      warnings: [],\n      bonuses: [],\n    };\n    this.users.set(user.id, user);\n    return user;\n  }\n\n  async updateUser(id: string, updates: Partial<User>): Promise<User | undefined> {\n    const user = this.users.get(id);\n    if (!user) return undefined;\n\n    const updatedUser = { ...user, ...updates };\n    this.users.set(id, updatedUser);\n    return updatedUser;\n  }\n\n  async getAllDrivers(): Promise<User[]> {\n    return Array.from(this.users.values()).filter((user) => user.role === \"driver\");\n  }\n\n  async registerDriverWithCode(\n    userId: string,\n    code: string,\n    name: string,\n    phone: string\n  ): Promise<User | null> {\n    const accessCode = await this.validateAccessCode(code);\n    if (!accessCode || accessCode.isUsed) {\n      return null;\n    }\n\n    const user = await this.createUser({\n      id: userId,\n      role: \"driver\",\n      name,\n      phone,\n      telegramAvatarUrl: null,\n    });\n\n    await this.markCodeAsUsed(code, userId);\n    return user;\n  }\n\n  // Order methods\n  async getOrder(orderId: string): Promise<Order | undefined> {\n    return this.orders.get(orderId);\n  }\n\n  async getActiveOrders(): Promise<Order[]> {\n    return Array.from(this.orders.values()).filter(\n      (order) => order.status === \"new\" || order.status === \"bidding\"\n    );\n  }\n\n  async getOrdersByClient(clientId: string): Promise<Order[]> {\n    return Array.from(this.orders.values()).filter((order) => order.clientId === clientId);\n  }\n\n  async getOrdersByDriver(driverId: string): Promise<Order[]> {\n    return Array.from(this.orders.values()).filter((order) => order.driverId === driverId);\n  }\n\n  async createOrder(insertOrder: InsertOrder): Promise<Order> {\n    const orderId = randomUUID();\n    const order: Order = {\n      orderId,\n      ...insertOrder,\n      status: \"new\",\n      driverId: null,\n      driverBidPrice: null,\n      isTaken: false,\n      proposalAttempts: [],\n      createdAt: new Date(),\n    };\n    this.orders.set(orderId, order);\n    return order;\n  }\n\n  async updateOrder(orderId: string, updates: Partial<Order>): Promise<Order | undefined> {\n    const order = this.orders.get(orderId);\n    if (!order) return undefined;\n\n    const updatedOrder = { ...order, ...updates };\n    this.orders.set(orderId, updatedOrder);\n    return updatedOrder;\n  }\n\n  async acceptOrder(orderId: string, driverId: string): Promise<Order | undefined> {\n    const order = this.orders.get(orderId);\n    if (!order) return undefined;\n\n    // Check if order is already taken\n    if (order.isTaken && order.driverId !== driverId) {\n      return undefined;\n    }\n\n    const driver = await this.getUser(driverId);\n    if (!driver || driver.role !== \"driver\" || driver.isBlocked) {\n      return undefined;\n    }\n\n    // Check if driver already attempted this order and was rejected\n    if (order.proposalAttempts.includes(driverId)) {\n      return undefined;\n    }\n\n    const updatedOrder = {\n      ...order,\n      driverId,\n      isTaken: true,\n      status: \"bidding\" as const,\n    };\n    this.orders.set(orderId, updatedOrder);\n    return updatedOrder;\n  }\n\n  async proposeBid(orderId: string, driverId: string, price: number): Promise<Order | undefined> {\n    const order = this.orders.get(orderId);\n    if (!order || order.driverId !== driverId || order.status !== \"bidding\") {\n      return undefined;\n    }\n\n    const updatedOrder = {\n      ...order,\n      driverBidPrice: price,\n    };\n    this.orders.set(orderId, updatedOrder);\n    return updatedOrder;\n  }\n\n  async respondToBid(\n    orderId: string,\n    clientId: string,\n    accepted: boolean\n  ): Promise<Order | undefined> {\n    const order = this.orders.get(orderId);\n    if (!order || order.clientId !== clientId || order.status !== \"bidding\") {\n      return undefined;\n    }\n\n    if (accepted) {\n      const updatedOrder = {\n        ...order,\n        status: \"in_progress\" as const,\n      };\n      this.orders.set(orderId, updatedOrder);\n      return updatedOrder;\n    } else {\n      // Reject - add driver to proposal attempts and reset\n      const updatedOrder = {\n        ...order,\n        driverId: null,\n        driverBidPrice: null,\n        isTaken: false,\n        status: \"new\" as const,\n        proposalAttempts: [...order.proposalAttempts, order.driverId!],\n      };\n      this.orders.set(orderId, updatedOrder);\n      return updatedOrder;\n    }\n  }\n\n  // Access Code methods\n  async generateAccessCode(issuedBy: string): Promise<AccessCode> {\n    const code = Math.random().toString(36).substring(2, 8).toUpperCase();\n    const accessCode: AccessCode = {\n      code,\n      isUsed: false,\n      issuedBy,\n      usedBy: null,\n      createdAt: new Date(),\n    };\n    this.accessCodes.set(code, accessCode);\n    return accessCode;\n  }\n\n  async validateAccessCode(code: string): Promise<AccessCode | undefined> {\n    return this.accessCodes.get(code);\n  }\n\n  async markCodeAsUsed(code: string, userId: string): Promise<boolean> {\n    const accessCode = this.accessCodes.get(code);\n    if (!accessCode || accessCode.isUsed) return false;\n\n    const updatedCode = {\n      ...accessCode,\n      isUsed: true,\n      usedBy: userId,\n    };\n    this.accessCodes.set(code, updatedCode);\n    return true;\n  }\n\n  // Chat methods\n  async getChatMessages(orderId: string): Promise<ChatMessage[]> {\n    return this.chatMessages.get(orderId) || [];\n  }\n\n  async sendChatMessage(insertMessage: InsertChatMessage): Promise<ChatMessage> {\n    const id = randomUUID();\n    const message: ChatMessage = {\n      id,\n      ...insertMessage,\n      createdAt: new Date(),\n    };\n\n    const messages = this.chatMessages.get(insertMessage.orderId) || [];\n    messages.push(message);\n    this.chatMessages.set(insertMessage.orderId, messages);\n\n    return message;\n  }\n}\n\nexport const storage = new MemStorage();\n","size_bytes":8265},"client/src/lib/user-provider.tsx":{"content":"import { createContext, useState, ReactNode, useEffect } from \"react\";\nimport type { UserRole } from \"@shared/schema\";\n\nexport interface UserContextType {\n  userId: string;\n  role: UserRole;\n  setRole: (role: UserRole) => void;\n  isLoading: boolean;\n}\n\nexport const UserContext = createContext<UserContextType>({\n  userId: \"\",\n  role: \"client\",\n  setRole: () => {},\n  isLoading: true,\n} as UserContextType);\n\nexport function UserProvider({ children }: { children: ReactNode }) {\n  const [role, setRole] = useState<UserRole>(\"client\");\n  const [isLoading, setIsLoading] = useState(true);\n  const [userIdState, setUserIdState] = useState<string>(\"\");\n\n  useEffect(() => {\n    const initializeUser = async () => {\n      try {\n        // Check URL parameters first (for testing)\n        const params = new URLSearchParams(window.location.search);\n        let telegramUserId = params.get(\"userId\") ? parseInt(params.get(\"userId\")!) : null;\n        \n        // Get Telegram user ID from Web App\n        if (!telegramUserId) {\n          const tg = (window as any).Telegram?.WebApp;\n          telegramUserId = tg?.initData ? tg.initDataUnsafe?.user?.id : null;\n        }\n        \n        // Fallback: check localStorage for development/testing\n        if (!telegramUserId) {\n          const savedId = localStorage.getItem(\"__dev_telegram_id__\");\n          if (savedId) {\n            telegramUserId = parseInt(savedId);\n          }\n        }\n\n        if (!telegramUserId) {\n          setUserIdState(`client-${Math.random().toString(36).substring(7)}`);\n          setIsLoading(false);\n          return;\n        }\n\n        console.log(\"🔐 Initializing user with ID:\", telegramUserId);\n\n        // Fetch user role from backend\n        try {\n          const response = await fetch(`/api/users/${telegramUserId}`);\n          console.log(\"📡 User fetch response:\", response.status);\n          \n          if (response.ok) {\n            const user = await response.json();\n            console.log(\"✅ User loaded:\", user.role, user.id);\n            setRole(user.role);\n            setUserIdState(user.id);\n          } else {\n            // User doesn't exist yet, create as client\n            console.log(\"ℹ️ User not found, setting as client\");\n            setUserIdState(telegramUserId.toString());\n            setRole(\"client\");\n          }\n        } catch (error) {\n          console.error(\"❌ Error fetching user:\", error);\n          setUserIdState(telegramUserId.toString());\n          setRole(\"client\");\n        }\n      } catch (error) {\n        console.error(\"❌ Error initializing user:\", error);\n        setUserIdState(`client-${Math.random().toString(36).substring(7)}`);\n        setRole(\"client\");\n      } finally {\n        setIsLoading(false);\n      }\n    };\n\n    initializeUser();\n  }, []);\n\n  const userId = userIdState || (role === \"admin\" \n    ? \"admin1\" \n    : `${role}-${Math.random().toString(36).substring(7)}`);\n\n  const value: UserContextType = {\n    userId,\n    role,\n    setRole,\n    isLoading,\n  };\n\n  return (\n    <UserContext.Provider value={value}>\n      {children}\n    </UserContext.Provider>\n  );\n}\n","size_bytes":3124},"client/src/components/ui/button.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\" +\n  \" hover-elevate active-elevate-2\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"bg-primary text-primary-foreground border border-primary-border\",\n        destructive:\n          \"bg-destructive text-destructive-foreground border border-destructive-border\",\n        outline:\n          // Shows the background color of whatever card / sidebar / accent background it is inside of.\n          // Inherits the current text color.\n          \" border [border-color:var(--button-outline)]  shadow-xs active:shadow-none \",\n        secondary: \"border bg-secondary text-secondary-foreground border border-secondary-border \",\n        // Add a transparent border so that when someone toggles a border on later, it doesn't shift layout/size.\n        ghost: \"border border-transparent\",\n      },\n      // Heights are set as \"min\" heights, because sometimes Ai will place large amount of content\n      // inside buttons. With a min-height they will look appropriate with small amounts of content,\n      // but will expand to fit large amounts of content.\n      size: {\n        default: \"min-h-9 px-4 py-2\",\n        sm: \"min-h-8 rounded-md px-3 text-xs\",\n        lg: \"min-h-10 rounded-md px-8\",\n        icon: \"h-9 w-9\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  },\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  },\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n","size_bytes":2359},"client/src/components/chat.tsx":{"content":"import { useState, useEffect, useRef } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Send } from \"lucide-react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport type { ChatMessage } from \"@shared/schema\";\n\ninterface ChatProps {\n  orderId: string;\n  currentUserId: string;\n  otherUserName: string;\n}\n\nexport default function Chat({ orderId, currentUserId, otherUserName }: ChatProps) {\n  const [newMessage, setNewMessage] = useState(\"\");\n  const messagesEndRef = useRef<HTMLDivElement>(null);\n\n  const { data: messages = [] } = useQuery<ChatMessage[]>({\n    queryKey: [\"/api/chat\", orderId],\n    refetchInterval: 2000,\n  });\n\n  const sendMessageMutation = useMutation({\n    mutationFn: async (message: string) => {\n      return await apiRequest(\"POST\", \"/api/chat\", {\n        orderId,\n        senderId: currentUserId,\n        message,\n      });\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/chat\", orderId] });\n      setNewMessage(\"\");\n    },\n  });\n\n  const scrollToBottom = () => {\n    messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\n  };\n\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n\n  const handleSendMessage = () => {\n    if (!newMessage.trim()) return;\n    sendMessageMutation.mutate(newMessage);\n  };\n\n  const handleKeyPress = (e: React.KeyboardEvent) => {\n    if (e.key === \"Enter\" && !e.shiftKey) {\n      e.preventDefault();\n      handleSendMessage();\n    }\n  };\n\n  return (\n    <div className=\"flex flex-col h-full\">\n      <div className=\"sticky top-0 z-10 bg-card border-b border-card-border px-4 py-3\">\n        <h2 className=\"font-semibold\">Чат з {otherUserName}</h2>\n        <p className=\"text-xs text-muted-foreground\">Замовлення #{orderId.slice(0, 8)}</p>\n      </div>\n\n      <div className=\"flex-1 overflow-y-auto p-4 space-y-3\">\n        {messages.length === 0 ? (\n          <div className=\"flex items-center justify-center h-full text-sm text-muted-foreground\">\n            Немає повідомлень. Почніть розмову!\n          </div>\n        ) : (\n          messages.map((msg) => {\n            const isOwn = msg.senderId === currentUserId;\n            return (\n              <div\n                key={msg.id}\n                className={`flex ${isOwn ? \"justify-end\" : \"justify-start\"}`}\n                data-testid={`message-${msg.id}`}\n              >\n                <div\n                  className={`max-w-[80%] rounded-2xl p-3 ${\n                    isOwn\n                      ? \"bg-primary text-primary-foreground rounded-br-sm\"\n                      : \"bg-muted text-foreground rounded-bl-sm\"\n                  }`}\n                >\n                  <div className=\"text-sm break-words\">{msg.message}</div>\n                  <div\n                    className={`text-xs mt-1 ${\n                      isOwn ? \"text-primary-foreground/70\" : \"text-muted-foreground\"\n                    }`}\n                  >\n                    {new Date(msg.createdAt).toLocaleTimeString(\"uk-UA\", {\n                      hour: \"2-digit\",\n                      minute: \"2-digit\",\n                    })}\n                  </div>\n                </div>\n              </div>\n            );\n          })\n        )}\n        <div ref={messagesEndRef} />\n      </div>\n\n      <div className=\"sticky bottom-0 bg-card border-t border-card-border p-4\">\n        <div className=\"flex items-center gap-2\">\n          <Input\n            placeholder=\"Введіть повідомлення...\"\n            value={newMessage}\n            onChange={(e) => setNewMessage(e.target.value)}\n            onKeyPress={handleKeyPress}\n            className=\"flex-1 rounded-full h-12\"\n            data-testid=\"input-message\"\n          />\n          <Button\n            size=\"icon\"\n            onClick={handleSendMessage}\n            disabled={!newMessage.trim() || sendMessageMutation.isPending}\n            className=\"rounded-full h-12 w-12 flex-shrink-0\"\n            data-testid=\"button-send-message\"\n          >\n            <Send className=\"w-5 h-5\" />\n          </Button>\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":4265},"client/src/components/ui/switch.tsx":{"content":"import * as React from \"react\"\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\n>(({ className, ...props }, ref) => (\n  <SwitchPrimitives.Root\n    className={cn(\n      \"peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  >\n    <SwitchPrimitives.Thumb\n      className={cn(\n        \"pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0\"\n      )}\n    />\n  </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }\n","size_bytes":1139},"client/src/components/ui/sidebar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, VariantProps } from \"class-variance-authority\"\nimport { PanelLeftIcon } from \"lucide-react\"\n\nimport { useIsMobile } from \"@/hooks/use-mobile\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Separator } from \"@/components/ui/separator\"\nimport {\n  Sheet,\n  SheetContent,\n  SheetDescription,\n  SheetHeader,\n  SheetTitle,\n} from \"@/components/ui/sheet\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\"\n\nconst SIDEBAR_COOKIE_NAME = \"sidebar_state\"\nconst SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7\nconst SIDEBAR_WIDTH = \"16rem\"\nconst SIDEBAR_WIDTH_MOBILE = \"18rem\"\nconst SIDEBAR_WIDTH_ICON = \"3rem\"\nconst SIDEBAR_KEYBOARD_SHORTCUT = \"b\"\n\ntype SidebarContextProps = {\n  state: \"expanded\" | \"collapsed\"\n  open: boolean\n  setOpen: (open: boolean) => void\n  openMobile: boolean\n  setOpenMobile: (open: boolean) => void\n  isMobile: boolean\n  toggleSidebar: () => void\n}\n\nconst SidebarContext = React.createContext<SidebarContextProps | null>(null)\n\nfunction useSidebar() {\n  const context = React.useContext(SidebarContext)\n  if (!context) {\n    throw new Error(\"useSidebar must be used within a SidebarProvider.\")\n  }\n\n  return context\n}\n\nfunction SidebarProvider({\n  defaultOpen = true,\n  open: openProp,\n  onOpenChange: setOpenProp,\n  className,\n  style,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  defaultOpen?: boolean\n  open?: boolean\n  onOpenChange?: (open: boolean) => void\n}) {\n  const isMobile = useIsMobile()\n  const [openMobile, setOpenMobile] = React.useState(false)\n\n  // This is the internal state of the sidebar.\n  // We use openProp and setOpenProp for control from outside the component.\n  const [_open, _setOpen] = React.useState(defaultOpen)\n  const open = openProp ?? _open\n  const setOpen = React.useCallback(\n    (value: boolean | ((value: boolean) => boolean)) => {\n      const openState = typeof value === \"function\" ? value(open) : value\n      if (setOpenProp) {\n        setOpenProp(openState)\n      } else {\n        _setOpen(openState)\n      }\n\n      // This sets the cookie to keep the sidebar state.\n      document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`\n    },\n    [setOpenProp, open]\n  )\n\n  // Helper to toggle the sidebar.\n  const toggleSidebar = React.useCallback(() => {\n    return isMobile ? setOpenMobile((open) => !open) : setOpen((open) => !open)\n  }, [isMobile, setOpen, setOpenMobile])\n\n  // Adds a keyboard shortcut to toggle the sidebar.\n  React.useEffect(() => {\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (\n        event.key === SIDEBAR_KEYBOARD_SHORTCUT &&\n        (event.metaKey || event.ctrlKey)\n      ) {\n        event.preventDefault()\n        toggleSidebar()\n      }\n    }\n\n    window.addEventListener(\"keydown\", handleKeyDown)\n    return () => window.removeEventListener(\"keydown\", handleKeyDown)\n  }, [toggleSidebar])\n\n  // We add a state so that we can do data-state=\"expanded\" or \"collapsed\".\n  // This makes it easier to style the sidebar with Tailwind classes.\n  const state = open ? \"expanded\" : \"collapsed\"\n\n  const contextValue = React.useMemo<SidebarContextProps>(\n    () => ({\n      state,\n      open,\n      setOpen,\n      isMobile,\n      openMobile,\n      setOpenMobile,\n      toggleSidebar,\n    }),\n    [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]\n  )\n\n  return (\n    <SidebarContext.Provider value={contextValue}>\n      <TooltipProvider delayDuration={0}>\n        <div\n          data-slot=\"sidebar-wrapper\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH,\n              \"--sidebar-width-icon\": SIDEBAR_WIDTH_ICON,\n              ...style,\n            } as React.CSSProperties\n          }\n          className={cn(\n            \"group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full\",\n            className\n          )}\n          {...props}\n        >\n          {children}\n        </div>\n      </TooltipProvider>\n    </SidebarContext.Provider>\n  )\n}\n\nfunction Sidebar({\n  side = \"left\",\n  variant = \"sidebar\",\n  collapsible = \"offcanvas\",\n  className,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  side?: \"left\" | \"right\"\n  variant?: \"sidebar\" | \"floating\" | \"inset\"\n  collapsible?: \"offcanvas\" | \"icon\" | \"none\"\n}) {\n  const { isMobile, state, openMobile, setOpenMobile } = useSidebar()\n\n  if (collapsible === \"none\") {\n    return (\n      <div\n        data-slot=\"sidebar\"\n        className={cn(\n          \"bg-sidebar text-sidebar-foreground flex h-full w-[var(--sidebar-width)] flex-col\",\n          className\n        )}\n        {...props}\n      >\n        {children}\n      </div>\n    )\n  }\n\n  if (isMobile) {\n    return (\n      <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>\n        <SheetContent\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar\"\n          data-mobile=\"true\"\n          className=\"bg-sidebar text-sidebar-foreground w-[var(--sidebar-width)] p-0 [&>button]:hidden\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH_MOBILE,\n            } as React.CSSProperties\n          }\n          side={side}\n        >\n          <SheetHeader className=\"sr-only\">\n            <SheetTitle>Sidebar</SheetTitle>\n            <SheetDescription>Displays the mobile sidebar.</SheetDescription>\n          </SheetHeader>\n          <div className=\"flex h-full w-full flex-col\">{children}</div>\n        </SheetContent>\n      </Sheet>\n    )\n  }\n\n  return (\n    <div\n      className=\"group peer text-sidebar-foreground hidden md:block\"\n      data-state={state}\n      data-collapsible={state === \"collapsed\" ? collapsible : \"\"}\n      data-variant={variant}\n      data-side={side}\n      data-slot=\"sidebar\"\n    >\n      {/* This is what handles the sidebar gap on desktop */}\n      <div\n        data-slot=\"sidebar-gap\"\n        className={cn(\n          \"relative w-[var(--sidebar-width)] bg-transparent transition-[width] duration-200 ease-linear\",\n          \"group-data-[collapsible=offcanvas]:w-0\",\n          \"group-data-[side=right]:rotate-180\",\n          variant === \"floating\" || variant === \"inset\"\n            ? \"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4))]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)]\"\n        )}\n      />\n      <div\n        data-slot=\"sidebar-container\"\n        className={cn(\n          \"fixed inset-y-0 z-10 hidden h-svh w-[var(--sidebar-width)] transition-[left,right,width] duration-200 ease-linear md:flex\",\n          side === \"left\"\n            ? \"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]\"\n            : \"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]\",\n          // Adjust the padding for floating and inset variants.\n          variant === \"floating\" || variant === \"inset\"\n            ? \"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4)+2px)]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)] group-data-[side=left]:border-r group-data-[side=right]:border-l\",\n          className\n        )}\n        {...props}\n      >\n        <div\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar-inner\"\n          className=\"bg-sidebar group-data-[variant=floating]:border-sidebar-border flex h-full w-full flex-col group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow-sm\"\n        >\n          {children}\n        </div>\n      </div>\n    </div>\n  )\n}\n\nfunction SidebarTrigger({\n  className,\n  onClick,\n  ...props\n}: React.ComponentProps<typeof Button>) {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <Button\n      data-sidebar=\"trigger\"\n      data-slot=\"sidebar-trigger\"\n      variant=\"ghost\"\n      size=\"icon\"\n      className={cn(\"h-7 w-7\", className)}\n      onClick={(event) => {\n        onClick?.(event)\n        toggleSidebar()\n      }}\n      {...props}\n    >\n      <PanelLeftIcon />\n      <span className=\"sr-only\">Toggle Sidebar</span>\n    </Button>\n  )\n}\n\nfunction SidebarRail({ className, ...props }: React.ComponentProps<\"button\">) {\n  const { toggleSidebar } = useSidebar()\n\n  // Note: Tailwind v3.4 doesn't support \"in-\" selectors. So the rail won't work perfectly.\n  return (\n    <button\n      data-sidebar=\"rail\"\n      data-slot=\"sidebar-rail\"\n      aria-label=\"Toggle Sidebar\"\n      tabIndex={-1}\n      onClick={toggleSidebar}\n      title=\"Toggle Sidebar\"\n      className={cn(\n        \"hover:after:bg-sidebar-border absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear group-data-[side=left]:-right-4 group-data-[side=right]:left-0 after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] sm:flex\",\n        \"in-data-[side=left]:cursor-w-resize in-data-[side=right]:cursor-e-resize\",\n        \"[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize\",\n        \"hover:group-data-[collapsible=offcanvas]:bg-sidebar group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full\",\n        \"[[data-side=left][data-collapsible=offcanvas]_&]:-right-2\",\n        \"[[data-side=right][data-collapsible=offcanvas]_&]:-left-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInset({ className, ...props }: React.ComponentProps<\"main\">) {\n  return (\n    <main\n      data-slot=\"sidebar-inset\"\n      className={cn(\n        \"bg-background relative flex w-full flex-1 flex-col\",\n        \"md:peer-data-[variant=inset]:m-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow-sm md:peer-data-[variant=inset]:peer-data-[state=collapsed]:ml-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInput({\n  className,\n  ...props\n}: React.ComponentProps<typeof Input>) {\n  return (\n    <Input\n      data-slot=\"sidebar-input\"\n      data-sidebar=\"input\"\n      className={cn(\"bg-background h-8 w-full shadow-none\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-header\"\n      data-sidebar=\"header\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-footer\"\n      data-sidebar=\"footer\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarSeparator({\n  className,\n  ...props\n}: React.ComponentProps<typeof Separator>) {\n  return (\n    <Separator\n      data-slot=\"sidebar-separator\"\n      data-sidebar=\"separator\"\n      className={cn(\"bg-sidebar-border mx-2 w-auto\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-content\"\n      data-sidebar=\"content\"\n      className={cn(\n        \"flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group\"\n      data-sidebar=\"group\"\n      className={cn(\"relative flex w-full min-w-0 flex-col p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupLabel({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"div\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-label\"\n      data-sidebar=\"group-label\"\n      className={cn(\n        \"text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:h-4 [&>svg]:w-4 [&>svg]:shrink-0\",\n        \"group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupAction({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"button\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-action\"\n      data-sidebar=\"group-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground absolute top-3.5 right-3 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupContent({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group-content\"\n      data-sidebar=\"group-content\"\n      className={cn(\"w-full text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenu({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu\"\n      data-sidebar=\"menu\"\n      className={cn(\"flex w-full min-w-0 flex-col gap-1\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuItem({ className, ...props }: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-item\"\n      data-sidebar=\"menu-item\"\n      className={cn(\"group/menu-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nconst sidebarMenuButtonVariants = cva(\n  \"peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:w-8! group-data-[collapsible=icon]:h-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground\",\n        outline:\n          \"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]\",\n      },\n      size: {\n        default: \"h-8 text-sm\",\n        sm: \"h-7 text-xs\",\n        lg: \"h-12 text-sm group-data-[collapsible=icon]:p-0!\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nfunction SidebarMenuButton({\n  asChild = false,\n  isActive = false,\n  variant = \"default\",\n  size = \"default\",\n  tooltip,\n  className,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  isActive?: boolean\n  tooltip?: string | React.ComponentProps<typeof TooltipContent>\n} & VariantProps<typeof sidebarMenuButtonVariants>) {\n  const Comp = asChild ? Slot : \"button\"\n  const { isMobile, state } = useSidebar()\n\n  const button = (\n    <Comp\n      data-slot=\"sidebar-menu-button\"\n      data-sidebar=\"menu-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(sidebarMenuButtonVariants({ variant, size }), className)}\n      {...props}\n    />\n  )\n\n  if (!tooltip) {\n    return button\n  }\n\n  if (typeof tooltip === \"string\") {\n    tooltip = {\n      children: tooltip,\n    }\n  }\n\n  return (\n    <Tooltip>\n      <TooltipTrigger asChild>{button}</TooltipTrigger>\n      <TooltipContent\n        side=\"right\"\n        align=\"center\"\n        hidden={state !== \"collapsed\" || isMobile}\n        {...tooltip}\n      />\n    </Tooltip>\n  )\n}\n\nfunction SidebarMenuAction({\n  className,\n  asChild = false,\n  showOnHover = false,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  showOnHover?: boolean\n}) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-action\"\n      data-sidebar=\"menu-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer-hover/menu-button:text-sidebar-accent-foreground absolute top-1.5 right-1 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        showOnHover &&\n          \"peer-data-[active=true]/menu-button:text-sidebar-accent-foreground group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 md:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuBadge({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-menu-badge\"\n      data-sidebar=\"menu-badge\"\n      className={cn(\n        \"text-sidebar-foreground pointer-events-none absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums select-none\",\n        \"peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSkeleton({\n  className,\n  showIcon = false,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  showIcon?: boolean\n}) {\n  // Random width between 50 to 90%.\n  const width = React.useMemo(() => {\n    return `${Math.floor(Math.random() * 40) + 50}%`\n  }, [])\n\n  return (\n    <div\n      data-slot=\"sidebar-menu-skeleton\"\n      data-sidebar=\"menu-skeleton\"\n      className={cn(\"flex h-8 items-center gap-2 rounded-md px-2\", className)}\n      {...props}\n    >\n      {showIcon && (\n        <Skeleton\n          className=\"size-4 rounded-md\"\n          data-sidebar=\"menu-skeleton-icon\"\n        />\n      )}\n      <Skeleton\n        className=\"h-4 max-w-[var(--skeleton-width)] flex-1\"\n        data-sidebar=\"menu-skeleton-text\"\n        style={\n          {\n            \"--skeleton-width\": width,\n          } as React.CSSProperties\n        }\n      />\n    </div>\n  )\n}\n\nfunction SidebarMenuSub({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu-sub\"\n      data-sidebar=\"menu-sub\"\n      className={cn(\n        \"border-sidebar-border mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l px-2.5 py-0.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubItem({\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-sub-item\"\n      data-sidebar=\"menu-sub-item\"\n      className={cn(\"group/menu-sub-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubButton({\n  asChild = false,\n  size = \"md\",\n  isActive = false,\n  className,\n  ...props\n}: React.ComponentProps<\"a\"> & {\n  asChild?: boolean\n  size?: \"sm\" | \"md\"\n  isActive?: boolean\n}) {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-sub-button\"\n      data-sidebar=\"menu-sub-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&>svg]:text-sidebar-accent-foreground flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 outline outline-2 outline-transparent outline-offset-2 focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n        \"data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground\",\n        size === \"sm\" && \"text-xs\",\n        size === \"md\" && \"text-sm\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Sidebar,\n  SidebarContent,\n  SidebarFooter,\n  SidebarGroup,\n  SidebarGroupAction,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarInput,\n  SidebarInset,\n  SidebarMenu,\n  SidebarMenuAction,\n  SidebarMenuBadge,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSkeleton,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n  SidebarProvider,\n  SidebarRail,\n  SidebarSeparator,\n  SidebarTrigger,\n  useSidebar,\n}\n","size_bytes":21846},"client/src/components/ui/checkbox.tsx":{"content":"import * as React from \"react\"\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\nimport { Check } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\n      className\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn(\"flex items-center justify-center text-current\")}\n    >\n      <Check className=\"h-4 w-4\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n))\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\n\nexport { Checkbox }\n","size_bytes":1056},"client/src/App.tsx":{"content":"import { Switch, Route, useLocation } from \"wouter\";\nimport { useEffect } from \"react\";\nimport { QueryClientProvider } from \"@tanstack/react-query\";\nimport { queryClient } from \"./lib/queryClient\";\nimport { UserProvider } from \"./lib/user-provider\";\nimport { useUser } from \"./lib/use-user\";\nimport { Toaster } from \"@/components/ui/toaster\";\nimport { TooltipProvider } from \"@/components/ui/tooltip\";\nimport RoleSelector from \"@/pages/role-selector\";\nimport ClientHome from \"@/pages/client-home\";\nimport OrderForm from \"@/pages/order-form\";\nimport DriverRegister from \"@/pages/driver-register\";\nimport DriverDashboard from \"@/pages/driver-dashboard\";\nimport DriverProfile from \"@/pages/driver-profile\";\nimport AdminLogin from \"@/pages/admin-login\";\nimport AdminDashboard from \"@/pages/admin-dashboard\";\nimport ChatPage from \"@/pages/chat-page\";\nimport NotFound from \"@/pages/not-found\";\n\nfunction Router() {\n  return (\n    <Switch>\n      <Route path=\"/\" component={ClientHome} />\n      <Route path=\"/role-selector\" component={RoleSelector} />\n      <Route path=\"/client\" component={ClientHome} />\n      <Route path=\"/order/:type\" component={OrderForm} />\n      <Route path=\"/driver-register\" component={DriverRegister} />\n      <Route path=\"/driver\" component={DriverDashboard} />\n      <Route path=\"/driver/profile\" component={DriverProfile} />\n      <Route path=\"/admin-login\" component={AdminLogin} />\n      <Route path=\"/admin\" component={AdminDashboard} />\n      <Route path=\"/chat/:orderId\" component={ChatPage} />\n      <Route component={NotFound} />\n    </Switch>\n  );\n}\n\nfunction AppWrapper() {\n  const [location, setLocation] = useLocation();\n  const { role, isLoading } = useUser();\n\n  useEffect(() => {\n    if (!isLoading) {\n      // Redirect to appropriate dashboard based on role\n      if (role === \"admin\" && location !== \"/admin\") {\n        setLocation(\"/admin\");\n      } else if (role === \"driver\" && location !== \"/driver\") {\n        setLocation(\"/driver\");\n      } else if (role === \"client\" && (location === \"/\" || location === \"/role-selector\")) {\n        setLocation(\"/client\");\n      }\n    }\n  }, [role, isLoading, location, setLocation]);\n\n  // Show loading while determining user role\n  if (isLoading) {\n    return (\n      <div className=\"flex items-center justify-center h-screen\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-cyan-500 mx-auto mb-4\"></div>\n          <p className=\"text-secondary-foreground\">Завантаження...</p>\n        </div>\n      </div>\n    );\n  }\n\n  return <Router />;\n}\n\nexport default function App() {\n  return (\n    <QueryClientProvider client={queryClient}>\n      <UserProvider>\n        <TooltipProvider>\n          <Toaster />\n          <AppWrapper />\n        </TooltipProvider>\n      </UserProvider>\n    </QueryClientProvider>\n  );\n}\n","size_bytes":2871},"client/src/components/ui/toaster.tsx":{"content":"import { useToast } from \"@/hooks/use-toast\"\nimport {\n  Toast,\n  ToastClose,\n  ToastDescription,\n  ToastProvider,\n  ToastTitle,\n  ToastViewport,\n} from \"@/components/ui/toast\"\n\nexport function Toaster() {\n  const { toasts } = useToast()\n\n  return (\n    <ToastProvider>\n      {toasts.map(function ({ id, title, description, action, ...props }) {\n        return (\n          <Toast key={id} {...props}>\n            <div className=\"grid gap-1\">\n              {title && <ToastTitle>{title}</ToastTitle>}\n              {description && (\n                <ToastDescription>{description}</ToastDescription>\n              )}\n            </div>\n            {action}\n            <ToastClose />\n          </Toast>\n        )\n      })}\n      <ToastViewport />\n    </ToastProvider>\n  )\n}\n","size_bytes":772},"3123-main/tailwind.config.ts":{"content":"import type { Config } from \"tailwindcss\";\n\nexport default {\n  darkMode: [\"class\"],\n  content: [\"./client/index.html\", \"./client/src/**/*.{js,jsx,ts,tsx}\"],\n  theme: {\n    extend: {\n      borderRadius: {\n        lg: \".5625rem\", /* 9px */\n        md: \".375rem\", /* 6px */\n        sm: \".1875rem\", /* 3px */\n      },\n      colors: {\n        // Flat / base colors (regular buttons)\n        background: \"hsl(var(--background) / <alpha-value>)\",\n        foreground: \"hsl(var(--foreground) / <alpha-value>)\",\n        border: \"hsl(var(--border) / <alpha-value>)\",\n        input: \"hsl(var(--input) / <alpha-value>)\",\n        card: {\n          DEFAULT: \"hsl(var(--card) / <alpha-value>)\",\n          foreground: \"hsl(var(--card-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--card-border) / <alpha-value>)\",\n        },\n        popover: {\n          DEFAULT: \"hsl(var(--popover) / <alpha-value>)\",\n          foreground: \"hsl(var(--popover-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--popover-border) / <alpha-value>)\",\n        },\n        primary: {\n          DEFAULT: \"hsl(var(--primary) / <alpha-value>)\",\n          foreground: \"hsl(var(--primary-foreground) / <alpha-value>)\",\n          border: \"var(--primary-border)\",\n        },\n        secondary: {\n          DEFAULT: \"hsl(var(--secondary) / <alpha-value>)\",\n          foreground: \"hsl(var(--secondary-foreground) / <alpha-value>)\",\n          border: \"var(--secondary-border)\",\n        },\n        muted: {\n          DEFAULT: \"hsl(var(--muted) / <alpha-value>)\",\n          foreground: \"hsl(var(--muted-foreground) / <alpha-value>)\",\n          border: \"var(--muted-border)\",\n        },\n        accent: {\n          DEFAULT: \"hsl(var(--accent) / <alpha-value>)\",\n          foreground: \"hsl(var(--accent-foreground) / <alpha-value>)\",\n          border: \"var(--accent-border)\",\n        },\n        destructive: {\n          DEFAULT: \"hsl(var(--destructive) / <alpha-value>)\",\n          foreground: \"hsl(var(--destructive-foreground) / <alpha-value>)\",\n          border: \"var(--destructive-border)\",\n        },\n        ring: \"hsl(var(--ring) / <alpha-value>)\",\n        chart: {\n          \"1\": \"hsl(var(--chart-1) / <alpha-value>)\",\n          \"2\": \"hsl(var(--chart-2) / <alpha-value>)\",\n          \"3\": \"hsl(var(--chart-3) / <alpha-value>)\",\n          \"4\": \"hsl(var(--chart-4) / <alpha-value>)\",\n          \"5\": \"hsl(var(--chart-5) / <alpha-value>)\",\n        },\n        sidebar: {\n          ring: \"hsl(var(--sidebar-ring) / <alpha-value>)\",\n          DEFAULT: \"hsl(var(--sidebar) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--sidebar-border) / <alpha-value>)\",\n        },\n        \"sidebar-primary\": {\n          DEFAULT: \"hsl(var(--sidebar-primary) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-primary-foreground) / <alpha-value>)\",\n          border: \"var(--sidebar-primary-border)\",\n        },\n        \"sidebar-accent\": {\n          DEFAULT: \"hsl(var(--sidebar-accent) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-accent-foreground) / <alpha-value>)\",\n          border: \"var(--sidebar-accent-border)\"\n        },\n        status: {\n          online: \"rgb(34 197 94)\",\n          away: \"rgb(245 158 11)\",\n          busy: \"rgb(239 68 68)\",\n          offline: \"rgb(156 163 175)\",\n        },\n      },\n      fontFamily: {\n        sans: [\"var(--font-sans)\"],\n        serif: [\"var(--font-serif)\"],\n        mono: [\"var(--font-mono)\"],\n      },\n      keyframes: {\n        \"accordion-down\": {\n          from: { height: \"0\" },\n          to: { height: \"var(--radix-accordion-content-height)\" },\n        },\n        \"accordion-up\": {\n          from: { height: \"var(--radix-accordion-content-height)\" },\n          to: { height: \"0\" },\n        },\n      },\n      animation: {\n        \"accordion-down\": \"accordion-down 0.2s ease-out\",\n        \"accordion-up\": \"accordion-up 0.2s ease-out\",\n      },\n    },\n  },\n  plugins: [require(\"tailwindcss-animate\"), require(\"@tailwindcss/typography\")],\n} satisfies Config;\n","size_bytes":4050},"3123-main/client/src/lib/queryClient.ts":{"content":"import { QueryClient, QueryFunction } from \"@tanstack/react-query\";\n\nasync function throwIfResNotOk(res: Response) {\n  if (!res.ok) {\n    const text = (await res.text()) || res.statusText;\n    throw new Error(`${res.status}: ${text}`);\n  }\n}\n\nexport async function apiRequest(\n  method: string,\n  url: string,\n  data?: unknown | undefined,\n): Promise<Response> {\n  const res = await fetch(url, {\n    method,\n    headers: data ? { \"Content-Type\": \"application/json\" } : {},\n    body: data ? JSON.stringify(data) : undefined,\n    credentials: \"include\",\n  });\n\n  await throwIfResNotOk(res);\n  return res;\n}\n\ntype UnauthorizedBehavior = \"returnNull\" | \"throw\";\nexport const getQueryFn: <T>(options: {\n  on401: UnauthorizedBehavior;\n}) => QueryFunction<T> =\n  ({ on401: unauthorizedBehavior }) =>\n  async ({ queryKey }) => {\n    const res = await fetch(queryKey.join(\"/\") as string, {\n      credentials: \"include\",\n    });\n\n    if (unauthorizedBehavior === \"returnNull\" && res.status === 401) {\n      return null;\n    }\n\n    await throwIfResNotOk(res);\n    return await res.json();\n  };\n\nexport const queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      queryFn: getQueryFn({ on401: \"throw\" }),\n      refetchInterval: false,\n      refetchOnWindowFocus: false,\n      staleTime: Infinity,\n      retry: false,\n    },\n    mutations: {\n      retry: false,\n    },\n  },\n});\n","size_bytes":1383},"client/src/components/ui/progress.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ProgressPrimitive from \"@radix-ui/react-progress\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Progress = React.forwardRef<\n  React.ElementRef<typeof ProgressPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>\n>(({ className, value, ...props }, ref) => (\n  <ProgressPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative h-4 w-full overflow-hidden rounded-full bg-secondary\",\n      className\n    )}\n    {...props}\n  >\n    <ProgressPrimitive.Indicator\n      className=\"h-full w-full flex-1 bg-primary transition-all\"\n      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n    />\n  </ProgressPrimitive.Root>\n))\nProgress.displayName = ProgressPrimitive.Root.displayName\n\nexport { Progress }\n","size_bytes":791},"3123-main/vite.config.ts":{"content":"import { defineConfig } from \"vite\";\nimport react from \"@vitejs/plugin-react\";\nimport path from \"path\";\nimport runtimeErrorOverlay from \"@replit/vite-plugin-runtime-error-modal\";\n\nexport default defineConfig({\n  plugins: [\n    react(),\n    runtimeErrorOverlay(),\n    ...(process.env.NODE_ENV !== \"production\" &&\n    process.env.REPL_ID !== undefined\n      ? [\n          await import(\"@replit/vite-plugin-cartographer\").then((m) =>\n            m.cartographer(),\n          ),\n          await import(\"@replit/vite-plugin-dev-banner\").then((m) =>\n            m.devBanner(),\n          ),\n        ]\n      : []),\n  ],\n  resolve: {\n    alias: {\n      \"@\": path.resolve(import.meta.dirname, \"client\", \"src\"),\n      \"@shared\": path.resolve(import.meta.dirname, \"shared\"),\n      \"@assets\": path.resolve(import.meta.dirname, \"attached_assets\"),\n    },\n  },\n  root: path.resolve(import.meta.dirname, \"client\"),\n  build: {\n    outDir: path.resolve(import.meta.dirname, \"dist/public\"),\n    emptyOutDir: true,\n  },\n  server: {\n    fs: {\n      strict: true,\n      deny: [\"**/.*\"],\n    },\n  },\n});\n","size_bytes":1080},"client/src/components/ui/popover.tsx":{"content":"import * as React from \"react\"\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Popover = PopoverPrimitive.Root\n\nconst PopoverTrigger = PopoverPrimitive.Trigger\n\nconst PopoverContent = React.forwardRef<\n  React.ElementRef<typeof PopoverPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <PopoverPrimitive.Portal>\n    <PopoverPrimitive.Content\n      ref={ref}\n      align={align}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </PopoverPrimitive.Portal>\n))\nPopoverContent.displayName = PopoverPrimitive.Content.displayName\n\nexport { Popover, PopoverTrigger, PopoverContent }\n","size_bytes":1280},"server/index-prod.ts":{"content":"import fs from \"node:fs\";\nimport path from \"node:path\";\nimport { type Server } from \"node:http\";\n\nimport express, { type Express } from \"express\";\nimport runApp from \"./app\";\n\nexport async function serveStatic(app: Express, _server: Server) {\n  const distPath = path.resolve(import.meta.dirname, \"public\");\n\n  if (!fs.existsSync(distPath)) {\n    throw new Error(\n      `Could not find the build directory: ${distPath}, make sure to build the client first`,\n    );\n  }\n\n  app.use(express.static(distPath));\n\n  // fall through to index.html if the file doesn't exist\n  app.use(\"*\", (_req, res) => {\n    res.sendFile(path.resolve(distPath, \"index.html\"));\n  });\n}\n\n(async () => {\n  await runApp(serveStatic);\n})();\n","size_bytes":712},"client/src/components/ui/dropdown-menu.tsx":{"content":"import * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto\" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n      {...props}\n    />\n  )\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n}\n","size_bytes":7609},"3123-main/postcss.config.js":{"content":"export default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}\n","size_bytes":80},"client/src/components/ui/card.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"shadcn-card rounded-xl border bg-card border-card-border text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n));\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n));\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n));\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\nexport {\n  Card,\n  CardHeader,\n  CardFooter,\n  CardTitle,\n  CardDescription,\n  CardContent,\n}\n","size_bytes":1904},"client/src/components/ui/badge.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  // Whitespace-nowrap: Badges should never wrap.\n  \"whitespace-nowrap inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\" +\n  \" hover-elevate \" ,\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground shadow-xs\",\n        secondary: \"border-transparent bg-secondary text-secondary-foreground\",\n        destructive:\n          \"border-transparent bg-destructive text-destructive-foreground shadow-xs\",\n\n        outline: \" border [border-color:var(--badge-outline)] shadow-xs\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  },\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  );\n}\n\nexport { Badge, badgeVariants }\n","size_bytes":1202},"3123-main/server.js":{"content":"const express = require('express');\nconst TelegramBot = require('node-telegram-bot-api');\nconst cors = require('cors');\nconst fs = require('fs');\nconst path = require('path');\n\n// --- ⚙️ НАЛАШТУВАННЯ ---\nconst TOKEN = process.env.TELEGRAM_BOT_TOKEN; \nconst ADMIN_ID = process.env.ADMIN_ID || 7677921905;\nconst WEB_APP_URL = process.env.WEB_APP_URL || `http://localhost:${process.env.PORT || 5000}`;\nconst DB_PATH = './db.json';\nconst PORT = process.env.PORT || 5000;\n\n// ТАРИФИ ПО ТИПАМ\nconst TARIFFS = {\n    'Таксі 🚕': { basePrice: 50, perKm: 15, name: 'Таксі' },\n    'Вантажний 🚚': { basePrice: 100, perKm: 25, name: 'Вантаж' },\n    'Кур\\'єр 📦': { basePrice: 80, perKm: 20, name: 'Кур\\'єр' },\n    'Буксир 🪝': { basePrice: 200, perKm: 30, name: 'Буксир' }\n};\n\n// Rate limiting constants\nconst RATE_LIMIT_WINDOW = 60000; // 1 minute\nconst MAX_ORDERS_PER_MINUTE = 5;\n\n// ЗМІНА #4: КЕШИРУВАННЯ СТАТИСТИКИ (30 сек)\nlet statsCacheBefore = null;\nlet statsCacheTimestamp = null;\n\n// АДМІН ПАРОЛЬ (ВАЖЛИВО: встановити через env змінну в production!)\nconst ADMIN_PASSWORD = process.env.ADMIN_PASSWORD || 'admin_pass_2024';\nlet adminPasswordAttempts = {};\n\nlet bot = null;\nif (TOKEN) {\n    bot = new TelegramBot(TOKEN, { polling: true });\n    console.log('✅ Telegram bot initialized successfully');\n} else {\n    console.log('⚠️  TELEGRAM_BOT_TOKEN not set. Bot features disabled.');\n}\n\nconst app = express();\napp.use(cors());\napp.use(express.json());\n\n// Cache control\napp.use((req, res, next) => {\n    res.setHeader('Cache-Control', 'no-cache, no-store, must-revalidate');\n    res.setHeader('Pragma', 'no-cache');\n    res.setHeader('Expires', '0');\n    next();\n});\n\napp.use(express.static(path.join(__dirname, 'public')));\n\n// --- 💾 БАЗА ДАНИХ ---\nfunction initDB() {\n    if (!fs.existsSync(DB_PATH)) {\n        fs.writeFileSync(DB_PATH, JSON.stringify({ \n            users: {},\n            driverCodes: [],\n            orders: [],\n            ratings: [],\n            rateLimits: {},\n            messages: [],\n            notifications: []\n        }, null, 2));\n    } else {\n        const db = JSON.parse(fs.readFileSync(DB_PATH));\n        if (!db.orders) db.orders = [];\n        if (!db.ratings) db.ratings = [];\n        if (!db.rateLimits) db.rateLimits = {};\n        if (!db.messages) db.messages = [];\n        if (!db.notifications) db.notifications = [];\n        fs.writeFileSync(DB_PATH, JSON.stringify(db, null, 2));\n    }\n}\n\ninitDB();\n\nfunction getDB() {\n    return JSON.parse(fs.readFileSync(DB_PATH));\n}\n\nfunction saveDB(db) {\n    fs.writeFileSync(DB_PATH, JSON.stringify(db, null, 2));\n}\n\nfunction getUser(userId, username = '') {\n    const db = getDB();\n    if (!db.users[userId]) {\n        const role = (String(userId) === String(ADMIN_ID)) ? 'admin' : 'client';\n        db.users[userId] = { role, username, customName: null, phone: null, bio: null, photoUrl: null, isOnline: false, lastActive: new Date().toISOString() };\n        saveDB(db);\n    }\n    if (String(userId) === String(ADMIN_ID) && db.users[userId].role !== 'admin') {\n        db.users[userId].role = 'admin';\n        saveDB(db);\n    }\n    return db.users[userId];\n}\n\nfunction updateUserRole(userId, role) {\n    const db = getDB();\n    if (db.users[userId]) {\n        db.users[userId].role = role;\n        // ЗМІНА #7: ІСТОРІЯ АКТИВНОСТІ - відслідковувати онлайн/офлайн\n        db.users[userId].lastActive = new Date().toISOString();\n        if (!db.users[userId].activityLog) db.users[userId].activityLog = [];\n        db.users[userId].activityLog.push({\n            timestamp: new Date().toISOString(),\n            action: `role_changed_to_${role}`\n        });\n        saveDB(db);\n    }\n}\n\nfunction setDriverName(userId, newName) {\n    const db = getDB();\n    if (db.users[userId]) {\n        db.users[userId].customName = newName;\n        saveDB(db);\n        return true;\n    }\n    return false;\n}\n\nfunction getAllDrivers() {\n    const db = getDB();\n    let list = [];\n    for (let id in db.users) {\n        if (db.users[id].role === 'driver_approved' || db.users[id].role === 'admin') {\n            let name = db.users[id].customName || db.users[id].username || \"Без імені\";\n            let roleLabel = (db.users[id].role === 'admin') ? '👑' : '🚖';\n            list.push(`${roleLabel} 🆔 <code>${id}</code> — ${name}`);\n        }\n    }\n    return list.join('\\n');\n}\n\n// --- 🎫 КОДИ ВОДІЇВ ---\nfunction generateDriverCode() {\n    const chars = 'ABCDEFGHJKLMNPQRSTUVWXYZ23456789';\n    let code = '';\n    for (let i = 0; i < 8; i++) {\n        code += chars.charAt(Math.floor(Math.random() * chars.length));\n    }\n    return code;\n}\n\nfunction createDriverCode(adminId) {\n    const db = getDB();\n    if (!db.driverCodes) db.driverCodes = [];\n    \n    let code;\n    do {\n        code = generateDriverCode();\n    } while (db.driverCodes.some(c => c.code === code));\n    \n    const codeEntry = {\n        code,\n        createdAt: new Date().toISOString(),\n        createdBy: adminId,\n        used: false,\n        usedAt: null,\n        usedBy: null\n    };\n    \n    db.driverCodes.push(codeEntry);\n    saveDB(db);\n    return code;\n}\n\nfunction getUnusedCodes() {\n    const db = getDB();\n    if (!db.driverCodes) return [];\n    return db.driverCodes.filter(c => !c.used);\n}\n\nfunction validateAndUseCode(code, userId, username) {\n    const db = getDB();\n    if (!db.driverCodes) db.driverCodes = [];\n    \n    const codeEntry = db.driverCodes.find(c => c.code === code && !c.used);\n    \n    if (!codeEntry) {\n        return { valid: false, reason: 'invalid_or_used' };\n    }\n    \n    codeEntry.used = true;\n    codeEntry.usedAt = new Date().toISOString();\n    codeEntry.usedBy = userId;\n    \n    saveDB(db);\n    return { valid: true, code: codeEntry };\n}\n\n// --- ⏱️ RATE LIMITING ---\nfunction checkRateLimit(userId) {\n    const db = getDB();\n    const now = Date.now();\n    \n    if (!db.rateLimits[userId] || !Array.isArray(db.rateLimits[userId])) {\n        db.rateLimits[userId] = [];\n    }\n    \n    // Очищаємо старі записи\n    db.rateLimits[userId] = db.rateLimits[userId].filter(t => now - t < RATE_LIMIT_WINDOW);\n    \n    if (db.rateLimits[userId].length >= MAX_ORDERS_PER_MINUTE) {\n        return { allowed: false, message: '⏱️ Забагато замовлень! Спробуйте через хвилину.' };\n    }\n    \n    db.rateLimits[userId].push(now);\n    saveDB(db);\n    return { allowed: true };\n}\n\n// --- 🚖 ЗАМОВЛЕННЯ ---\nlet orderCounter = 1;\nlet orderMessages = {};\n\nfunction createOrder(userId, fromAddress, toAddress, serviceType, comment = '', fromLat = null, fromLng = null, price = 0) {\n    const db = getDB();\n    if (!db.orders) db.orders = [];\n    \n    const order = {\n        id: orderCounter++,\n        userId: String(userId),\n        fromAddress,\n        toAddress,\n        serviceType,\n        comment,\n        fromLat,\n        fromLng,\n        price: Math.ceil(price) || 0,\n        driverPrice: null,\n        status: 'pending',\n        statusHistory: [{ status: 'pending', timestamp: new Date().toISOString() }],\n        driverId: null,\n        createdAt: new Date().toISOString(),\n        acceptedAt: null,\n        completedAt: null,\n        rating: null,\n        eta: 8 // minutes\n    };\n    \n    db.orders.push(order);\n    saveDB(db);\n    return order;\n}\n\nfunction getPendingOrders() {\n    const db = getDB();\n    return db.orders ? db.orders.filter(o => o.status === 'pending') : [];\n}\n\nfunction getOrderById(orderId) {\n    const db = getDB();\n    return db.orders ? db.orders.find(o => o.id === parseInt(orderId)) : null;\n}\n\nfunction updateOrderStatus(orderId, newStatus) {\n    const db = getDB();\n    const order = db.orders.find(o => o.id === parseInt(orderId));\n    if (order) {\n        order.status = newStatus;\n        if (!order.statusHistory) order.statusHistory = [];\n        order.statusHistory.push({ status: newStatus, timestamp: new Date().toISOString() });\n        \n        if (newStatus === 'accepted') order.acceptedAt = new Date().toISOString();\n        if (newStatus === 'completed') order.completedAt = new Date().toISOString();\n        \n        saveDB(db);\n        return order;\n    }\n    return null;\n}\n\nfunction cancelOrder(orderId) {\n    const db = getDB();\n    const index = db.orders.findIndex(o => o.id === parseInt(orderId));\n    if (index !== -1) {\n        db.orders.splice(index, 1);\n        saveDB(db);\n        return true;\n    }\n    return false;\n}\n\nfunction rateOrder(orderId, rating, comment = '') {\n    const db = getDB();\n    const order = db.orders.find(o => o.id === parseInt(orderId));\n    if (order) {\n        order.rating = { stars: Math.min(5, Math.max(1, parseInt(rating))), comment, ratedAt: new Date().toISOString() };\n        db.ratings.push({ orderId, ...order.rating, driverId: order.driverId });\n        saveDB(db);\n        return true;\n    }\n    return false;\n}\n\nfunction getDriverStats(driverId) {\n    const db = getDB();\n    const completedOrders = db.orders ? db.orders.filter(o => o.driverId === String(driverId) && o.status === 'completed') : [];\n    const ratings = db.ratings ? db.ratings.filter(r => r.driverId === String(driverId)) : [];\n    \n    const avgRating = ratings.length > 0 ? (ratings.reduce((sum, r) => sum + r.stars, 0) / ratings.length).toFixed(1) : 0;\n    \n    return {\n        completedOrders: completedOrders.length,\n        totalRatings: ratings.length,\n        averageRating: avgRating\n    };\n}\n\nfunction getAdminStats() {\n    const db = getDB();\n    const allOrders = db.orders || [];\n    const completed = allOrders.filter(o => o.status === 'completed').length;\n    const drivers = Object.values(db.users).filter(u => u.role === 'driver_approved' || u.role === 'admin').length;\n    \n    return {\n        totalOrders: allOrders.length,\n        completedOrders: completed,\n        activeDrivers: drivers,\n        pendingOrders: getPendingOrders().length\n    };\n}\n\nfunction getDriverBadges(driverId) {\n    const stats = getDriverStats(driverId);\n    const badges = [];\n    \n    if (stats.averageRating >= 4.8) badges.push('⭐ Топ-водій');\n    if (stats.completedOrders >= 100) badges.push('🏆 Легенда');\n    if (stats.completedOrders >= 50) badges.push('🔥 Активний');\n    if (stats.completedOrders >= 20 && stats.averageRating >= 4.5) badges.push('💎 Премум');\n    if (stats.totalRatings >= 50 && stats.averageRating === '5.0') badges.push('⚡ Ідеальний');\n    \n    return badges.length > 0 ? badges.join(' ') : null;\n}\n\n// --- 🤖 TELEGRAM BOT ---\nif (bot) {\n    bot.onText(/\\/start/, (msg) => {\n        const userId = msg.from.id;\n        const user = getUser(userId, msg.from.first_name);\n        const firstName = user.customName || user.username || msg.from.first_name || 'друже';\n        \n        let text = '';\n        let keyboard = [];\n\n        if (user.role === 'admin') {\n            text = `Вітаю, ${firstName}! 👑\\n\\nВи Адміністратор і Водій.\\n\\n<b>Команди:</b>\\n/generate - Згенерувати коди\\n/codes - Невикористані коди\\n/drivers - Список водіїв\\n/stats - Статистика\\n/setname ID ІМ\\'Я - Змінити ім\\'я`;\n            keyboard = [\n                [{ text: '💼 Я водій', web_app: { url: WEB_APP_URL + '/driver.html' } }],\n                [{ text: '🙋‍♂️ Я клієнт', web_app: { url: WEB_APP_URL + '/client.html' } }],\n                [{ text: '📊 Панель адміна', web_app: { url: WEB_APP_URL + '/admin.html' } }]\n            ];\n        } else if (user.role === 'driver_approved') {\n            text = `Привіт, ${firstName}! 🚖\\n\\nВи водій. Приймайте замовлення та заробляйте!`;\n            keyboard = [\n                [{ text: '💼 Приймати замовлення', web_app: { url: WEB_APP_URL + '/driver.html' } }],\n                [{ text: '🙋‍♂️ Замовити для себе', web_app: { url: WEB_APP_URL + '/client.html' } }]\n            ];\n        } else if (user.role === 'driver_pending') {\n            text = `Привіт, ${firstName}!\\n\\n⏳ Ваша заявка на розгляді...`;\n            keyboard = [[{ text: '📱 Замовити послугу', web_app: { url: WEB_APP_URL + '/client.html' } }]];\n        } else {\n            text = `Вітаємо, ${firstName}! 🎉\\n\\n🚖 Швидко, зручно, надійно!`;\n            keyboard = [[{ text: '📱 Замовити послугу', web_app: { url: WEB_APP_URL + '/client.html' } }]];\n        }\n        \n        bot.sendMessage(userId, text, { \n            parse_mode: 'HTML',\n            reply_markup: { keyboard, resize_keyboard: true }\n        });\n    });\n\n    bot.onText(/\\/stats/, (msg) => {\n        if (String(msg.from.id) !== String(ADMIN_ID)) return;\n        const stats = getAdminStats();\n        const text = `📊 <b>Статистика:</b>\\n\\nВсього замовлень: ${stats.totalOrders}\\nЗавершено: ${stats.completedOrders}\\nОчікують: ${stats.pendingOrders}\\nАктивних водіїв: ${stats.activeDrivers}`;\n        bot.sendMessage(msg.chat.id, text, { parse_mode: 'HTML' });\n    });\n\n    bot.onText(/\\/drivers/, (msg) => {\n        if (String(msg.from.id) !== String(ADMIN_ID)) return;\n        const list = getAllDrivers();\n        bot.sendMessage(msg.chat.id, list ? `📋 <b>Водії:</b>\\n\\n${list}` : \"Водіїв немає\", { parse_mode: 'HTML' });\n    });\n\n    bot.onText(/\\/setname (\\d+) (.+)/, (msg, match) => {\n        if (String(msg.from.id) !== String(ADMIN_ID)) return;\n        if (setDriverName(match[1], match[2])) {\n            bot.sendMessage(msg.chat.id, `✅ Ім'я змінено на: <b>${match[2]}</b>`, { parse_mode: 'HTML' });\n        }\n    });\n\n    bot.onText(/\\/generate(?:\\s+(\\d+))?/, (msg, match) => {\n        if (String(msg.from.id) !== String(ADMIN_ID)) return;\n        const count = Math.min(10, Math.max(1, parseInt(match[1]) || 1));\n        const codes = Array.from({length: count}, () => createDriverCode(msg.from.id));\n        const codesList = codes.map(c => `<code>${c}</code>`).join('\\n');\n        bot.sendMessage(msg.chat.id, `✅ <b>Коди (${count}):</b>\\n\\n${codesList}`, { parse_mode: 'HTML' });\n    });\n\n    bot.onText(/\\/codes/, (msg) => {\n        if (String(msg.from.id) !== String(ADMIN_ID)) return;\n        const unused = getUnusedCodes();\n        if (unused.length === 0) {\n            return bot.sendMessage(msg.chat.id, '📋 Немає доступних кодів', { parse_mode: 'HTML' });\n        }\n        const list = unused.map(c => `🎫 <code>${c.code}</code>`).join('\\n');\n        bot.sendMessage(msg.chat.id, `📋 <b>Коди (${unused.length}):</b>\\n\\n${list}`, { parse_mode: 'HTML' });\n    });\n\n    bot.on('callback_query', (q) => {\n        if (String(q.from.id) !== String(ADMIN_ID)) return;\n        const [action, targetId] = q.data.split('_');\n        if (action === 'approve') {\n            updateUserRole(targetId, 'driver_approved');\n            bot.sendMessage(targetId, '✅ Схвалено! Тисніть /app');\n        } else if (action === 'reject') {\n            updateUserRole(targetId, 'client');\n            bot.sendMessage(targetId, '❌ Відхилено');\n        }\n        bot.answerCallbackQuery(q.id);\n    });\n\n    bot.on('message', (msg) => {\n        if (msg.text && msg.text.startsWith('/')) return;\n        const senderId = msg.from.id;\n        const messageText = msg.text;\n        \n        if (messageText && messageText.length === 8 && /^[A-Z0-9]+$/.test(messageText)) {\n            const user = getUser(senderId, msg.from.first_name);\n            if (user.role !== 'client') return;\n            \n            const validation = validateAndUseCode(messageText, senderId, msg.from.first_name);\n            if (!validation.valid) {\n                return bot.sendMessage(senderId, '❌ Невірний або вже використаний код!', { parse_mode: 'HTML' });\n            }\n            \n            updateUserRole(senderId, 'driver_pending');\n            bot.sendMessage(senderId, '✅ Код підтверджено! Очікуйте підтвердження адміна.', { parse_mode: 'HTML' });\n            bot.sendMessage(ADMIN_ID, `🔔 <b>Нова заявка:</b> ${msg.from.first_name} (${senderId})`, {\n                parse_mode: 'HTML',\n                reply_markup: { inline_keyboard: [[\n                    { text: '✅ Схвалити', callback_data: `approve_${senderId}` },\n                    { text: '❌ Відхилити', callback_data: `reject_${senderId}` }\n                ]] }\n            });\n        }\n    });\n}\n\n// --- 🌐 API СЕРВЕРА ---\n\n// Замовлення\napp.post('/order', (req, res) => {\n    const { userId, fromAddress, toAddress, serviceType, comment, fromLat, fromLng, price } = req.body;\n    \n    const rateCheck = checkRateLimit(userId);\n    if (!rateCheck.allowed) {\n        return res.status(429).json({ error: rateCheck.message });\n    }\n    \n    const order = createOrder(userId, fromAddress, toAddress, serviceType || 'Таксі 🚕', comment, fromLat, fromLng, price);\n    res.status(201).json({ orderId: order.id });\n});\n\napp.get('/get-orders', (req, res) => {\n    res.json(getPendingOrders());\n});\n\napp.get('/check-order/:id', (req, res) => {\n    const order = getOrderById(req.params.id);\n    res.json(order ? { status: order.status, order } : { status: 'not_found' });\n});\n\napp.get('/get-order/:orderId', (req, res) => {\n    const order = getOrderById(req.params.orderId);\n    if (!order) return res.status(404).json({ message: 'Not found' });\n    const driver = order.driverId ? getUser(order.driverId) : null;\n    res.json({\n        ...order,\n        driverName: driver?.customName || driver?.username || 'Водій',\n        driverRating: driver ? getDriverStats(driver.id).averageRating : 0\n    });\n});\n\napp.get('/user-orders/:userId', (req, res) => {\n    const db = getDB();\n    const userId = String(req.params.userId);\n    const orders = (db.orders || []).filter(o => String(o.userId) === userId).reverse();\n    res.json(orders);\n});\n\n// СПИСОК ЗАМОВЛЕНЬ ДЛЯ ВОДІЯ\napp.get('/available-orders/:driverId', (req, res) => {\n    const db = getDB();\n    const driverId = String(req.params.driverId);\n    \n    // Отримуємо:\n    // 1. ДОСТУПНІ - pending замовлення (без водія)\n    // 2. МОЇ АКТИВНІ - замовлення які цей водій прийняв (не завершені)\n    const availableOrders = (db.orders || [])\n        .filter(o => o.status === 'pending')\n        .map(o => {\n            const client = getUser(o.userId);\n            return {\n                ...o,\n                clientName: client?.customName || client?.username || 'Клієнт',\n                clientRating: client ? getDriverStats(client.id).averageRating : 0\n            };\n        });\n    \n    const myActiveOrders = (db.orders || [])\n        .filter(o => String(o.driverId) === driverId && o.status !== 'completed')\n        .map(o => {\n            const client = getUser(o.userId);\n            return {\n                ...o,\n                clientName: client?.customName || client?.username || 'Клієнт',\n                clientRating: client ? getDriverStats(client.id).averageRating : 0\n            };\n        });\n    \n    res.json({\n        available: availableOrders,\n        active: myActiveOrders\n    });\n});\n\napp.get('/driver-stats/:driverId', (req, res) => {\n    const db = getDB();\n    const driverId = String(req.params.driverId);\n    const completedOrders = (db.orders || []).filter(o => String(o.driverId) === driverId && o.status === 'completed');\n    const ratings = (db.ratings || []).filter(r => String(r.driverId) === driverId);\n    const todayOrders = completedOrders.filter(o => new Date(o.completedAt).toDateString() === new Date().toDateString());\n    const earnings = completedOrders.reduce((sum, o) => sum + (o.price || 0), 0);\n    const avgRating = ratings.length > 0 ? (ratings.reduce((sum, r) => sum + r.stars, 0) / ratings.length) : 0;\n    res.json({\n        earnings,\n        completedOrders: completedOrders.length,\n        averageRating: avgRating,\n        ridestoday: todayOrders.length\n    });\n});\n\n// ГРАФІК ЗАРОБІТКІВ (ЛОС 7 ДНІВ)\napp.get('/earnings-chart', (req, res) => {\n    const db = getDB();\n    const days = [];\n    const earnings = [];\n    for (let i = 6; i >= 0; i--) {\n        const date = new Date();\n        date.setDate(date.getDate() - i);\n        const dateStr = date.toLocaleDateString('uk-UA');\n        const dayOrders = (db.orders || []).filter(o => new Date(o.completedAt || o.createdAt).toLocaleDateString('uk-UA') === dateStr && o.status === 'completed');\n        const dayEarnings = dayOrders.reduce((sum, o) => sum + (o.price || 0), 0);\n        days.push(dateStr);\n        earnings.push(dayEarnings);\n    }\n    res.json({ days, earnings });\n});\n\n// ТОП-10 ВОДІЇВ (ВИПРАВЛЕНО: db.users це OBJECT, не ARRAY)\napp.get('/top-drivers', (req, res) => {\n    const db = getDB();\n    const drivers = Object.entries(db.users || {})\n        .filter(([id, u]) => u.role === 'driver_approved' || u.role === 'admin')\n        .map(([id, d]) => ({\n            ...d,\n            id: id,\n            completedOrders: (db.orders || []).filter(o => String(o.driverId) === String(id) && o.status === 'completed').length,\n            earnings: (db.orders || []).filter(o => String(o.driverId) === String(id) && o.status === 'completed').reduce((sum, o) => sum + (o.driverPrice || o.price || 0), 0),\n            ratings: (db.ratings || []).filter(r => String(r.driverId) === String(id)),\n        }))\n        .map(d => ({\n            ...d,\n            averageRating: d.ratings.length > 0 ? (d.ratings.reduce((sum, r) => sum + r.stars, 0) / d.ratings.length).toFixed(2) : 0\n        }))\n        .sort((a, b) => b.earnings - a.earnings)\n        .slice(0, 10);\n    res.json(drivers);\n});\n\n// ЗАМОВЛЕННЯ ПО ДАТАМ\napp.get('/orders-by-date', (req, res) => {\n    const db = getDB();\n    const from = new Date(req.query.from).toLocaleDateString('uk-UA');\n    const to = new Date(req.query.to).toLocaleDateString('uk-UA');\n    const orders = (db.orders || []).filter(o => {\n        const orderDate = new Date(o.createdAt).toLocaleDateString('uk-UA');\n        return orderDate >= from && orderDate <= to;\n    });\n    res.json(orders);\n});\n\n// ВСІХ КОРИСТУВАЧІВ\napp.get('/all-users', (req, res) => {\n    const db = getDB();\n    const users = Object.entries(db.users || {}).map(([id, u]) => ({\n        id: id,\n        username: u.username,\n        customName: u.customName,\n        role: u.role,\n        isBlocked: u.isBlocked || false,\n        isOnline: u.isOnline,\n        phone: u.phone || '',\n        bio: u.bio || ''\n    }));\n    res.json(users);\n});\n\n// БЛОКУВАННЯ КОРИСТУВАЧА\napp.post('/toggle-user-block', (req, res) => {\n    const db = getDB();\n    const userId = String(req.body.userId);\n    const user = db.users[userId];\n    if (user) {\n        user.isBlocked = !user.isBlocked;\n        saveDB(db);\n        res.json({ blocked: user.isBlocked });\n    } else {\n        res.status(404).json({ error: 'User not found' });\n    }\n});\n\n// ДОДАТИ БОНУС/ШТРАФ\napp.post('/add-balance', (req, res) => {\n    const db = getDB();\n    const driverId = String(req.body.driverId);\n    const amount = parseInt(req.body.amount);\n    \n    console.log(`💰 /add-balance - ID: ${driverId}, Amount: ${amount}`);\n    \n    const user = db.users[driverId];\n    if (!user) {\n        console.log(`❌ Користувач ${driverId} не знайдений`);\n        console.log(`📝 Доступні ID:`, Object.keys(db.users));\n        return res.status(404).json({ error: 'Водій не знайдений' });\n    }\n    \n    user.balance = (user.balance || 0) + amount;\n    saveDB(db);\n    \n    console.log(`✅ Баланс оновлено для ${driverId}: ${user.balance} грн`);\n    res.json({ success: true, balance: user.balance });\n});\n\n// РЕЗЕРВНА КОПІЯ БД\napp.get('/backup-db', (req, res) => {\n    const db = getDB();\n    res.json(db);\n});\n\n// ПРОФІЛЬ ВОДІЯ\napp.get('/driver-profile/:driverId', (req, res) => {\n    const db = getDB();\n    const driverId = String(req.params.driverId);\n    const driver = db.users[driverId];\n    if (!driver) return res.status(404).json({ message: 'Not found' });\n    res.json({\n        id: driverId,\n        username: driver.username,\n        customName: driver.customName,\n        phone: driver.phone || '',\n        bio: driver.bio || '',\n        role: driver.role\n    });\n});\n\n// ОНОВЛЕННЯ ПРОФІЛЮ ВОДІЯ\napp.post('/update-driver-profile', (req, res) => {\n    const db = getDB();\n    const { driverId, name, phone, bio } = req.body;\n    const driver = db.users[String(driverId)];\n    \n    if (driver) {\n        driver.customName = name;\n        driver.phone = phone;\n        driver.bio = bio;\n        saveDB(db);\n        res.json({ success: true });\n    } else {\n        res.status(404).json({ error: 'User not found' });\n    }\n});\n\n// ОГОЛОШЕННЯ ДЛЯ ВОДІЇВ\napp.get('/announcements', (req, res) => {\n    const db = getDB();\n    const announcements = (db.announcements || []).sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));\n    res.json(announcements);\n});\n\napp.post('/publish-announcement', (req, res) => {\n    const db = getDB();\n    const { title, text, type } = req.body;\n    \n    const announcement = {\n        id: Date.now(),\n        title,\n        text,\n        type: type || 'info',\n        createdAt: new Date().toISOString()\n    };\n    \n    if (!db.announcements) db.announcements = [];\n    db.announcements.push(announcement);\n    saveDB(db);\n    \n    // Telegram нотифікація всім водіям\n    if (bot) {\n        const users = Object.entries(db.users || {});\n        const drivers = users.filter(([id, u]) => u.role === 'driver_approved' && !u.isBlocked);\n        drivers.forEach(([id, driver]) => {\n            const emoji = type === 'important' ? '⚠️' : type === 'success' ? '✅' : '📌';\n            bot.sendMessage(id, `${emoji} <b>${title}</b>\\n\\n${text}`, { parse_mode: 'HTML' }).catch(()=>{});\n        });\n    }\n    \n    res.json({ success: true, announcement });\n});\n\napp.get('/current-order/:userId', (req, res) => {\n    const db = getDB();\n    const userId = String(req.params.userId);\n    \n    const driverOrder = db.orders?.find(o => String(o.driverId) === userId && o.status !== 'completed');\n    if (driverOrder) {\n        return res.json({ found: true, role: 'driver', order: driverOrder });\n    }\n    \n    const clientOrder = db.orders?.find(o => String(o.userId) === userId && o.status !== 'completed');\n    if (clientOrder) {\n        return res.json({ found: true, role: clientOrder.status === 'pending' ? 'pending_client' : 'client', order: clientOrder });\n    }\n    \n    res.json({ found: false });\n});\n\napp.post('/accept-order', (req, res) => {\n    const { orderId, driverId } = req.body;\n    const order = updateOrderStatus(orderId, 'accepted');\n    if (!order || order.status !== 'accepted') {\n        return res.status(400).json({ message: 'Зайнято' });\n    }\n    \n    order.driverId = driverId;\n    const db = getDB();\n    db.orders[db.orders.findIndex(o => o.id === parseInt(orderId))] = order;\n    saveDB(db);\n    \n    const driver = getUser(driverId);\n    const driverName = driver.customName || driver.username || 'Водій';\n    \n    addNotification(order.userId, `✅ Водій ${driverName} прийняв ваше замовлення!`, 'accepted');\n    \n    if (bot) {\n        // Telegram notification до КЛІЄНТА\n        bot.sendMessage(order.userId, `✅ <b>Виконавця знайдено!</b>\\n\\n🚖 ${driverName}\\nМаршрут: ${order.fromAddress} → ${order.toAddress}\\n💵 Вартість: ${order.price} грн`, { parse_mode: 'HTML' }).catch(()=>{});\n        // Telegram notification до ВОДІЯ\n        bot.sendMessage(driverId, `📱 <b>Нове замовлення!</b>\\n\\n📍 ${order.fromAddress}\\n🏁 ${order.toAddress}\\n💰 ${order.price} грн\\n⏱️ ETA: ${order.eta} хв`, { parse_mode: 'HTML' }).catch(()=>{});\n    }\n    res.json({ message: 'Success', order });\n});\n\napp.post('/update-order-status', (req, res) => {\n    const { orderId, status } = req.body;\n    const order = updateOrderStatus(orderId, status);\n    res.json(order ? { message: 'Success', order } : { message: 'Not found' });\n});\n\napp.post('/cancel-order', (req, res) => {\n    const { orderId } = req.body;\n    if (cancelOrder(orderId)) {\n        res.json({ message: 'Success' });\n    } else {\n        res.status(404).json({ message: 'Not found' });\n    }\n});\n\napp.post('/rate-order', (req, res) => {\n    const { orderId, stars, comment } = req.body;\n    if (rateOrder(orderId, stars, comment)) {\n        res.json({ message: 'Success' });\n    } else {\n        res.status(404).json({ message: 'Not found' });\n    }\n});\n\n// ВОДІЙ ПРИБУВ НА МІСЦЕ - ЗАПУСКАЄ ТАЙМЕР ДЛЯ КЛІЄНТА\napp.post('/driver-arrived', (req, res) => {\n    const { orderId } = req.body;\n    const db = getDB();\n    const order = db.orders.find(o => o.id === parseInt(orderId));\n    \n    if (!order) {\n        return res.status(404).json({ success: false, message: 'Замовлення не знайдено' });\n    }\n    \n    order.status = 'driver_arrived';\n    order.arrivedAt = new Date().toISOString();\n    if (!order.statusHistory) order.statusHistory = [];\n    order.statusHistory.push({ status: 'driver_arrived', timestamp: new Date().toISOString() });\n    saveDB(db);\n    \n    console.log(`✅ Водій ${order.driverId} прибув до замовлення ${orderId}`);\n    addNotification(order.userId, `✅ Водій прибув на місце! Таймер запущено.`, 'driver_arrived');\n    \n    res.json({ success: true, order });\n});\n\napp.post('/finish-order', (req, res) => {\n    const { orderId } = req.body;\n    const order = updateOrderStatus(orderId, 'completed');\n    if (order && order.status === 'completed') {\n        // ЗМІНА #2: ЧИСТ ЧАТУ - видалити всі повідомлення для цього замовлення\n        const db = getDB();\n        db.messages = (db.messages || []).filter(m => m.orderId !== parseInt(orderId));\n        saveDB(db);\n        \n        addNotification(order.userId, `✅ Замовлення ${orderId} завершено!`, 'completed', 'high');\n        res.json({ message: 'Success', order });\n    } else {\n        res.status(404).json({ message: 'Not found' });\n    }\n});\n\napp.post('/set-driver-price', (req, res) => {\n    const { orderId, driverPrice } = req.body;\n    const db = getDB();\n    const order = db.orders.find(o => o.id === parseInt(orderId));\n    \n    // ЗМІНА #5: ВАЛІДАЦІЯ ЦІНИ - мін 50, макс 500 грн\n    const MIN_PRICE = 50;\n    const MAX_PRICE = 500;\n    const normalizedPrice = Math.ceil(driverPrice);\n    \n    if (normalizedPrice < MIN_PRICE || normalizedPrice > MAX_PRICE) {\n        return res.status(400).json({ \n            success: false, \n            message: `Ціна має бути від ${MIN_PRICE} до ${MAX_PRICE} грн` \n        });\n    }\n    \n    if (order) {\n        order.driverPrice = normalizedPrice;\n        order.status = 'price_offered';\n        order.statusHistory.push({ status: 'price_offered', timestamp: new Date().toISOString() });\n        saveDB(db);\n        addNotification(order.userId, `💰 Водій запропонував ціну: ${order.driverPrice} грн`, 'price_offer', 'high');\n        res.json({ success: true, order });\n    } else {\n        res.status(404).json({ success: false });\n    }\n});\n\napp.post('/accept-driver-price', (req, res) => {\n    const { orderId } = req.body;\n    const db = getDB();\n    const order = db.orders.find(o => o.id === parseInt(orderId));\n    if (order && order.status === 'price_offered') {\n        order.status = 'accepted';\n        order.acceptedAt = new Date().toISOString();\n        order.statusHistory.push({ status: 'accepted', timestamp: new Date().toISOString() });\n        saveDB(db);\n        res.json({ success: true });\n    } else {\n        res.status(400).json({ success: false });\n    }\n});\n\napp.post('/reject-driver-price', (req, res) => {\n    const { orderId } = req.body;\n    const db = getDB();\n    const order = db.orders.find(o => o.id === parseInt(orderId));\n    if (order && order.status === 'price_offered') {\n        order.status = 'pending';\n        order.driverId = null;\n        order.driverPrice = null;\n        order.statusHistory.push({ status: 'pending', timestamp: new Date().toISOString() });\n        saveDB(db);\n        res.json({ success: true });\n    } else {\n        res.status(400).json({ success: false });\n    }\n});\n\napp.post('/get-driver-photo/:driverId', async (req, res) => {\n    try {\n        const driverId = req.params.driverId;\n        if (!bot) return res.json({ photoUrl: null });\n        \n        const photos = await bot.getUserProfilePhotos(driverId, { limit: 1 });\n        if (photos.total_count > 0) {\n            const file = await bot.getFile(photos.photos[0][0].file_id);\n            const photoUrl = `https://api.telegram.org/file/bot${process.env.TELEGRAM_BOT_TOKEN}/${file.file_path}`;\n            const db = getDB();\n            if (db.users[driverId]) {\n                db.users[driverId].photoUrl = photoUrl;\n                saveDB(db);\n            }\n            res.json({ photoUrl });\n        } else {\n            res.json({ photoUrl: null });\n        }\n    } catch (e) {\n        console.log('Помилка отримання фото:', e.message);\n        res.json({ photoUrl: null });\n    }\n});\n\napp.post('/update-driver-profile', (req, res) => {\n    const { driverId, name, phone, bio } = req.body;\n    const db = getDB();\n    if (db.users[driverId]) {\n        if (name) db.users[driverId].customName = name;\n        if (phone !== undefined) db.users[driverId].phone = phone;\n        if (bio !== undefined) db.users[driverId].bio = bio;\n        saveDB(db);\n        res.json({ success: true });\n    } else {\n        res.status(404).json({ success: false });\n    }\n});\n\napp.post('/toggle-driver-status', (req, res) => {\n    const { driverId } = req.body;\n    const db = getDB();\n    if (db.users[driverId]) {\n        db.users[driverId].isOnline = !db.users[driverId].isOnline;\n        db.users[driverId].lastActive = new Date().toISOString();\n        saveDB(db);\n        res.json({ message: 'Success', isOnline: db.users[driverId].isOnline });\n    } else {\n        res.status(404).json({ message: 'Not found' });\n    }\n});\n\napp.post('/send-message', (req, res) => {\n    const { orderId, senderId, message } = req.body;\n    const db = getDB();\n    if (!db.messages) db.messages = [];\n    \n    const msg = {\n        orderId,\n        senderId,\n        message,\n        timestamp: new Date().toISOString()\n    };\n    \n    db.messages.push(msg);\n    saveDB(db);\n    res.json({ message: 'Success', msg });\n});\n\napp.get('/messages/:orderId', (req, res) => {\n    const db = getDB();\n    const messages = (db.messages || []).filter(m => m.orderId === parseInt(req.params.orderId));\n    res.json(messages);\n});\n\napp.get('/notifications/:userId', (req, res) => {\n    const db = getDB();\n    const notifs = (db.notifications || []).filter(n => n.userId === parseInt(req.params.userId));\n    res.json(notifs);\n});\n\napp.post('/clear-notifications/:userId', (req, res) => {\n    const db = getDB();\n    db.notifications = (db.notifications || []).filter(n => n.userId !== parseInt(req.params.userId));\n    saveDB(db);\n    res.json({ message: 'Success' });\n});\n\n// ЗМІНА #6: SMART NOTIFICATIONS - розділити на рівні пріоритету\nfunction addNotification(userId, text, type, priority = 'normal') {\n    const db = getDB();\n    if (!db.notifications) db.notifications = [];\n    \n    // high = чат, водій прибув, замовлення готово\n    // normal = ціна, прийнято, в дорозі\n    // low = статус-оновлення\n    const priorityMap = { high: 3, normal: 2, low: 1 };\n    \n    db.notifications.push({\n        userId: parseInt(userId),\n        text,\n        type,\n        priority: priorityMap[priority] || 2,\n        timestamp: new Date().toISOString(),\n        read: false\n    });\n    saveDB(db);\n}\n\napp.get('/driver-stats/:driverId', (req, res) => {\n    const stats = getDriverStats(req.params.driverId);\n    res.json(stats);\n});\n\n// ЗМІНА #4: КЕШОВАНА СТАТИСТИКА (30 сек)\napp.get('/admin-stats', (req, res) => {\n    const now = Date.now();\n    \n    // Якщо кеш свіжий (менше 30 сек), повертаємо закешовані дані\n    if (statsCacheBefore && statsCacheTimestamp && (now - statsCacheTimestamp) < 30000) {\n        return res.json(statsCacheBefore);\n    }\n    \n    // Інакше розраховуємо заново й кешуємо\n    const stats = getAdminStats();\n    statsCacheBefore = stats;\n    statsCacheTimestamp = now;\n    res.json(stats);\n});\n\napp.get('/all-drivers-stats', (req, res) => {\n    const db = getDB();\n    const drivers = Object.entries(db.users)\n        .filter(([id, user]) => user.role === 'driver_approved' || user.role === 'admin')\n        .map(([id, user]) => ({\n            id,\n            ...user,\n            stats: getDriverStats(id)\n        }));\n    res.json(drivers);\n});\n\napp.get('/api/check-pending-rating/:userId', (req, res) => {\n    const db = getDB();\n    const userId = String(req.params.userId);\n    const completedNoRating = db.orders?.find(o => String(o.userId) === userId && o.status === 'completed' && !o.rating);\n    res.json({ needsRating: !!completedNoRating });\n});\n\n// Завантажуємо замовлення при старті\nfunction loadOrders() {\n    const db = getDB();\n    if (db.orders && db.orders.length > 0) {\n        orderCounter = Math.max(...db.orders.map(o => o.id)) + 1;\n        console.log(`📦 Завантажено ${db.orders.length} замовлень`);\n        console.log(`🔢 Наступний ID замовлення: ${orderCounter}`);\n    }\n}\n\nloadOrders();\n\n// ЗМІНА #8: АВТОМАТИЧНИЙ БЕКАП БД (кожну годину)\nfunction autoBackup() {\n    const db = getDB();\n    const timestamp = new Date().toISOString().replace(/[:.]/g, '-');\n    const backupDir = './backups';\n    \n    if (!fs.existsSync(backupDir)) {\n        fs.mkdirSync(backupDir);\n    }\n    \n    const backupPath = path.join(backupDir, `db_backup_${timestamp}.json`);\n    fs.writeFileSync(backupPath, JSON.stringify(db, null, 2));\n    console.log(`💾 Бекап БД створено: ${backupPath}`);\n}\n\n// Бекап кожну годину\nsetInterval(autoBackup, 60 * 60 * 1000);\n// Також зробити перший бекап при запуску\nautoBackup();\n\n// ЗМІНА #9: ЕНДПОІНТ ЛОГІНУ АДМІНА\napp.post('/admin-login', (req, res) => {\n    const { password } = req.body;\n    const ip = req.ip || req.connection.remoteAddress;\n    \n    if (!adminPasswordAttempts[ip]) {\n        adminPasswordAttempts[ip] = 0;\n    }\n    \n    // Захист від brute-force (максимум 5 спроб на 5 хвилин)\n    if (adminPasswordAttempts[ip] >= 5) {\n        return res.status(429).json({ success: false, message: 'Забагато спроб. Спробуйте через 5 хвилин' });\n    }\n    \n    if (password === ADMIN_PASSWORD) {\n        adminPasswordAttempts[ip] = 0;\n        // Встановити cookie/session з токеном\n        res.json({ success: true, token: Buffer.from(password).toString('base64') });\n    } else {\n        adminPasswordAttempts[ip]++;\n        res.status(401).json({ success: false, message: 'Неправильний пароль' });\n    }\n});\n\n// ЗМІНА #10: ДЕТАЛЬНА АНАЛІТИКА\napp.get('/detailed-analytics', (req, res) => {\n    const db = getDB();\n    const completedOrders = (db.orders || []).filter(o => o.status === 'completed');\n    const drivers = Object.entries(db.users).filter(([id, u]) => u.role === 'driver_approved');\n    \n    if (completedOrders.length === 0) {\n        return res.json({\n            totalOrders: 0,\n            avgDeliveryTime: 0,\n            avgPrice: 0,\n            avgRating: 0,\n            popularRoutes: [],\n            avgWaitTime: 0\n        });\n    }\n    \n    // Середній час доставки\n    const deliveryTimes = completedOrders.map(o => {\n        if (o.acceptedAt && o.completedAt) {\n            return (new Date(o.completedAt) - new Date(o.acceptedAt)) / 60000; // в хвилинах\n        }\n        return 0;\n    }).filter(t => t > 0);\n    const avgDeliveryTime = deliveryTimes.length > 0 ? (deliveryTimes.reduce((a, b) => a + b, 0) / deliveryTimes.length).toFixed(2) : 0;\n    \n    // Середня ціна\n    const avgPrice = (completedOrders.reduce((sum, o) => sum + (o.driverPrice || 0), 0) / completedOrders.length).toFixed(2);\n    \n    // Середній рейтинг\n    const ratings = (db.ratings || []).map(r => r.stars);\n    const avgRating = ratings.length > 0 ? (ratings.reduce((a, b) => a + b, 0) / ratings.length).toFixed(2) : 0;\n    \n    // Популярні маршрути\n    const routes = {};\n    completedOrders.forEach(o => {\n        const route = `${o.fromAddress} → ${o.toAddress}`;\n        routes[route] = (routes[route] || 0) + 1;\n    });\n    const popularRoutes = Object.entries(routes)\n        .sort((a, b) => b[1] - a[1])\n        .slice(0, 5)\n        .map(([route, count]) => ({ route, count }));\n    \n    // Час очікування (від створення до прийняття)\n    const waitTimes = completedOrders.map(o => {\n        if (o.createdAt && o.acceptedAt) {\n            return (new Date(o.acceptedAt) - new Date(o.createdAt)) / 60000; // в хвилинах\n        }\n        return 0;\n    }).filter(t => t > 0);\n    const avgWaitTime = waitTimes.length > 0 ? (waitTimes.reduce((a, b) => a + b, 0) / waitTimes.length).toFixed(2) : 0;\n    \n    res.json({\n        totalOrders: completedOrders.length,\n        avgDeliveryTime: `${avgDeliveryTime} хвилин`,\n        avgPrice: `${avgPrice} грн`,\n        avgRating,\n        popularRoutes,\n        avgWaitTime: `${avgWaitTime} хвилин`,\n        activeDrivers: drivers.length,\n        completionRate: `${((completedOrders.length / (db.orders || []).length) * 100).toFixed(1)}%`\n    });\n});\n\napp.listen(PORT, '0.0.0.0', () => console.log(`🚀 Running on port ${PORT}`));\n","size_bytes":43081},"client/src/lib/utils.ts":{"content":"import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n","size_bytes":166},"3123-main/client/src/pages/chat-page.tsx":{"content":"import { ArrowLeft } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { useLocation } from \"wouter\";\nimport Chat from \"@/components/chat\";\n\nexport default function ChatPage({ params }: { params: { orderId: string } }) {\n  const [, setLocation] = useLocation();\n\n  return (\n    <div className=\"h-screen flex flex-col bg-background\">\n      <div className=\"sticky top-0 z-10 bg-card border-b border-card-border\">\n        <div className=\"max-w-2xl mx-auto px-4 py-3 flex items-center gap-3\">\n          <Button\n            variant=\"ghost\"\n            size=\"icon\"\n            onClick={() => setLocation(\"/driver\")}\n            data-testid=\"button-back\"\n          >\n            <ArrowLeft className=\"w-5 h-5\" />\n          </Button>\n        </div>\n      </div>\n      <div className=\"flex-1 overflow-hidden\">\n        <div className=\"max-w-2xl mx-auto h-full\">\n          <Chat\n            orderId={params.orderId}\n            currentUserId=\"driver1\"\n            otherUserName=\"Іван Петренко\"\n          />\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":1081},"PROJECT_STRUCTURE.md":{"content":"# Telegram Taxi Service - Структура проекту\n\n## Назва проекту\n**Telegram Taxi Service Web App** - платформа для замовлення таксі, вантажних перевезень, кур'єрських послуг та евакуаторів через Telegram\n\n## Основні компоненти для копіювання\n\n### 1. **Backend структура** (`server/`)\n\n```\nserver/\n├── index-dev.ts          # Точка входу розробки\n├── index-prod.ts         # Точка входу продакшену\n├── storage.ts            # Interface для роботи з даними\n├── routes.ts             # REST API маршути\n├── telegram.ts           # Інтеграція з Telegram Bot API\n├── vite.ts              # Vite dev server\n└── index.ts             # Express app setup\n```\n\n**Ключові файли для копіювання:**\n- `storage.ts` - весь CRUD функціонал\n- `routes.ts` - всі API endpoints\n- `telegram.ts` - вся логіка бота\n\n### 2. **Frontend структура** (`client/src/`)\n\n```\nclient/src/\n├── pages/\n│   ├── role-selector.tsx      # Вибір ролі (Клієнт/Водій/Адмін)\n│   ├── client-home.tsx        # Меню для клієнта (4 типи замовлень)\n│   ├── order-form.tsx         # Форма замовлення\n│   ├── driver-dashboard.tsx   # Список замовлень для водія\n│   ├── driver-profile.tsx     # Профіль водія\n│   ├── admin-dashboard.tsx    # Панель адміністратора\n│   ├── admin-login.tsx        # Вхід в адмін (пароль: admin123)\n│   ├── chat-page.tsx          # Чат клієнт-водій\n│   └── not-found.tsx          # 404 сторінка\n├── components/\n│   ├── ui/                    # Shadcn UI компоненти\n│   ├── chat.tsx              # Компонент чату\n│   └── app-sidebar.tsx       # (якщо буде)\n├── lib/\n│   ├── user-provider.tsx     # React Context для юзера\n│   ├── use-user.ts           # Hook для доступу до контексту\n│   └── queryClient.ts        # TanStack Query конфіг\n├── App.tsx                   # Router та провайдери\n└── main.tsx                  # Entry point\n```\n\n### 3. **Дані/Схема** (`shared/schema.ts`)\n\n```typescript\n// Основні таблиці:\n- Users (id, role, name, phone, telegramAvatarUrl, warnings[], bonuses[], isBlocked)\n- Orders (orderId, type, clientId, driverId, from, to, status, driverBidPrice, proposalAttempts[])\n- AccessCodes (code, isUsed, issuedBy, usedBy, createdAt)\n- ChatMessages (id, orderId, senderId, message, createdAt)\n```\n\n---\n\n## Як використати як шаблон\n\n### Крок 1: Скопіюйте цільові папки\n```bash\ncp -r server/ your-project/server/\ncp -r client/src/ your-project/client/src/\ncp -r shared/ your-project/shared/\n```\n\n### Крок 2: Встановіть залежності\n```bash\nnpm install\n```\n\n### Крок 3: Налаштуйте Telegram Bot\n1. Напишіть @BotFather в Telegram\n2. Створіть нового бота командою `/newbot`\n3. Отримайте токен\n4. Встановіть `TELEGRAM_BOT_TOKEN` в `.env`\n\n### Крок 4: Налаштуйте базу даних\n- Автоматично використовується Replit PostgreSQL\n- Чи встановіть свою через `DATABASE_URL`\n\n### Крок 5: Запустіть\n```bash\nnpm run dev\n```\n\n---\n\n## API Endpoints (для інтеграції)\n\n### Users\n- `GET /api/users/:id` - отримати юзера\n- `POST /api/users` - створити юзера\n- `PATCH /api/users/:id` - оновити юзера\n- `POST /api/users/register-driver` - реєстрація водія з кодом\n\n### Orders\n- `GET /api/orders/active` - активні замовлення\n- `GET /api/orders/:id` - замовлення за ID\n- `POST /api/orders` - створити замовлення\n- `POST /api/orders/:id/accept` - водій приймає замовлення\n- `POST /api/orders/:id/bid` - водій пропонує ціну\n- `POST /api/orders/:id/respond` - клієнт відповідає на ціну\n\n### Admin\n- `GET /api/admin/drivers` - список всіх водіїв\n- `POST /api/admin/generate-code` - згенерувати код доступу\n- `POST /api/admin/drivers/:id/block` - заблокувати водія\n- `POST /api/admin/drivers/:id/warning` - видати попередження\n- `POST /api/admin/drivers/:id/bonus` - видати бонус\n\n### Chat\n- `GET /api/chat/:orderId` - отримати повідомлення\n- `POST /api/chat` - відправити повідомлення\n\n---\n\n## Типи замовлень\n\n1. **Taxi** - звичайне таксі\n2. **Cargo** - вантажне таксі (з описом вантажу)\n3. **Courier** - кур'єрська доставка (з описом що везти)\n4. **Towing** - евакуаторні послуги (з типом автомобіля)\n\n---\n\n## Роли користувачів\n\n| Роль | Доступ |\n|------|--------|\n| **Client** | Створення замовлень, переглядання пропозицій, чат з водієм |\n| **Driver** | Перегляд замовлень, пропозиція цін, профіль, чат |\n| **Admin** | Генерація кодів, управління водіями, блокування, попередження |\n\n---\n\n## Ключові технології\n\n- **Frontend:** React 18, TypeScript, Vite, Shadcn/ui, Tailwind CSS, Wouter (routing)\n- **Backend:** Express.js, Node.js, ESM modules\n- **State:** React Context + TanStack Query v5\n- **Forms:** React Hook Form + Zod validation\n- **Database:** PostgreSQL (Drizzle ORM)\n- **Bot:** Telegram Bot API\n\n---\n\n## Як повторити дизайн\n\n1. Скопіюйте `index.css` - містить всі кольорові змінні та Tailwind конфіг\n2. Скопіюйте `tailwind.config.ts` - налаштування дизайну системи\n3. Усі компоненти UI використовують Shadcn (готові, стилізовані)\n4. Мобільна-first адаптивність вже вбудована\n\n---\n\n## Запуск на Replit\n\n1. Завантажте цей проект на Replit\n2. Натисніть \"Run\"\n3. Бот автоматично зареєструється\n4. Напишіть боту `/start` в Telegram\n\n---\n\n## Важливі константи\n\n- Admin password: `admin123`\n- App URL в боті: встановлюється автоматично з `REPL_OWNER.REPL_ID`\n- Database: встановлюється автоматично на Replit\n\n","size_bytes":7077},"client/src/components/ui/radio-group.tsx":{"content":"import * as React from \"react\"\nimport * as RadioGroupPrimitive from \"@radix-ui/react-radio-group\"\nimport { Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst RadioGroup = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Root\n      className={cn(\"grid gap-2\", className)}\n      {...props}\n      ref={ref}\n    />\n  )\n})\nRadioGroup.displayName = RadioGroupPrimitive.Root.displayName\n\nconst RadioGroupItem = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        \"aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    >\n      <RadioGroupPrimitive.Indicator className=\"flex items-center justify-center\">\n        <Circle className=\"h-2.5 w-2.5 fill-current text-current\" />\n      </RadioGroupPrimitive.Indicator>\n    </RadioGroupPrimitive.Item>\n  )\n})\nRadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName\n\nexport { RadioGroup, RadioGroupItem }\n","size_bytes":1467},"client/src/pages/driver-profile.tsx":{"content":"import { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { ArrowLeft, User } from \"lucide-react\";\nimport { useLocation } from \"wouter\";\nimport { useMutation, useQuery } from \"@tanstack/react-query\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useUser } from \"@/lib/use-user\";\nimport type { User as UserType } from \"@shared/schema\";\n\nconst profileSchema = z.object({\n  name: z.string().min(2, \"Ім'я має містити мінімум 2 символи\"),\n  phone: z.string().min(10, \"Вкажіть коректний номер телефону\"),\n});\n\nexport default function DriverProfile() {\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n  const { userId: driverId } = useUser();\n\n  const { data: user } = useQuery<UserType>({\n    queryKey: [`/api/users/${driverId}`],\n  });\n\n  const updateProfileMutation = useMutation({\n    mutationFn: async (data: z.infer<typeof profileSchema>) => {\n      return await apiRequest(\"PATCH\", `/api/users/${driverId}`, data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [`/api/users/${driverId}`] });\n      toast({\n        title: \"Профіль оновлено\",\n        description: \"Зміни успішно збережено\",\n      });\n      setLocation(\"/driver\");\n    },\n    onError: () => {\n      toast({\n        title: \"Помилка\",\n        description: \"Не вдалося оновити профіль\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const form = useForm<z.infer<typeof profileSchema>>({\n    resolver: zodResolver(profileSchema),\n    defaultValues: {\n      name: user?.name || \"\",\n      phone: user?.phone || \"\",\n    },\n  });\n\n  const onSubmit = (data: z.infer<typeof profileSchema>) => {\n    updateProfileMutation.mutate(data);\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <div className=\"sticky top-0 z-10 bg-card border-b border-card-border\">\n        <div className=\"max-w-2xl mx-auto px-4 py-3 flex items-center gap-3\">\n          <Button\n            variant=\"ghost\"\n            size=\"icon\"\n            onClick={() => setLocation(\"/driver\")}\n            data-testid=\"button-back\"\n          >\n            <ArrowLeft className=\"w-5 h-5\" />\n          </Button>\n          <div className=\"flex-1\">\n            <h1 className=\"text-lg font-semibold\">Профіль водія</h1>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"max-w-2xl mx-auto p-4\">\n        <Card className=\"border-card-border\">\n          <CardHeader>\n            <CardTitle>Налаштування профілю</CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-6\">\n            <div className=\"flex justify-center\">\n              <Avatar className=\"w-24 h-24\">\n                <AvatarImage src={user?.telegramAvatarUrl || \"\"} alt=\"Аватар водія\" />\n                <AvatarFallback className=\"bg-primary text-primary-foreground text-2xl\">\n                  <User className=\"w-12 h-12\" />\n                </AvatarFallback>\n              </Avatar>\n            </div>\n            <p className=\"text-sm text-center text-muted-foreground\">\n              Аватар автоматично завантажується з вашого профілю Telegram\n            </p>\n\n            <Form {...form}>\n              <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n                <FormField\n                  control={form.control}\n                  name=\"name\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Ім'я *</FormLabel>\n                      <FormControl>\n                        <Input\n                          placeholder=\"Ваше ім'я\"\n                          {...field}\n                          data-testid=\"input-name\"\n                          className=\"text-base h-12\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={form.control}\n                  name=\"phone\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Номер телефону *</FormLabel>\n                      <FormControl>\n                        <Input\n                          type=\"tel\"\n                          placeholder=\"+380 XX XXX XX XX\"\n                          {...field}\n                          data-testid=\"input-phone\"\n                          className=\"text-base h-12\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <Button\n                  type=\"submit\"\n                  className=\"w-full h-14 text-lg font-semibold\"\n                  data-testid=\"button-save-profile\"\n                  disabled={updateProfileMutation.isPending}\n                >\n                  {updateProfileMutation.isPending ? \"Збереження...\" : \"Зберегти профіль\"}\n                </Button>\n              </form>\n            </Form>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}\n","size_bytes":5788},"client/src/hooks/use-mobile.tsx":{"content":"import * as React from \"react\"\n\nconst MOBILE_BREAKPOINT = 768\n\nexport function useIsMobile() {\n  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)\n\n  React.useEffect(() => {\n    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)\n    const onChange = () => {\n      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    }\n    mql.addEventListener(\"change\", onChange)\n    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    return () => mql.removeEventListener(\"change\", onChange)\n  }, [])\n\n  return !!isMobile\n}\n","size_bytes":565},"server/routes.ts":{"content":"import type { Express } from \"express\";\nimport { createServer, type Server } from \"http\";\nimport { storage } from \"./storage\";\nimport { z } from \"zod\";\nimport {\n  insertUserSchema,\n  insertOrderSchema,\n  insertChatMessageSchema,\n} from \"@shared/schema\";\nimport { handleTelegramUpdate, getBotInfo, autoSetupWebhook } from \"./telegram\";\nimport { rateLimitMiddleware } from \"./middleware/rate-limit\";\n\nexport async function registerRoutes(app: Express): Promise<Server> {\n  // User routes\n  app.get(\"/api/users/:id\", async (req, res) => {\n    const user = await storage.getUser(req.params.id);\n    if (!user) {\n      return res.status(404).json({ error: \"User not found\" });\n    }\n    res.json(user);\n  });\n\n  app.post(\"/api/users\", async (req, res) => {\n    try {\n      const data = insertUserSchema.parse(req.body);\n      const user = await storage.createUser(data);\n      res.status(201).json(user);\n    } catch (error) {\n      res.status(400).json({ error: \"Invalid user data\" });\n    }\n  });\n\n  app.patch(\"/api/users/:id\", async (req, res) => {\n    try {\n      const updates = req.body;\n      const user = await storage.updateUser(req.params.id, updates);\n      if (!user) {\n        return res.status(404).json({ error: \"User not found\" });\n      }\n      res.json(user);\n    } catch (error) {\n      res.status(400).json({ error: \"Invalid update data\" });\n    }\n  });\n\n  app.post(\"/api/users/register-driver\", async (req, res) => {\n    try {\n      const schema = z.object({\n        userId: z.string(),\n        code: z.string(),\n        name: z.string(),\n        phone: z.string(),\n      });\n      const data = schema.parse(req.body);\n\n      const user = await storage.registerDriverWithCode(\n        data.userId,\n        data.code,\n        data.name,\n        data.phone\n      );\n\n      if (!user) {\n        return res.status(400).json({ error: \"Invalid or used access code\" });\n      }\n\n      res.status(201).json(user);\n    } catch (error) {\n      res.status(400).json({ error: \"Invalid registration data\" });\n    }\n  });\n\n  // Order routes\n  app.get(\"/api/orders/active\", async (req, res) => {\n    const orders = await storage.getActiveOrders();\n    res.json(orders);\n  });\n\n  app.get(\"/api/orders/:id\", async (req, res) => {\n    const order = await storage.getOrder(req.params.id);\n    if (!order) {\n      return res.status(404).json({ error: \"Order not found\" });\n    }\n    res.json(order);\n  });\n\n  app.get(\"/api/orders/client/:clientId\", async (req, res) => {\n    const orders = await storage.getOrdersByClient(req.params.clientId);\n    res.json(orders);\n  });\n\n  app.get(\"/api/orders/driver/:driverId\", async (req, res) => {\n    const orders = await storage.getOrdersByDriver(req.params.driverId);\n    res.json(orders);\n  });\n\n  app.post(\"/api/orders\", rateLimitMiddleware, async (req, res) => {\n    try {\n      const data = insertOrderSchema.parse(req.body);\n      const order = await storage.createOrder(data);\n      res.status(201).json(order);\n    } catch (error) {\n      res.status(400).json({ error: \"Invalid order data\" });\n    }\n  });\n\n  app.post(\"/api/orders/:id/accept\", async (req, res) => {\n    try {\n      const schema = z.object({\n        driverId: z.string(),\n      });\n      const data = schema.parse(req.body);\n\n      const order = await storage.acceptOrder(req.params.id, data.driverId);\n      if (!order) {\n        return res.status(400).json({ error: \"Cannot accept order\" });\n      }\n\n      res.json(order);\n    } catch (error) {\n      res.status(400).json({ error: \"Invalid request\" });\n    }\n  });\n\n  app.patch(\"/api/orders/:id\", async (req, res) => {\n    try {\n      const updates = req.body;\n      const order = await storage.updateOrder(req.params.id, updates);\n      if (!order) {\n        return res.status(404).json({ error: \"Order not found\" });\n      }\n      res.json(order);\n    } catch (error) {\n      res.status(400).json({ error: \"Invalid update data\" });\n    }\n  });\n\n  app.post(\"/api/orders/:id/rate\", async (req, res) => {\n    try {\n      const schema = z.object({\n        stars: z.number().min(1).max(5),\n        comment: z.string().optional(),\n      });\n      const data = schema.parse(req.body);\n\n      const success = await storage.rateOrder(req.params.id, data.stars, data.comment);\n      if (!success) {\n        return res.status(400).json({ error: \"Cannot rate order\" });\n      }\n\n      res.json({ success: true });\n    } catch (error) {\n      res.status(400).json({ error: \"Invalid rating data\" });\n    }\n  });\n\n  // Driver rating routes\n  app.get(\"/api/drivers/:id/stats\", async (req, res) => {\n    try {\n      const stats = await storage.getDriverStats(req.params.id);\n      res.json(stats);\n    } catch (error) {\n      res.status(500).json({ error: \"Cannot retrieve driver stats\" });\n    }\n  });\n\n  app.get(\"/api/drivers/:id/badges\", async (req, res) => {\n    try {\n      const badges = await storage.getDriverBadges(req.params.id);\n      res.json({ badges });\n    } catch (error) {\n      res.status(500).json({ error: \"Cannot retrieve driver badges\" });\n    }\n  });\n\n  // Admin routes\n  app.get(\"/api/admin/drivers\", async (req, res) => {\n    const drivers = await storage.getAllDrivers();\n    res.json(drivers);\n  });\n\n  app.post(\"/api/admin/generate-code\", async (req, res) => {\n    try {\n      const schema = z.object({\n        adminId: z.string(),\n      });\n      const data = schema.parse(req.body);\n\n      const code = await storage.generateAccessCode(data.adminId);\n      res.status(201).json(code);\n    } catch (error) {\n      res.status(400).json({ error: \"Invalid request\" });\n    }\n  });\n\n  app.post(\"/api/admin/drivers/:id/block\", async (req, res) => {\n    try {\n      const driver = await storage.getUser(req.params.id);\n      if (!driver || driver.role !== \"driver\") {\n        return res.status(404).json({ error: \"Driver not found\" });\n      }\n\n      const updated = await storage.updateUser(req.params.id, {\n        isBlocked: !driver.isBlocked,\n      });\n      res.json(updated);\n    } catch (error) {\n      res.status(400).json({ error: \"Cannot block driver\" });\n    }\n  });\n\n  app.post(\"/api/admin/drivers/:id/warning\", async (req, res) => {\n    try {\n      const schema = z.object({\n        text: z.string(),\n      });\n      const data = schema.parse(req.body);\n\n      const driver = await storage.getUser(req.params.id);\n      if (!driver || driver.role !== \"driver\") {\n        return res.status(404).json({ error: \"Driver not found\" });\n      }\n\n      const warnings = driver.warnings || [];\n      const updated = await storage.updateUser(req.params.id, {\n        warnings: [...warnings, data.text],\n      });\n      res.json(updated);\n    } catch (error) {\n      res.status(400).json({ error: \"Cannot add warning\" });\n    }\n  });\n\n  app.post(\"/api/admin/drivers/:id/bonus\", async (req, res) => {\n    try {\n      const schema = z.object({\n        text: z.string(),\n      });\n      const data = schema.parse(req.body);\n\n      const driver = await storage.getUser(req.params.id);\n      if (!driver || driver.role !== \"driver\") {\n        return res.status(404).json({ error: \"Driver not found\" });\n      }\n\n      const bonuses = driver.bonuses || [];\n      const updated = await storage.updateUser(req.params.id, {\n        bonuses: [...bonuses, data.text],\n      });\n      res.json(updated);\n    } catch (error) {\n      res.status(400).json({ error: \"Cannot add bonus\" });\n    }\n  });\n\n  // Chat routes\n  app.get(\"/api/chat/:orderId\", async (req, res) => {\n    const messages = await storage.getChatMessages(req.params.orderId);\n    res.json(messages);\n  });\n\n  app.post(\"/api/chat\", async (req, res) => {\n    try {\n      const data = insertChatMessageSchema.parse(req.body);\n      const message = await storage.sendChatMessage(data);\n      res.status(201).json(message);\n    } catch (error) {\n      res.status(400).json({ error: \"Invalid message data\" });\n    }\n  });\n\n  // Telegram webhook\n  app.post(\"/api/telegram/webhook\", async (req, res) => {\n    try {\n      // Setup webhook on first telegram message (auto-detect from request)\n      if (!process.env.WEBHOOK_SETUP_DONE) {\n        const protocol = req.headers[\"x-forwarded-proto\"] || \"https\";\n        const host = req.headers[\"x-forwarded-host\"] || req.headers.host;\n        if (host) {\n          const baseUrl = `${protocol}://${host}`;\n          await autoSetupWebhook(baseUrl);\n          process.env.WEBHOOK_SETUP_DONE = \"true\";\n        }\n      }\n\n      const update = req.body;\n      await handleTelegramUpdate(update);\n      res.json({ ok: true });\n    } catch (error) {\n      console.error(\"Telegram webhook error:\", error);\n      res.status(500).json({ error: \"Internal server error\" });\n    }\n  });\n\n  // Check bot connection on startup\n  await getBotInfo();\n\n  const httpServer = createServer(app);\n  return httpServer;\n}\n","size_bytes":8764},"3123-main/client/src/pages/admin-login.tsx":{"content":"import { useState } from \"react\";\nimport { Card } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { useLocation } from \"wouter\";\nimport { useUser } from \"@/lib/use-user\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { ArrowLeft, Shield } from \"lucide-react\";\n\nconst ADMIN_PASSWORD = \"admin123\";\n\nexport default function AdminLogin() {\n  const [, setLocation] = useLocation();\n  const { setRole } = useUser();\n  const { toast } = useToast();\n  const [password, setPassword] = useState(\"\");\n  const [isLoading, setIsLoading] = useState(false);\n\n  const handleLogin = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setIsLoading(true);\n\n    await new Promise((resolve) => setTimeout(resolve, 500));\n\n    if (password === ADMIN_PASSWORD) {\n      setRole(\"admin\");\n      toast({\n        title: \"Успіх\",\n        description: \"Ви увійшли як адміністратор\",\n      });\n      setLocation(\"/admin\");\n    } else {\n      toast({\n        title: \"Помилка\",\n        description: \"Неправильний пароль\",\n        variant: \"destructive\",\n      });\n      setPassword(\"\");\n    }\n\n    setIsLoading(false);\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background flex items-center justify-center p-4\">\n      <div className=\"max-w-md w-full space-y-8\">\n        <Button\n          variant=\"ghost\"\n          size=\"sm\"\n          onClick={() => setLocation(\"/role-selector\")}\n          className=\"mb-4\"\n          data-testid=\"button-back\"\n        >\n          <ArrowLeft className=\"w-4 h-4 mr-2\" />\n          Назад\n        </Button>\n\n        <div className=\"text-center space-y-2\">\n          <div className=\"flex justify-center mb-4\">\n            <div className=\"bg-primary text-primary-foreground rounded-xl p-4\">\n              <Shield className=\"w-8 h-8\" />\n            </div>\n          </div>\n          <h1 className=\"text-3xl font-bold\">Адміністратор</h1>\n          <p className=\"text-muted-foreground\">Введіть пароль для входу</p>\n        </div>\n\n        <Card className=\"p-6\">\n          <form onSubmit={handleLogin} className=\"space-y-4\">\n            <div className=\"space-y-2\">\n              <Label htmlFor=\"password\">Пароль</Label>\n              <Input\n                id=\"password\"\n                type=\"password\"\n                placeholder=\"••••••••\"\n                value={password}\n                onChange={(e) => setPassword(e.target.value)}\n                disabled={isLoading}\n                data-testid=\"input-admin-password\"\n              />\n            </div>\n\n            <Button\n              type=\"submit\"\n              className=\"w-full\"\n              disabled={isLoading}\n              data-testid=\"button-admin-login\"\n            >\n              {isLoading ? \"Вхід...\" : \"Увійти\"}\n            </Button>\n          </form>\n        </Card>\n\n        <div className=\"text-center text-xs text-muted-foreground pt-4 space-y-1\">\n          <p>Пароль: admin123</p>\n          <p className=\"text-xs text-muted-foreground/70\">\n            (У продакшені пароль зберігатиметься безпечно на сервері)\n          </p>\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":3380},"client/src/components/ui/toggle-group.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ToggleGroupPrimitive from \"@radix-ui/react-toggle-group\"\nimport { type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { toggleVariants } from \"@/components/ui/toggle\"\n\nconst ToggleGroupContext = React.createContext<\n  VariantProps<typeof toggleVariants>\n>({\n  size: \"default\",\n  variant: \"default\",\n})\n\nconst ToggleGroup = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, children, ...props }, ref) => (\n  <ToggleGroupPrimitive.Root\n    ref={ref}\n    className={cn(\"flex items-center justify-center gap-1\", className)}\n    {...props}\n  >\n    <ToggleGroupContext.Provider value={{ variant, size }}>\n      {children}\n    </ToggleGroupContext.Provider>\n  </ToggleGroupPrimitive.Root>\n))\n\nToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName\n\nconst ToggleGroupItem = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> &\n    VariantProps<typeof toggleVariants>\n>(({ className, children, variant, size, ...props }, ref) => {\n  const context = React.useContext(ToggleGroupContext)\n\n  return (\n    <ToggleGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        toggleVariants({\n          variant: context.variant || variant,\n          size: context.size || size,\n        }),\n        className\n      )}\n      {...props}\n    >\n      {children}\n    </ToggleGroupPrimitive.Item>\n  )\n})\n\nToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName\n\nexport { ToggleGroup, ToggleGroupItem }\n","size_bytes":1753},"client/src/lib/queryClient.ts":{"content":"import { QueryClient, QueryFunction } from \"@tanstack/react-query\";\n\nasync function throwIfResNotOk(res: Response) {\n  if (!res.ok) {\n    const text = (await res.text()) || res.statusText;\n    throw new Error(`${res.status}: ${text}`);\n  }\n}\n\nexport async function apiRequest(\n  method: string,\n  url: string,\n  data?: unknown | undefined,\n): Promise<Response> {\n  const res = await fetch(url, {\n    method,\n    headers: data ? { \"Content-Type\": \"application/json\" } : {},\n    body: data ? JSON.stringify(data) : undefined,\n    credentials: \"include\",\n  });\n\n  await throwIfResNotOk(res);\n  return res;\n}\n\ntype UnauthorizedBehavior = \"returnNull\" | \"throw\";\nexport const getQueryFn: <T>(options: {\n  on401: UnauthorizedBehavior;\n}) => QueryFunction<T> =\n  ({ on401: unauthorizedBehavior }) =>\n  async ({ queryKey }) => {\n    const res = await fetch(queryKey.join(\"/\") as string, {\n      credentials: \"include\",\n    });\n\n    if (unauthorizedBehavior === \"returnNull\" && res.status === 401) {\n      return null;\n    }\n\n    await throwIfResNotOk(res);\n    return await res.json();\n  };\n\nexport const queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      queryFn: getQueryFn({ on401: \"throw\" }),\n      refetchInterval: false,\n      refetchOnWindowFocus: false,\n      staleTime: Infinity,\n      retry: false,\n    },\n    mutations: {\n      retry: false,\n    },\n  },\n});\n","size_bytes":1383},"client/src/pages/order-form.tsx":{"content":"import { useForm } from \"react-hook-form\";\nimport { zodResolver } from \"@hookform/resolvers/zod\";\nimport { z } from \"zod\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Form, FormControl, FormField, FormItem, FormLabel, FormMessage } from \"@/components/ui/form\";\nimport { Card, CardContent, CardHeader, CardTitle, CardDescription } from \"@/components/ui/card\";\nimport { ArrowLeft, MapPin, Navigation, Calculator } from \"lucide-react\";\nimport { useLocation } from \"wouter\";\nimport { insertOrderSchema, type OrderType } from \"@shared/schema\";\nimport { TARIFFS, calculatePrice, type TariffKey } from \"@shared/tariffs\";\nimport { useMutation } from \"@tanstack/react-query\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useUser } from \"@/lib/use-user\";\nimport { useState } from \"react\";\n\nconst orderTypeToTariff: Record<OrderType, TariffKey> = {\n  taxi: 'Таксі 🚕',\n  cargo: 'Вантажний 🚚',\n  courier: 'Кур\\'єр 📦',\n  towing: 'Буксир 🪝',\n};\n\nconst orderTypeConfig = {\n  taxi: {\n    title: \"Замовлення таксі\",\n    description: \"Вкажіть адреси початку та кінця поїздки\",\n    requiredLabel: null,\n    requiredPlaceholder: null,\n  },\n  cargo: {\n    title: \"Вантажне таксі\",\n    description: \"Вкажіть адреси та опис вантажу\",\n    requiredLabel: \"Опис вантажу *\",\n    requiredPlaceholder: \"Наприклад: Меблі, коробки 2х2м, вага ~50кг\",\n  },\n  courier: {\n    title: \"Кур'єр\",\n    description: \"Вкажіть адреси та що потрібно доставити\",\n    requiredLabel: \"Що доставити *\",\n    requiredPlaceholder: \"Наприклад: Документи, посилка, їжа\",\n  },\n  towing: {\n    title: \"Евакуатор\",\n    description: \"Вкажіть адреси та тип автомобіля\",\n    requiredLabel: \"Тип автомобіля *\",\n    requiredPlaceholder: \"Наприклад: Легковий седан, позашляховик\",\n  },\n};\n\nexport default function OrderForm({ params }: { params: { type: string } }) {\n  const [, setLocation] = useLocation();\n  const { toast } = useToast();\n  const { userId } = useUser();\n  const orderType = params.type as OrderType;\n  const config = orderTypeConfig[orderType];\n  const tariffKey = orderTypeToTariff[orderType];\n  const tariff = TARIFFS[tariffKey];\n  \n  const [distance, setDistance] = useState<number>(0);\n\n  const formSchema = insertOrderSchema.extend({\n    from: z.string().min(3, \"Вкажіть адресу початку\"),\n    to: z.string().min(3, \"Вкажіть адресу призначення\"),\n    requiredDetail: config.requiredLabel \n      ? z.string().min(2, `${config.requiredLabel.replace(\" *\", \"\")} обов'язкове`)\n      : z.string().optional(),\n    comment: z.string().optional(),\n    distanceKm: z.number().min(0.1, \"Вкажіть відстань\"),\n  });\n\n  const createOrderMutation = useMutation({\n    mutationFn: async (data: z.infer<typeof formSchema>) => {\n      return await apiRequest(\"POST\", \"/api/orders\", data);\n    },\n    onSuccess: () => {\n      toast({\n        title: \"Замовлення створено\",\n        description: \"Очікуйте на пропозиції від водіїв\",\n      });\n      setLocation(\"/\");\n    },\n    onError: () => {\n      toast({\n        title: \"Помилка\",\n        description: \"Не вдалося створити замовлення\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  const form = useForm<z.infer<typeof formSchema>>({\n    resolver: zodResolver(formSchema),\n    defaultValues: {\n      type: orderType,\n      from: \"\",\n      to: \"\",\n      requiredDetail: \"\",\n      comment: \"\",\n      clientId: userId,\n      distanceKm: 0,\n    },\n  });\n\n  const watchedDistance = form.watch(\"distanceKm\");\n  const estimatedPrice = watchedDistance > 0 ? calculatePrice(tariffKey, watchedDistance) : 0;\n\n  const onSubmit = (data: z.infer<typeof formSchema>) => {\n    const orderData = {\n      ...data,\n      price: estimatedPrice,\n    };\n    createOrderMutation.mutate(orderData);\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <div className=\"sticky top-0 z-10 bg-card border-b border-card-border\">\n        <div className=\"max-w-2xl mx-auto px-4 py-3 flex items-center gap-3\">\n          <Button\n            variant=\"ghost\"\n            size=\"icon\"\n            onClick={() => setLocation(\"/\")}\n            data-testid=\"button-back\"\n          >\n            <ArrowLeft className=\"w-5 h-5\" />\n          </Button>\n          <div className=\"flex-1\">\n            <h1 className=\"text-lg font-semibold\">{config.title}</h1>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"max-w-2xl mx-auto p-4\">\n        <Card className=\"border-card-border\">\n          <CardHeader className=\"space-y-1\">\n            <CardTitle>{config.title}</CardTitle>\n            <CardDescription>{config.description}</CardDescription>\n            <div className=\"pt-2 px-4 py-3 bg-primary/10 rounded-lg border border-primary/20\">\n              <div className=\"flex items-center gap-2 text-sm font-medium mb-1\">\n                <Calculator className=\"w-4 h-4 text-primary\" />\n                <span>Тариф</span>\n              </div>\n              <div className=\"text-sm text-muted-foreground\">\n                <div>Базова ціна: <span className=\"font-semibold text-foreground\">{tariff.basePrice} грн</span></div>\n                <div>За кілометр: <span className=\"font-semibold text-foreground\">{tariff.perKm} грн/км</span></div>\n              </div>\n            </div>\n          </CardHeader>\n          <CardContent>\n            <Form {...form}>\n              <form onSubmit={form.handleSubmit(onSubmit)} className=\"space-y-4\">\n                <FormField\n                  control={form.control}\n                  name=\"from\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel className=\"flex items-center gap-2\">\n                        <MapPin className=\"w-4 h-4 text-primary\" />\n                        Звідки *\n                      </FormLabel>\n                      <FormControl>\n                        <Input\n                          placeholder=\"Вкажіть адресу початку\"\n                          {...field}\n                          data-testid=\"input-from\"\n                          className=\"text-base h-12\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={form.control}\n                  name=\"to\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel className=\"flex items-center gap-2\">\n                        <Navigation className=\"w-4 h-4 text-primary\" />\n                        Куди *\n                      </FormLabel>\n                      <FormControl>\n                        <Input\n                          placeholder=\"Вкажіть адресу призначення\"\n                          {...field}\n                          data-testid=\"input-to\"\n                          className=\"text-base h-12\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <FormField\n                  control={form.control}\n                  name=\"distanceKm\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel className=\"flex items-center gap-2\">\n                        <Calculator className=\"w-4 h-4 text-primary\" />\n                        Відстань (км) *\n                      </FormLabel>\n                      <FormControl>\n                        <Input\n                          type=\"number\"\n                          step=\"0.1\"\n                          min=\"0\"\n                          placeholder=\"Наприклад: 5.5\"\n                          {...field}\n                          onChange={(e) => {\n                            const value = parseFloat(e.target.value) || 0;\n                            field.onChange(value);\n                            setDistance(value);\n                          }}\n                          data-testid=\"input-distance\"\n                          className=\"text-base h-12\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                {estimatedPrice > 0 && (\n                  <div className=\"p-4 bg-primary/5 rounded-lg border border-primary/20\">\n                    <div className=\"text-sm text-muted-foreground mb-1\">Орієнтовна вартість</div>\n                    <div className=\"text-2xl font-bold text-primary\">{estimatedPrice} грн</div>\n                    <div className=\"text-xs text-muted-foreground mt-1\">\n                      {tariff.basePrice} грн + {watchedDistance} км × {tariff.perKm} грн/км\n                    </div>\n                  </div>\n                )}\n\n                {config.requiredLabel && (\n                  <FormField\n                    control={form.control}\n                    name=\"requiredDetail\"\n                    render={({ field }) => (\n                      <FormItem>\n                        <FormLabel>{config.requiredLabel}</FormLabel>\n                        <FormControl>\n                          <Input\n                            placeholder={config.requiredPlaceholder || \"\"}\n                            {...field}\n                            data-testid=\"input-required-detail\"\n                            className=\"text-base h-12\"\n                          />\n                        </FormControl>\n                        <FormMessage />\n                      </FormItem>\n                    )}\n                  />\n                )}\n\n                <FormField\n                  control={form.control}\n                  name=\"comment\"\n                  render={({ field }) => (\n                    <FormItem>\n                      <FormLabel>Коментар (опціонально)</FormLabel>\n                      <FormControl>\n                        <Textarea\n                          placeholder=\"Додаткові деталі замовлення\"\n                          {...field}\n                          data-testid=\"input-comment\"\n                          className=\"resize-none text-base min-h-24\"\n                        />\n                      </FormControl>\n                      <FormMessage />\n                    </FormItem>\n                  )}\n                />\n\n                <Button\n                  type=\"submit\"\n                  className=\"w-full h-14 text-lg font-semibold\"\n                  data-testid=\"button-submit-order\"\n                  disabled={createOrderMutation.isPending}\n                >\n                  {createOrderMutation.isPending ? \"Створення...\" : \"Створити замовлення\"}\n                </Button>\n              </form>\n            </Form>\n          </CardContent>\n        </Card>\n      </div>\n    </div>\n  );\n}\n","size_bytes":11604},"client/src/components/ui/command.tsx":{"content":"import * as React from \"react\"\nimport { type DialogProps } from \"@radix-ui/react-dialog\"\nimport { Command as CommandPrimitive } from \"cmdk\"\nimport { Search } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Dialog, DialogContent } from \"@/components/ui/dialog\"\n\nconst Command = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nCommand.displayName = CommandPrimitive.displayName\n\nconst CommandDialog = ({ children, ...props }: DialogProps) => {\n  return (\n    <Dialog {...props}>\n      <DialogContent className=\"overflow-hidden p-0 shadow-lg\">\n        <Command className=\"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5\">\n          {children}\n        </Command>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst CommandInput = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Input>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>\n>(({ className, ...props }, ref) => (\n  <div className=\"flex items-center border-b px-3\" cmdk-input-wrapper=\"\">\n    <Search className=\"mr-2 h-4 w-4 shrink-0 opacity-50\" />\n    <CommandPrimitive.Input\n      ref={ref}\n      className={cn(\n        \"flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  </div>\n))\n\nCommandInput.displayName = CommandPrimitive.Input.displayName\n\nconst CommandList = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.List\n    ref={ref}\n    className={cn(\"max-h-[300px] overflow-y-auto overflow-x-hidden\", className)}\n    {...props}\n  />\n))\n\nCommandList.displayName = CommandPrimitive.List.displayName\n\nconst CommandEmpty = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Empty>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>\n>((props, ref) => (\n  <CommandPrimitive.Empty\n    ref={ref}\n    className=\"py-6 text-center text-sm\"\n    {...props}\n  />\n))\n\nCommandEmpty.displayName = CommandPrimitive.Empty.displayName\n\nconst CommandGroup = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Group>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Group\n    ref={ref}\n    className={cn(\n      \"overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandGroup.displayName = CommandPrimitive.Group.displayName\n\nconst CommandSeparator = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nCommandSeparator.displayName = CommandPrimitive.Separator.displayName\n\nconst CommandItem = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandItem.displayName = CommandPrimitive.Item.displayName\n\nconst CommandShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nCommandShortcut.displayName = \"CommandShortcut\"\n\nexport {\n  Command,\n  CommandDialog,\n  CommandInput,\n  CommandList,\n  CommandEmpty,\n  CommandGroup,\n  CommandItem,\n  CommandShortcut,\n  CommandSeparator,\n}\n","size_bytes":4885},"server/telegram.ts":{"content":"import { storage } from \"./storage\";\n\nconst TELEGRAM_API = \"https://api.telegram.org\";\nconst BOT_TOKEN = process.env.TELEGRAM_BOT_TOKEN;\n\ninterface TelegramMessage {\n  message_id: number;\n  chat: { id: number };\n  from: { id: number; first_name: string };\n  text?: string;\n}\n\ninterface TelegramUpdate {\n  update_id: number;\n  message?: TelegramMessage;\n}\n\nexport async function handleTelegramUpdate(update: TelegramUpdate) {\n  if (!update.message) return;\n  const message = update.message;\n  if (!message.text) return;\n\n  const chatId = message.chat.id;\n  const userId = String(message.from.id);\n  const firstName = message.from.first_name;\n  const text = message.text.trim();\n\n  try {\n    // Handle /start command\n    if (text === \"/start\") {\n      await sendTelegramMessage(\n        chatId,\n        `👋 Привіт, ${firstName}!\\n\\nДобро пожалувати до Таксі-Сервісу!\\n\\nВиберіть вашу роль:\\n🚖 Клієнт\\n🚗 Водій\\n🛡️ Адміністратор (пароль захищено)\\n\\nТапни кнопку нижче, щоб запустити додаток:`,\n        [\n          [\n            {\n              text: \"🚀 Запустити додаток\",\n              web_app: {\n                url: process.env.APP_URL || \"https://localhost:5000\",\n              },\n            },\n          ],\n        ]\n      );\n      return;\n    }\n\n    // Handle /generate_code command (admin only)\n    if (text === \"/generate_code\") {\n      const user = await storage.getUser(userId);\n      if (!user || user.role !== \"admin\") {\n        await sendTelegramMessage(\n          chatId,\n          \"❌ Ви не маєте прав для цієї команди. Тільки адміністратори можуть генерувати коди.\"\n        );\n        return;\n      }\n\n      const accessCode = await storage.generateAccessCode(userId);\n\n      await sendTelegramMessage(\n        chatId,\n        `✅ Новий код доступу сгенерований:\\n\\n🔑 <code>${accessCode.code}</code>\\n\\nПоділіться цим кодом з водієм для реєстрації.`,\n        undefined,\n        { parse_mode: \"HTML\" }\n      );\n      return;\n    }\n\n    // Handle /help command\n    if (text === \"/help\") {\n      await sendTelegramMessage(\n        chatId,\n        `📖 Доступні команди:\\n\\n/start - Запустити додаток\\n/help - Цей пункт\\n/generate_code - Генерувати код доступу (тільки для адміна)\\n\\n🎯 Натисніть кнопку \"Запустити додаток\" для отримання повного доступу.`\n      );\n      return;\n    }\n\n    // Default response\n    await sendTelegramMessage(\n      chatId,\n      `Я не розумію цю команду. Введіть /help для списку команд.`\n    );\n  } catch (error) {\n    console.error(\"Telegram update error:\", error);\n    await sendTelegramMessage(\n      chatId,\n      \"❌ Сталася помилка. Спробуйте пізніше.\"\n    ).catch(() => {});\n  }\n}\n\nexport async function sendTelegramMessage(\n  chatId: number,\n  text: string,\n  replyMarkup?: any[],\n  options?: Record<string, any>\n) {\n  if (!BOT_TOKEN) {\n    console.error(\"TELEGRAM_BOT_TOKEN not configured\");\n    return;\n  }\n\n  try {\n    const payload: Record<string, any> = {\n      chat_id: chatId,\n      text,\n      parse_mode: \"Markdown\",\n      ...options,\n    };\n\n    if (replyMarkup) {\n      payload.reply_markup = {\n        inline_keyboard: replyMarkup,\n      };\n    }\n\n    const response = await fetch(`${TELEGRAM_API}/bot${BOT_TOKEN}/sendMessage`, {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify(payload),\n    });\n\n    if (!response.ok) {\n      console.error(\"Telegram API error:\", await response.text());\n    }\n  } catch (error) {\n    console.error(\"Error sending Telegram message:\", error);\n  }\n}\n\nexport async function setWebhook(url: string) {\n  if (!BOT_TOKEN) {\n    console.error(\"TELEGRAM_BOT_TOKEN not configured\");\n    return false;\n  }\n\n  try {\n    const webhookUrl = `${url}/api/telegram/webhook`;\n    const response = await fetch(\n      `${TELEGRAM_API}/bot${BOT_TOKEN}/setWebhook`,\n      {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          url: webhookUrl,\n          allowed_updates: [\"message\"],\n        }),\n      }\n    );\n\n    const result = await response.json();\n    if (result.ok) {\n      console.log(`✅ Telegram webhook configured: ${webhookUrl}`);\n    } else {\n      console.error(\"❌ Webhook error:\", result.description);\n    }\n    return result.ok;\n  } catch (error) {\n    console.error(\"Error setting Telegram webhook:\", error);\n    return false;\n  }\n}\n\nlet webhookSetupPromise: Promise<boolean> | null = null;\n\nexport async function autoSetupWebhook(baseUrl?: string) {\n  if (!BOT_TOKEN) {\n    return false;\n  }\n\n  // Return existing promise if setup is already in progress\n  if (webhookSetupPromise) {\n    return webhookSetupPromise;\n  }\n\n  const url = baseUrl || process.env.APP_URL;\n  \n  if (!url) {\n    return false;\n  }\n\n  webhookSetupPromise = setWebhook(url);\n  return webhookSetupPromise;\n}\n\nexport async function getBotInfo() {\n  if (!BOT_TOKEN) {\n    console.error(\"TELEGRAM_BOT_TOKEN not configured\");\n    return null;\n  }\n\n  try {\n    const response = await fetch(`${TELEGRAM_API}/bot${BOT_TOKEN}/getMe`);\n    const data = await response.json();\n    if (data.ok) {\n      console.log(`✅ Telegram Bot Connected: @${data.result.username}`);\n      return data.result;\n    }\n    return null;\n  } catch (error) {\n    console.error(\"Error getting bot info:\", error);\n    return null;\n  }\n}\n","size_bytes":5796},"3123-main/client/src/pages/client-home.tsx":{"content":"import { Card } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Car, Truck, Package, Unplug } from \"lucide-react\";\nimport { useLocation } from \"wouter\";\n\nexport default function ClientHome() {\n  const [, setLocation] = useLocation();\n\n  const orderTypes = [\n    {\n      type: \"taxi\" as const,\n      icon: Car,\n      label: \"Таксі\",\n      description: \"Поїздки по місту\",\n      color: \"bg-primary text-primary-foreground\",\n    },\n    {\n      type: \"cargo\" as const,\n      icon: Truck,\n      label: \"Вантажне\",\n      description: \"Перевезення вантажу\",\n      color: \"bg-primary text-primary-foreground\",\n    },\n    {\n      type: \"courier\" as const,\n      icon: Package,\n      label: \"Кур'єр\",\n      description: \"Доставка посилок\",\n      color: \"bg-primary text-primary-foreground\",\n    },\n    {\n      type: \"towing\" as const,\n      icon: Unplug,\n      label: \"Евакуатор\",\n      description: \"Буксирування авто\",\n      color: \"bg-primary text-primary-foreground\",\n    },\n  ];\n\n  return (\n    <div className=\"min-h-screen bg-background p-4\">\n      <div className=\"max-w-2xl mx-auto space-y-6\">\n        <div className=\"text-center space-y-2 py-6\">\n          <h1 className=\"text-2xl font-bold text-foreground\">Виберіть тип замовлення</h1>\n          <p className=\"text-sm text-muted-foreground\">Оберіть послугу, яка вам потрібна</p>\n        </div>\n\n        <div className=\"grid grid-cols-2 gap-4\">\n          {orderTypes.map((item) => {\n            const Icon = item.icon;\n            return (\n              <Card\n                key={item.type}\n                className=\"overflow-hidden hover-elevate active-elevate-2 cursor-pointer border-card-border\"\n                onClick={() => setLocation(`/order/${item.type}`)}\n                data-testid={`button-order-${item.type}`}\n              >\n                <div className=\"h-32 p-4 flex flex-col items-center justify-center space-y-3\">\n                  <div className={`${item.color} rounded-xl p-3`}>\n                    <Icon className=\"w-8 h-8\" />\n                  </div>\n                  <div className=\"text-center space-y-1\">\n                    <div className=\"text-lg font-semibold\">{item.label}</div>\n                    <div className=\"text-xs text-muted-foreground\">{item.description}</div>\n                  </div>\n                </div>\n              </Card>\n            );\n          })}\n        </div>\n      </div>\n    </div>\n  );\n}\n","size_bytes":2576},"client/src/components/ui/slider.tsx":{"content":"import * as React from \"react\"\nimport * as SliderPrimitive from \"@radix-ui/react-slider\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Slider = React.forwardRef<\n  React.ElementRef<typeof SliderPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <SliderPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex w-full touch-none select-none items-center\",\n      className\n    )}\n    {...props}\n  >\n    <SliderPrimitive.Track className=\"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary\">\n      <SliderPrimitive.Range className=\"absolute h-full bg-primary\" />\n    </SliderPrimitive.Track>\n    <SliderPrimitive.Thumb className=\"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50\" />\n  </SliderPrimitive.Root>\n))\nSlider.displayName = SliderPrimitive.Root.displayName\n\nexport { Slider }\n","size_bytes":1077},"design_guidelines.md":{"content":"# Design Guidelines: Telegram Taxi Service Web App\n\n## Design Approach\n\n**Selected Approach:** Dark Cyberpunk Noir - Futuristic Neon Aesthetic\n\n**Justification:** The cyberpunk noir theme delivers a modern, high-tech visual identity with neon colors providing excellent contrast and visual hierarchy. The dark background reduces eye strain on mobile devices while the vibrant neon accents create an engaging, premium feel for a taxi service platform.\n\n**Core Principles:**\n- Deep dark backgrounds (almost black) for reduced eye strain\n- Neon cyan and magenta as primary interaction colors\n- High contrast for accessibility and visual impact\n- Sleek, futuristic aesthetic with glowing effects\n- Mobile-first, thumb-friendly interactions\n\n---\n\n## Color Palette\n\n**Primary Colors:**\n- **Background:** Deep Black (#0a0a0a) - Almost pitch black for maximum contrast\n- **Foreground:** Bright Cyan (#00ffff) - Used for text and interactive elements\n- **Primary Action:** Neon Cyan (180° 100% 50%) - Call-to-action buttons\n- **Secondary:** Neon Magenta (280° 100% 45%) - Alternative actions and emphasis\n- **Accent:** Neon Green/Lime (120° 100% 50%) - Highlights and notifications\n\n**Secondary Colors:**\n- **Card Background:** Dark Gray (#141414) - Slightly elevated from main background\n- **Border:** Neon Purple/Magenta - Neon borders for cyberpunk effect\n- **Muted Text:** Cyan at 70% opacity - Secondary information\n- **Input Fields:** Dark Gray (#262626) - Form inputs with neon focus states\n\n**Shadows & Glow:**\n- All shadows use cyan glow (rgba(0, 255, 255, 0.1-0.3))\n- Creates a subtle \"neon glow\" effect for depth\n- Shadow intensity increases on hover/active states\n\n---\n\n## Typography\n\n**Font Stack:**\n- Primary: Inter (Google Fonts) - weights 400, 500, 600, 700\n- Monospace: JetBrains Mono for codes/IDs\n\n**Hierarchy:**\n- Page Titles: text-2xl font-bold (32px) - Bright cyan\n- Section Headers: text-xl font-semibold (24px) - Cyan with slight glow\n- Card Titles: text-lg font-medium (20px) - Bright cyan\n- Body Text: text-base font-normal (16px) - Bright cyan/white\n- Captions/Labels: text-sm font-medium (14px) - Cyan at 70% opacity\n- Micro-text: text-xs (12px) - Muted cyan\n\n---\n\n## Layout System\n\n**Spacing Units:** Tailwind units of 2, 4, 6, 8, 12, 16 (keeping strict rhythm)\n- Component padding: p-4, p-6\n- Section gaps: gap-4, gap-6\n- Vertical rhythm: space-y-6, space-y-8\n- Page margins: px-4, py-6\n\n**Grid System:**\n- Mobile: Single column, full-width cards with neon borders\n- Order forms: Stacked inputs with space-y-4, glowing input focus\n- Driver order list: Single column cards with neon accent borders\n- Admin panel: Single column on mobile, 2-column grid on desktop\n\n---\n\n## Component Library\n\n### Client Interface (4 Primary Actions)\n\n**Order Type Selection:**\n- 4 large tap-friendly buttons in 2x2 grid (grid-cols-2 gap-4)\n- Each button: Icon + Label, min-height h-32, rounded-xl\n- Background: Dark with neon purple/cyan border on hover\n- Text: Bright cyan\n- Active state: Neon glow effect with cyan shadow\n\n**Order Forms:**\n- Stacked vertical layout with space-y-4\n- Input fields: rounded-lg, p-4, text-base, dark gray background\n- Focus state: Neon cyan border with glow effect\n- Labels: text-sm font-medium mb-2, bright cyan\n- Required field indicator: Neon red asterisk\n- Submit button: Full-width, neon cyan, h-14, text-lg font-semibold\n- Button hover: Increased cyan glow, subtle scale effect\n\n### Driver Interface\n\n**Active Orders List:**\n- Card-based layout with neon border, dark background, p-4, space-y-3\n- Order header: Route display with arrow icon, bright cyan text\n- Order type badge: Inline rounded-full px-3 py-1, neon magenta background\n- \"Accept\" button: w-full, neon cyan, h-12, font-semibold, glowing hover state\n- Locked orders: Slightly darkened with \"Taken\" overlay badge in neon\n\n**Price Bidding Modal:**\n- Dark background with neon border\n- Large number input: text-4xl font-bold, center-aligned, cyan\n- Currency prefix: Neon magenta\n- \"Propose Price\" button: Full-width, neon cyan, h-14, rounded-lg\n\n**Driver Profile Setup:**\n- Avatar display: Circular, w-24 h-24, centered, with cyan border glow\n- Input fields: Stacked, space-y-4, dark background with neon focus\n- Save button: Sticky bottom, neon cyan\n\n### Chat Interface\n\n**Layout:**\n- Message bubbles: max-w-[80%], rounded-2xl, p-3, dark background\n- Client messages: ml-auto, neon cyan border\n- Driver messages: mr-auto, neon magenta border\n- Timestamp: text-xs, muted cyan, opacity-70, mt-1\n- Input bar: Fixed bottom, dark background, neon border\n- Rounded-full input field with neon focus glow\n\n### Admin Panel\n\n**Driver Management Cards:**\n- List view with driver avatar (w-12 h-12 rounded-full) + name/phone\n- Dark background with neon border accent\n- Action buttons row: Inline flex gap-2, neon cyan text\n- Block button: Neon red\n- Warning/Bonus buttons: Neon magenta\n- Status badges: Inline, rounded-full, px-2 py-1, neon colors\n\n**Code Generation:**\n- Single action card with neon border\n- Large \"Generate Code\" button: Neon cyan\n- Generated code display: Monospace font, text-3xl, neon green\n- Letter-spacing-wider, selectable text with cyan glow\n\n---\n\n## Navigation & Status\n\n**Role Indicator:**\n- Top bar with role badge, dark background, neon text\n- Sticky position with subtle shadow\n\n**Order Status Flow:**\n- Visual stepper with neon colors\n- Status badges: rounded-full, px-3 py-1, text-xs, uppercase\n- Colors: New (cyan), Bidding (magenta), In Progress (green), Completed (cyan)\n\n**Back/Navigation Buttons:**\n- Neon cyan color, subtle glow on hover\n- Arrow icon clearly visible\n\n---\n\n## Interactions & Feedback\n\n**Loading States:**\n- Skeleton screens: Dark animated pulses with cyan glow\n- Spinners: Neon cyan rotating animation\n\n**Notifications:**\n- Toast messages: Dark background, neon border, cyan glow\n- Fixed top-4 right-4, rounded-lg, p-4\n- Success: Neon green, Error: Neon red\n- Auto-dismiss after 4s\n\n**Empty States:**\n- Centered icon (neon cyan) + text (cyan)\n- Icon: w-16 h-16, opacity-70\n- Text: text-base, muted cyan opacity\n\n**Button States:**\n- Default: Neon cyan background, dark text\n- Hover: Intensified cyan glow, subtle scale\n- Active: Deeper glow effect\n- Disabled: Darker with reduced opacity\n\n---\n\n## Accessibility\n\n- All interactive elements: min-height h-11 (44px touch target)\n- High contrast: Neon colors on dark backgrounds ensure WCAG compliance\n- Focus states: Neon cyan ring with glow effect\n- Form validation: Error messages below inputs, neon red text\n- No gray-on-gray combinations\n\n---\n\n## Images\n\n**Avatar Images:**\n- Driver profile avatars: Auto-loaded from Telegram (circular, w-24 h-24)\n- Neon cyan border glow effect\n- Fallback: Initials on dark background with cyan border\n\n**Icons:**\n- Lucide React icons throughout\n- Color: Neon cyan for primary actions, magenta for secondary\n- Consistent sizing: w-5 h-5 for inline, w-6 h-6 for buttons\n- Glow effect on hover\n\n---\n\n## Animation & Effects\n\n**Transitions:**\n- All color transitions: 200ms ease\n- Scale effects on buttons: Subtle (0.95-1.05)\n- Glow effects: Fade in/out for smooth appearance\n\n**Neon Glow:**\n- Applied to primary buttons, focused inputs, and borders\n- Uses cyan shadow with 0.1-0.3 opacity\n- Intensity increases on hover/active states\n\n---\n\nThis dark cyberpunk noir design creates a premium, modern mobile interface optimized for quick interactions while delivering a distinctive, high-tech visual identity. The neon aesthetic ensures excellent visibility and engagement across all user roles.\n","size_bytes":7522},"client/src/components/ui/input-otp.tsx":{"content":"import * as React from \"react\"\nimport { OTPInput, OTPInputContext } from \"input-otp\"\nimport { Dot } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst InputOTP = React.forwardRef<\n  React.ElementRef<typeof OTPInput>,\n  React.ComponentPropsWithoutRef<typeof OTPInput>\n>(({ className, containerClassName, ...props }, ref) => (\n  <OTPInput\n    ref={ref}\n    containerClassName={cn(\n      \"flex items-center gap-2 has-[:disabled]:opacity-50\",\n      containerClassName\n    )}\n    className={cn(\"disabled:cursor-not-allowed\", className)}\n    {...props}\n  />\n))\nInputOTP.displayName = \"InputOTP\"\n\nconst InputOTPGroup = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"flex items-center\", className)} {...props} />\n))\nInputOTPGroup.displayName = \"InputOTPGroup\"\n\nconst InputOTPSlot = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\"> & { index: number }\n>(({ index, className, ...props }, ref) => {\n  const inputOTPContext = React.useContext(OTPInputContext)\n  const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index]\n\n  return (\n    <div\n      ref={ref}\n      className={cn(\n        \"relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md\",\n        isActive && \"z-10 ring-2 ring-ring ring-offset-background\",\n        className\n      )}\n      {...props}\n    >\n      {char}\n      {hasFakeCaret && (\n        <div className=\"pointer-events-none absolute inset-0 flex items-center justify-center\">\n          <div className=\"h-4 w-px animate-caret-blink bg-foreground duration-1000\" />\n        </div>\n      )}\n    </div>\n  )\n})\nInputOTPSlot.displayName = \"InputOTPSlot\"\n\nconst InputOTPSeparator = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ ...props }, ref) => (\n  <div ref={ref} role=\"separator\" {...props}>\n    <Dot />\n  </div>\n))\nInputOTPSeparator.displayName = \"InputOTPSeparator\"\n\nexport { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator }\n","size_bytes":2154},"client/src/index.css":{"content":"@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n/* DARK CYBERPUNK NOIR THEME */\n:root {\n  --button-outline: rgba(0, 255, 255, 0.15);\n  --badge-outline: rgba(0, 255, 255, 0.08);\n  --opaque-button-border-intensity: 15;\n  --elevate-1: rgba(0, 255, 255, 0.05);\n  --elevate-2: rgba(0, 255, 255, 0.12);\n  --background: 0 0% 4%;\n  --foreground: 180 100% 95%;\n  --border: 280 100% 30%;\n  --card: 0 0% 8%;\n  --card-foreground: 180 100% 95%;\n  --card-border: 280 100% 35%;\n  --sidebar: 0 0% 6%;\n  --sidebar-foreground: 180 100% 95%;\n  --sidebar-border: 280 100% 32%;\n  --sidebar-primary: 180 100% 50%;\n  --sidebar-primary-foreground: 0 0% 4%;\n  --sidebar-accent: 280 100% 45%;\n  --sidebar-accent-foreground: 0 0% 98%;\n  --sidebar-ring: 180 100% 50%;\n  --popover: 0 0% 10%;\n  --popover-foreground: 180 100% 95%;\n  --popover-border: 280 100% 40%;\n  --primary: 180 100% 50%;\n  --primary-foreground: 0 0% 4%;\n  --secondary: 280 100% 45%;\n  --secondary-foreground: 0 0% 98%;\n  --muted: 0 0% 20%;\n  --muted-foreground: 180 100% 70%;\n  --accent: 120 100% 50%;\n  --accent-foreground: 0 0% 4%;\n  --destructive: 0 100% 50%;\n  --destructive-foreground: 0 0% 100%;\n  --input: 0 0% 15%;\n  --ring: 180 100% 50%;\n  --chart-1: 180 100% 50%;\n  --chart-2: 280 100% 50%;\n  --chart-3: 120 100% 50%;\n  --chart-4: 40 100% 50%;\n  --chart-5: 0 100% 50%;\n  --font-sans: Inter, -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, sans-serif;\n  --font-serif: Georgia, serif;\n  --font-mono: JetBrains Mono, Menlo, monospace;\n  --radius: .5rem;\n  --shadow-2xs: 0px 2px 8px rgba(0, 255, 255, 0.1);\n  --shadow-xs: 0px 2px 12px rgba(0, 255, 255, 0.15);\n  --shadow-sm: 0px 2px 16px rgba(0, 255, 255, 0.1), 0px 1px 4px rgba(0, 255, 255, 0.05);\n  --shadow: 0px 2px 16px rgba(0, 255, 255, 0.1), 0px 1px 4px rgba(0, 255, 255, 0.05);\n  --shadow-md: 0px 4px 20px rgba(0, 255, 255, 0.15), 0px 2px 8px rgba(0, 255, 255, 0.1);\n  --shadow-lg: 0px 8px 32px rgba(0, 255, 255, 0.2), 0px 4px 12px rgba(0, 255, 255, 0.15);\n  --shadow-xl: 0px 12px 48px rgba(0, 255, 255, 0.25), 0px 8px 16px rgba(0, 255, 255, 0.2);\n  --shadow-2xl: 0px 16px 64px rgba(0, 255, 255, 0.3);\n  --tracking-normal: 0em;\n  --spacing: 0.25rem;\n\n  /* Fallback for older browsers */\n  --sidebar-primary-border: hsl(var(--sidebar-primary));\n  --sidebar-primary-border: hsl(from hsl(var(--sidebar-primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  --sidebar-accent-border: hsl(var(--sidebar-accent));\n  --sidebar-accent-border: hsl(from hsl(var(--sidebar-accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  --primary-border: hsl(var(--primary));\n  --primary-border: hsl(from hsl(var(--primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  --secondary-border: hsl(var(--secondary));\n  --secondary-border: hsl(from hsl(var(--secondary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  --muted-border: hsl(var(--muted));\n  --muted-border: hsl(from hsl(var(--muted)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  --accent-border: hsl(var(--accent));\n  --accent-border: hsl(from hsl(var(--accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  --destructive-border: hsl(var(--destructive));\n  --destructive-border: hsl(from hsl(var(--destructive)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n}\n\n.dark {\n  --button-outline: rgba(0, 255, 255, 0.15);\n  --badge-outline: rgba(0, 255, 255, 0.08);\n  --opaque-button-border-intensity: 15;\n  --elevate-1: rgba(0, 255, 255, 0.05);\n  --elevate-2: rgba(0, 255, 255, 0.12);\n  --background: 0 0% 4%;\n  --foreground: 180 100% 95%;\n  --border: 280 100% 30%;\n  --card: 0 0% 8%;\n  --card-foreground: 180 100% 95%;\n  --card-border: 280 100% 35%;\n  --sidebar: 0 0% 6%;\n  --sidebar-foreground: 180 100% 95%;\n  --sidebar-border: 280 100% 32%;\n  --sidebar-primary: 180 100% 50%;\n  --sidebar-primary-foreground: 0 0% 4%;\n  --sidebar-accent: 280 100% 45%;\n  --sidebar-accent-foreground: 0 0% 98%;\n  --sidebar-ring: 180 100% 50%;\n  --popover: 0 0% 10%;\n  --popover-foreground: 180 100% 95%;\n  --popover-border: 280 100% 40%;\n  --primary: 180 100% 50%;\n  --primary-foreground: 0 0% 4%;\n  --secondary: 280 100% 45%;\n  --secondary-foreground: 0 0% 98%;\n  --muted: 0 0% 20%;\n  --muted-foreground: 180 100% 70%;\n  --accent: 120 100% 50%;\n  --accent-foreground: 0 0% 4%;\n  --destructive: 0 100% 50%;\n  --destructive-foreground: 0 0% 100%;\n  --input: 0 0% 15%;\n  --ring: 180 100% 50%;\n  --chart-1: 180 100% 50%;\n  --chart-2: 280 100% 50%;\n  --chart-3: 120 100% 50%;\n  --chart-4: 40 100% 50%;\n  --chart-5: 0 100% 50%;\n  --shadow-2xs: 0px 2px 8px rgba(0, 255, 255, 0.1);\n  --shadow-xs: 0px 2px 12px rgba(0, 255, 255, 0.15);\n  --shadow-sm: 0px 2px 16px rgba(0, 255, 255, 0.1), 0px 1px 4px rgba(0, 255, 255, 0.05);\n  --shadow: 0px 2px 16px rgba(0, 255, 255, 0.1), 0px 1px 4px rgba(0, 255, 255, 0.05);\n  --shadow-md: 0px 4px 20px rgba(0, 255, 255, 0.15), 0px 2px 8px rgba(0, 255, 255, 0.1);\n  --shadow-lg: 0px 8px 32px rgba(0, 255, 255, 0.2), 0px 4px 12px rgba(0, 255, 255, 0.15);\n  --shadow-xl: 0px 12px 48px rgba(0, 255, 255, 0.25), 0px 8px 16px rgba(0, 255, 255, 0.2);\n  --shadow-2xl: 0px 16px 64px rgba(0, 255, 255, 0.3);\n\n  /* Fallback for older browsers */\n  --sidebar-primary-border: hsl(var(--sidebar-primary));\n  --sidebar-primary-border: hsl(from hsl(var(--sidebar-primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  --sidebar-accent-border: hsl(var(--sidebar-accent));\n  --sidebar-accent-border: hsl(from hsl(var(--sidebar-accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  --primary-border: hsl(var(--primary));\n  --primary-border: hsl(from hsl(var(--primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  --secondary-border: hsl(var(--secondary));\n  --secondary-border: hsl(from hsl(var(--secondary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  --muted-border: hsl(var(--muted));\n  --muted-border: hsl(from hsl(var(--muted)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  --accent-border: hsl(var(--accent));\n  --accent-border: hsl(from hsl(var(--accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  --destructive-border: hsl(var(--destructive));\n  --destructive-border: hsl(from hsl(var(--destructive)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n}\n\n@layer base {\n  * {\n    @apply border-border;\n  }\n\n  body {\n    @apply font-sans antialiased text-foreground;\n    background: linear-gradient(135deg, #0a0a0a 0%, #1a0a2e 25%, #0f0f1e 50%, #0a0a0a 100%);\n    min-height: 100vh;\n  }\n\n  html {\n    background: linear-gradient(135deg, #0a0a0a 0%, #1a0a2e 25%, #0f0f1e 50%, #0a0a0a 100%);\n    background-attachment: fixed;\n  }\n}\n\n@layer utilities {\n  input[type=\"search\"]::-webkit-search-cancel-button {\n    @apply hidden;\n  }\n\n  [contenteditable][data-placeholder]:empty::before {\n    content: attr(data-placeholder);\n    color: hsl(var(--muted-foreground));\n    pointer-events: none;\n  }\n\n  /* Frosted Glass Morphism Effects */\n  .glass-border {\n    border: 1px solid rgba(0, 255, 255, 0.15);\n    background: rgba(255, 255, 255, 0.03);\n    backdrop-filter: blur(8px);\n    -webkit-backdrop-filter: blur(8px);\n  }\n\n  .glass-border-hover:hover {\n    border-color: rgba(0, 255, 255, 0.25);\n    background: rgba(0, 255, 255, 0.05);\n  }\n\n  .frosted-icon {\n    color: rgba(0, 255, 255, 0.8);\n    text-shadow: 0 0 8px rgba(0, 255, 255, 0.3);\n    filter: drop-shadow(0 0 4px rgba(0, 255, 255, 0.2));\n  }\n\n  .card-glass {\n    background: rgba(10, 10, 10, 0.4);\n    border: 1px solid rgba(0, 255, 255, 0.15);\n    backdrop-filter: blur(12px);\n    -webkit-backdrop-filter: blur(12px);\n    box-shadow: 0 8px 32px rgba(0, 255, 255, 0.1);\n  }\n\n  .input-glass {\n    background: rgba(0, 0, 0, 0.3);\n    border: 1px solid rgba(0, 255, 255, 0.15);\n    backdrop-filter: blur(10px);\n    -webkit-backdrop-filter: blur(10px);\n  }\n\n  .input-glass:focus {\n    border-color: rgba(0, 255, 255, 0.3);\n    background: rgba(0, 255, 255, 0.05);\n    box-shadow: 0 0 16px rgba(0, 255, 255, 0.2);\n  }\n\n  .no-default-hover-elevate {}\n\n  .no-default-active-elevate {}\n\n  .toggle-elevate::before,\n  .toggle-elevate-2::before {\n    content: \"\";\n    pointer-events: none;\n    position: absolute;\n    inset: 0px;\n    border-radius: inherit;\n    z-index: -1;\n  }\n\n  .toggle-elevate.toggle-elevated::before {\n    background-color: var(--elevate-2);\n  }\n\n  .border.toggle-elevate::before {\n    inset: -1px;\n  }\n\n  .hover-elevate:not(.no-default-hover-elevate),\n  .active-elevate:not(.no-default-active-elevate),\n  .hover-elevate-2:not(.no-default-hover-elevate),\n  .active-elevate-2:not(.no-default-active-elevate) {\n    position: relative;\n    z-index: 0;\n  }\n\n  .hover-elevate:not(.no-default-hover-elevate)::after,\n  .active-elevate:not(.no-default-active-elevate)::after,\n  .hover-elevate-2:not(.no-default-hover-elevate)::after,\n  .active-elevate-2:not(.no-default-active-elevate)::after {\n    content: \"\";\n    pointer-events: none;\n    position: absolute;\n    inset: 0px;\n    border-radius: inherit;\n    z-index: 999;\n  }\n\n  .hover-elevate:hover:not(.no-default-hover-elevate)::after,\n  .active-elevate:active:not(.no-default-active-elevate)::after {\n    background-color: var(--elevate-1);\n  }\n\n  .hover-elevate-2:hover:not(.no-default-hover-elevate)::after,\n  .active-elevate-2:active:not(.no-default-active-elevate)::after {\n    background-color: var(--elevate-2);\n  }\n\n  .border.hover-elevate:not(.no-hover-interaction-elevate)::after,\n  .border.active-elevate:not(.no-active-interaction-elevate)::after,\n  .border.hover-elevate-2:not(.no-hover-interaction-elevate)::after,\n  .border.active-elevate-2:not(.no-active-interaction-elevate)::after,\n  .border.hover-elevate:not(.no-hover-interaction-elevate)::after {\n    inset: -1px;\n  }\n}\n","size_bytes":9829},"client/src/components/ui/collapsible.tsx":{"content":"\"use client\"\n\nimport * as CollapsiblePrimitive from \"@radix-ui/react-collapsible\"\n\nconst Collapsible = CollapsiblePrimitive.Root\n\nconst CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger\n\nconst CollapsibleContent = CollapsiblePrimitive.CollapsibleContent\n\nexport { Collapsible, CollapsibleTrigger, CollapsibleContent }\n","size_bytes":329},"client/src/pages/client-home.tsx":{"content":"import { useState } from \"react\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Progress } from \"@/components/ui/progress\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { \n  Car, \n  Truck, \n  Package, \n  Unplug, \n  Clock, \n  User, \n  MessageSquare, \n  Star,\n  MapPin,\n  DollarSign\n} from \"lucide-react\";\nimport { useLocation } from \"wouter\";\nimport { useQuery, useQueryClient } from \"@tanstack/react-query\";\nimport { useUser } from \"@/lib/use-user\";\nimport { RatingDialog } from \"@/components/rating-dialog\";\nimport type { Order } from \"@shared/schema\";\n\nexport default function ClientHome() {\n  const [, setLocation] = useLocation();\n  const { userId } = useUser();\n  const queryClient = useQueryClient();\n  const [ratingDialog, setRatingDialog] = useState<{\n    open: boolean;\n    orderId: string;\n    driverName?: string;\n  }>({ open: false, orderId: \"\" });\n\n  const { data: orders = [], isLoading } = useQuery<Order[]>({\n    queryKey: [\"/api/orders/client\", userId],\n    queryFn: async () => {\n      const res = await fetch(`/api/orders/client/${userId}`);\n      if (!res.ok) throw new Error(\"Failed to fetch orders\");\n      return res.json();\n    },\n    enabled: !!userId,\n  });\n\n  const orderTypes = [\n    {\n      type: \"taxi\" as const,\n      icon: Car,\n      label: \"Таксі\",\n      description: \"Поїздки по місту\",\n      color: \"bg-primary text-primary-foreground\",\n    },\n    {\n      type: \"cargo\" as const,\n      icon: Truck,\n      label: \"Вантажне\",\n      description: \"Перевезення вантажу\",\n      color: \"bg-primary text-primary-foreground\",\n    },\n    {\n      type: \"courier\" as const,\n      icon: Package,\n      label: \"Кур'єр\",\n      description: \"Доставка посилок\",\n      color: \"bg-primary text-primary-foreground\",\n    },\n    {\n      type: \"towing\" as const,\n      icon: Unplug,\n      label: \"Евакуатор\",\n      description: \"Буксирування авто\",\n      color: \"bg-primary text-primary-foreground\",\n    },\n  ];\n\n  const getOrderTypeLabel = (type: string) => {\n    const orderType = orderTypes.find(ot => ot.type === type);\n    return orderType?.label || type;\n  };\n\n  const getOrderTypeIcon = (type: string) => {\n    const orderType = orderTypes.find(ot => ot.type === type);\n    return orderType?.icon || Car;\n  };\n\n  const getStatusBadge = (status: string) => {\n    const statusConfig = {\n      pending: { label: \"Очікування\", variant: \"secondary\" as const },\n      accepted: { label: \"Прийнято\", variant: \"default\" as const },\n      in_progress: { label: \"В дорозі\", variant: \"default\" as const },\n      completed: { label: \"Завершено\", variant: \"outline\" as const },\n      cancelled: { label: \"Скасовано\", variant: \"destructive\" as const },\n    };\n    \n    const config = statusConfig[status as keyof typeof statusConfig] || statusConfig.pending;\n    return <Badge variant={config.variant}>{config.label}</Badge>;\n  };\n\n  const handleRateDriver = (orderId: string, driverName?: string) => {\n    setRatingDialog({ open: true, orderId, driverName });\n  };\n\n  const handleRatingSuccess = () => {\n    queryClient.invalidateQueries({ queryKey: [\"/api/orders/client\", userId] });\n  };\n\n  const activeOrders = orders.filter(o => \n    o.status === \"pending\" || o.status === \"accepted\" || o.status === \"in_progress\"\n  );\n  \n  const completedOrders = orders.filter(o => \n    o.status === \"completed\" || o.status === \"cancelled\"\n  );\n\n  return (\n    <div className=\"min-h-screen bg-background p-4\">\n      <div className=\"max-w-2xl mx-auto space-y-6\">\n        <div className=\"text-center space-y-2 py-6\">\n          <h1 className=\"text-2xl font-bold text-foreground\">Мої замовлення</h1>\n          <p className=\"text-sm text-muted-foreground\">Керуйте вашими поїздками</p>\n        </div>\n\n        {/* Create New Order Section */}\n        <Card>\n          <CardHeader>\n            <CardTitle className=\"text-lg\">Створити нове замовлення</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <div className=\"grid grid-cols-2 gap-3\">\n              {orderTypes.map((item) => {\n                const Icon = item.icon;\n                return (\n                  <Button\n                    key={item.type}\n                    variant=\"outline\"\n                    className=\"h-auto p-4 flex flex-col items-center gap-2\"\n                    onClick={() => setLocation(`/order/${item.type}`)}\n                  >\n                    <div className={`${item.color} rounded-lg p-2`}>\n                      <Icon className=\"w-6 h-6\" />\n                    </div>\n                    <div className=\"text-center\">\n                      <div className=\"font-semibold text-sm\">{item.label}</div>\n                      <div className=\"text-xs text-muted-foreground\">{item.description}</div>\n                    </div>\n                  </Button>\n                );\n              })}\n            </div>\n          </CardContent>\n        </Card>\n\n        {isLoading ? (\n          <Card>\n            <CardContent className=\"py-8\">\n              <div className=\"text-center text-muted-foreground\">\n                Завантаження замовлень...\n              </div>\n            </CardContent>\n          </Card>\n        ) : (\n          <>\n            {/* Active Orders */}\n            {activeOrders.length > 0 && (\n              <div className=\"space-y-3\">\n                <h2 className=\"text-lg font-semibold\">Активні замовлення</h2>\n                {activeOrders.map((order) => {\n                  const Icon = getOrderTypeIcon(order.type);\n                  \n                  return (\n                    <Card key={order.orderId}>\n                      <CardContent className=\"p-4 space-y-3\">\n                        <div className=\"flex items-start justify-between\">\n                          <div className=\"flex items-center gap-3\">\n                            <div className=\"bg-primary/10 rounded-lg p-2\">\n                              <Icon className=\"w-5 h-5 text-primary\" />\n                            </div>\n                            <div>\n                              <div className=\"font-semibold\">{getOrderTypeLabel(order.type)}</div>\n                              <div className=\"text-xs text-muted-foreground\">\n                                {new Date(order.createdAt!).toLocaleString('uk-UA', {\n                                  day: '2-digit',\n                                  month: '2-digit',\n                                  year: 'numeric',\n                                  hour: '2-digit',\n                                  minute: '2-digit'\n                                })}\n                              </div>\n                            </div>\n                          </div>\n                          {getStatusBadge(order.status)}\n                        </div>\n\n                        <Separator />\n\n                        <div className=\"space-y-2\">\n                          <div className=\"flex items-start gap-2 text-sm\">\n                            <MapPin className=\"w-4 h-4 text-green-600 mt-0.5 flex-shrink-0\" />\n                            <div>\n                              <div className=\"font-medium\">Звідки:</div>\n                              <div className=\"text-muted-foreground\">{order.from}</div>\n                            </div>\n                          </div>\n                          <div className=\"flex items-start gap-2 text-sm\">\n                            <MapPin className=\"w-4 h-4 text-red-600 mt-0.5 flex-shrink-0\" />\n                            <div>\n                              <div className=\"font-medium\">Куди:</div>\n                              <div className=\"text-muted-foreground\">{order.to}</div>\n                            </div>\n                          </div>\n                        </div>\n\n                        {order.price && (\n                          <div className=\"flex items-center gap-2 text-sm\">\n                            <DollarSign className=\"w-4 h-4 text-muted-foreground\" />\n                            <span className=\"font-semibold\">{order.price} грн</span>\n                            {order.distanceKm && (\n                              <span className=\"text-muted-foreground\">\n                                • {order.distanceKm.toFixed(1)} км\n                              </span>\n                            )}\n                          </div>\n                        )}\n\n                        <Separator />\n\n                        {/* Status-specific UI */}\n                        {order.status === \"pending\" && (\n                          <div className=\"flex items-center gap-2 text-amber-600 bg-amber-50 dark:bg-amber-950/20 p-3 rounded-lg\">\n                            <Clock className=\"w-5 h-5 animate-pulse\" />\n                            <span className=\"text-sm font-medium\">Очікування водія...</span>\n                          </div>\n                        )}\n\n                        {order.status === \"accepted\" && (\n                          <div className=\"space-y-3\">\n                            <div className=\"flex items-center gap-2 text-sm bg-primary/10 p-3 rounded-lg\">\n                              <User className=\"w-5 h-5 text-primary\" />\n                              <div>\n                                <div className=\"font-medium\">Водій знайдено</div>\n                                <div className=\"text-xs text-muted-foreground\">\n                                  Очікуйте на підтвердження початку поїздки\n                                </div>\n                              </div>\n                            </div>\n                            <Button\n                              className=\"w-full\"\n                              onClick={() => setLocation(`/chat/${order.orderId}`)}\n                            >\n                              <MessageSquare className=\"w-4 h-4 mr-2\" />\n                              Перейти до чату\n                            </Button>\n                          </div>\n                        )}\n\n                        {order.status === \"in_progress\" && (\n                          <div className=\"space-y-3\">\n                            <div className=\"space-y-2\">\n                              <div className=\"flex items-center justify-between text-sm\">\n                                <span className=\"font-medium\">Виконується поїздка</span>\n                                <span className=\"text-muted-foreground\">В дорозі...</span>\n                              </div>\n                              <Progress value={66} className=\"h-2\" />\n                            </div>\n                            <Button\n                              className=\"w-full\"\n                              variant=\"outline\"\n                              onClick={() => setLocation(`/chat/${order.orderId}`)}\n                            >\n                              <MessageSquare className=\"w-4 h-4 mr-2\" />\n                              Перейти до чату\n                            </Button>\n                          </div>\n                        )}\n                      </CardContent>\n                    </Card>\n                  );\n                })}\n              </div>\n            )}\n\n            {/* Completed Orders */}\n            {completedOrders.length > 0 && (\n              <div className=\"space-y-3\">\n                <h2 className=\"text-lg font-semibold\">Завершені замовлення</h2>\n                {completedOrders.slice(0, 5).map((order) => {\n                  const Icon = getOrderTypeIcon(order.type);\n                  \n                  return (\n                    <Card key={order.orderId} className=\"opacity-75\">\n                      <CardContent className=\"p-4 space-y-3\">\n                        <div className=\"flex items-start justify-between\">\n                          <div className=\"flex items-center gap-3\">\n                            <div className=\"bg-muted rounded-lg p-2\">\n                              <Icon className=\"w-5 h-5 text-muted-foreground\" />\n                            </div>\n                            <div>\n                              <div className=\"font-semibold\">{getOrderTypeLabel(order.type)}</div>\n                              <div className=\"text-xs text-muted-foreground\">\n                                {new Date(order.createdAt!).toLocaleString('uk-UA', {\n                                  day: '2-digit',\n                                  month: '2-digit',\n                                  year: 'numeric',\n                                  hour: '2-digit',\n                                  minute: '2-digit'\n                                })}\n                              </div>\n                            </div>\n                          </div>\n                          {getStatusBadge(order.status)}\n                        </div>\n\n                        <div className=\"flex items-center justify-between text-sm\">\n                          <div className=\"text-muted-foreground\">\n                            {order.from} → {order.to}\n                          </div>\n                          {order.price && (\n                            <div className=\"font-semibold\">{order.price} грн</div>\n                          )}\n                        </div>\n\n                        {order.status === \"completed\" && (\n                          <Button\n                            className=\"w-full\"\n                            variant=\"outline\"\n                            onClick={() => handleRateDriver(order.orderId, \"водія\")}\n                          >\n                            <Star className=\"w-4 h-4 mr-2\" />\n                            Оцінити водія\n                          </Button>\n                        )}\n                      </CardContent>\n                    </Card>\n                  );\n                })}\n              </div>\n            )}\n\n            {/* Empty State */}\n            {activeOrders.length === 0 && completedOrders.length === 0 && (\n              <Card>\n                <CardContent className=\"py-12 text-center\">\n                  <div className=\"text-muted-foreground space-y-2\">\n                    <p className=\"text-lg font-medium\">У вас ще немає замовлень</p>\n                    <p className=\"text-sm\">Створіть своє перше замовлення вище</p>\n                  </div>\n                </CardContent>\n              </Card>\n            )}\n          </>\n        )}\n      </div>\n\n      <RatingDialog\n        open={ratingDialog.open}\n        onOpenChange={(open) => setRatingDialog({ ...ratingDialog, open })}\n        orderId={ratingDialog.orderId}\n        driverName={ratingDialog.driverName}\n        onSuccess={handleRatingSuccess}\n      />\n    </div>\n  );\n}\n","size_bytes":15174},"client/src/components/ui/scroll-area.tsx":{"content":"import * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ScrollArea = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <ScrollAreaPrimitive.Root\n    ref={ref}\n    className={cn(\"relative overflow-hidden\", className)}\n    {...props}\n  >\n    <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n      {children}\n    </ScrollAreaPrimitive.Viewport>\n    <ScrollBar />\n    <ScrollAreaPrimitive.Corner />\n  </ScrollAreaPrimitive.Root>\n))\nScrollArea.displayName = ScrollAreaPrimitive.Root.displayName\n\nconst ScrollBar = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>\n>(({ className, orientation = \"vertical\", ...props }, ref) => (\n  <ScrollAreaPrimitive.ScrollAreaScrollbar\n    ref={ref}\n    orientation={orientation}\n    className={cn(\n      \"flex touch-none select-none transition-colors\",\n      orientation === \"vertical\" &&\n        \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n      orientation === \"horizontal\" &&\n        \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n      className\n    )}\n    {...props}\n  >\n    <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\n  </ScrollAreaPrimitive.ScrollAreaScrollbar>\n))\nScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName\n\nexport { ScrollArea, ScrollBar }\n","size_bytes":1642},"3123-main/server/index-dev.ts":{"content":"import fs from \"node:fs\";\nimport path from \"node:path\";\nimport { type Server } from \"node:http\";\n\nimport { nanoid } from \"nanoid\";\nimport { type Express } from \"express\";\nimport { createServer as createViteServer, createLogger } from \"vite\";\n\nimport viteConfig from \"../vite.config\";\nimport runApp from \"./app\";\n\nexport async function setupVite(app: Express, server: Server) {\n  const viteLogger = createLogger();\n  const serverOptions = {\n    middlewareMode: true,\n    hmr: { server },\n    allowedHosts: true as const,\n  };\n\n  const vite = await createViteServer({\n    ...viteConfig,\n    configFile: false,\n    customLogger: {\n      ...viteLogger,\n      error: (msg, options) => {\n        viteLogger.error(msg, options);\n        process.exit(1);\n      },\n    },\n    server: serverOptions,\n    appType: \"custom\",\n  });\n\n  app.use(vite.middlewares);\n  app.use(\"*\", async (req, res, next) => {\n    const url = req.originalUrl;\n\n    try {\n      const clientTemplate = path.resolve(\n        import.meta.dirname,\n        \"..\",\n        \"client\",\n        \"index.html\",\n      );\n\n      // always reload the index.html file from disk incase it changes\n      let template = await fs.promises.readFile(clientTemplate, \"utf-8\");\n      template = template.replace(\n        `src=\"/src/main.tsx\"`,\n        `src=\"/src/main.tsx?v=${nanoid()}\"`,\n      );\n      const page = await vite.transformIndexHtml(url, template);\n      res.status(200).set({ \"Content-Type\": \"text/html\" }).end(page);\n    } catch (e) {\n      vite.ssrFixStacktrace(e as Error);\n      next(e);\n    }\n  });\n}\n\n(async () => {\n  await runApp(setupVite);\n})();\n","size_bytes":1609},"server/telegram-bot.ts":{"content":"import TelegramBot from 'node-telegram-bot-api';\nimport type { IStorage } from './storage';\nimport type { User, Order } from '@shared/schema';\n\nconst ADMIN_ID = process.env.ADMIN_ID || '7677921905';\nconst WEB_APP_URL = process.env.WEB_APP_URL || process.env.REPL_SLUG \n  ? `https://${process.env.REPL_SLUG}.${process.env.REPL_OWNER}.repl.co`\n  : `http://localhost:${process.env.PORT || 5000}`;\n\ninterface DriverStats {\n  completedOrders: number;\n  totalRatings: number;\n  averageRating: string;\n  earnings: number;\n}\n\n/**\n * Ініціалізує Telegram бота з обробниками команд\n * @param storage - Storage для роботи з даними\n * @returns TelegramBot instance або null якщо токен не встановлено\n */\nexport function initTelegramBot(storage: IStorage) {\n  const TOKEN = process.env.TELEGRAM_BOT_TOKEN;\n  \n  if (!TOKEN) {\n    console.log('⚠️  TELEGRAM_BOT_TOKEN not set. Bot features disabled.');\n    return null;\n  }\n\n  const bot = new TelegramBot(TOKEN, { polling: true });\n  console.log('✅ Telegram bot initialized successfully');\n\n  // --- HELPER FUNCTIONS ---\n\n  /**\n   * Отримує або створює користувача\n   */\n  async function getOrCreateUser(userId: string, username?: string): Promise<User> {\n    let user = await storage.getUser(userId);\n    \n    if (!user) {\n      const role = String(userId) === String(ADMIN_ID) ? 'admin' : 'client';\n      user = await storage.createUser({\n        id: userId,\n        role: role as 'client' | 'driver' | 'admin',\n        name: username || null,\n        phone: null,\n        telegramAvatarUrl: null,\n      });\n    }\n    \n    // Переконуємось, що ADMIN_ID завжди має роль admin\n    if (String(userId) === String(ADMIN_ID) && user.role !== 'admin') {\n      user = await storage.updateUser(userId, { role: 'admin' }) || user;\n    }\n    \n    return user;\n  }\n\n  /**\n   * Отримує список всіх водіїв\n   */\n  async function getAllDriversList(): Promise<string> {\n    const drivers = await storage.getAllDrivers();\n    const admins = await Promise.all(\n      [ADMIN_ID].map(id => storage.getUser(String(id)))\n    );\n    \n    const allDrivers = [\n      ...drivers.map(d => ({ ...d, isAdmin: false })),\n      ...admins.filter(Boolean).map(a => ({ ...a, isAdmin: true }))\n    ].filter((d, i, arr) => arr.findIndex(x => x!.id === d!.id) === i);\n    \n    if (allDrivers.length === 0) {\n      return '';\n    }\n    \n    return allDrivers\n      .map(driver => {\n        const roleLabel = driver!.isAdmin ? '👑' : '🚖';\n        const name = driver!.name || 'Без імені';\n        return `${roleLabel} 🆔 <code>${driver!.id}</code> — ${name}`;\n      })\n      .join('\\n');\n  }\n\n  /**\n   * Отримує статистику водія\n   */\n  async function getDriverStats(driverId: string): Promise<DriverStats> {\n    const stats = await storage.getDriverStats(driverId);\n    const orders = await storage.getOrdersByDriver(driverId);\n    const completedOrders = orders.filter(o => o.status === 'completed');\n    const earnings = completedOrders.reduce((sum, o) => sum + (o.price || 0), 0);\n    \n    return {\n      completedOrders: stats.completedOrders,\n      totalRatings: stats.totalRatings,\n      averageRating: stats.totalRatings > 0 ? stats.averageRating.toFixed(1) : 'N/A',\n      earnings\n    };\n  }\n\n  /**\n   * Отримує статистику адміністратора\n   */\n  async function getAdminStats() {\n    const allOrders = await storage.getAllOrders();\n    const drivers = await storage.getAllDrivers();\n    \n    const completedOrders = allOrders.filter(o => o.status === 'completed');\n    const pendingOrders = allOrders.filter(o => o.status === 'pending');\n    \n    // Підрахунок середнього рейтингу по всіх водіях\n    let totalRatings = 0;\n    let sumRatings = 0;\n    for (const driver of drivers) {\n      const stats = await storage.getDriverStats(driver.id);\n      totalRatings += stats.totalRatings;\n      sumRatings += stats.averageRating * stats.totalRatings;\n    }\n    const averageRating = totalRatings > 0 ? sumRatings / totalRatings : 0;\n    \n    return {\n      totalOrders: allOrders.length,\n      completedOrders: completedOrders.length,\n      activeDrivers: drivers.length,\n      pendingOrders: pendingOrders.length,\n      averageRating: totalRatings > 0 ? averageRating.toFixed(1) : 'N/A'\n    };\n  }\n\n  /**\n   * Генерує код водія\n   */\n  function generateDriverCode(): string {\n    const chars = 'ABCDEFGHJKLMNPQRSTUVWXYZ23456789';\n    let code = '';\n    for (let i = 0; i < 8; i++) {\n      code += chars.charAt(Math.floor(Math.random() * chars.length));\n    }\n    return code;\n  }\n\n  /**\n   * Створює новий код водія\n   */\n  async function createDriverCode(adminId: string): Promise<string> {\n    let code: string;\n    let attempts = 0;\n    \n    do {\n      code = generateDriverCode();\n      const existing = await storage.validateAccessCode(code);\n      if (!existing) break;\n      attempts++;\n    } while (attempts < 10);\n    \n    const accessCode = await storage.generateAccessCode(adminId);\n    return accessCode.code;\n  }\n\n  /**\n   * Отримує список невикористаних кодів\n   */\n  async function getUnusedCodes(): Promise<string[]> {\n    // Потрібно додати метод в storage для отримання всіх кодів\n    // Поки що повертаємо порожній масив\n    return [];\n  }\n\n  /**\n   * Перевіряє чи користувач є адміном\n   */\n  function isAdmin(userId: number | string): boolean {\n    return String(userId) === String(ADMIN_ID);\n  }\n\n  // --- КОМАНДИ БОТА ---\n\n  /**\n   * Команда /start - головне меню\n   */\n  bot.onText(/\\/start/, async (msg) => {\n    const userId = String(msg.from!.id);\n    const user = await getOrCreateUser(userId, msg.from!.first_name);\n    const firstName = user.name || msg.from!.first_name || 'друже';\n    \n    let text = '';\n    let keyboard: TelegramBot.KeyboardButton[][] = [];\n\n    if (user.role === 'admin') {\n      text = `Вітаю, ${firstName}! 👑\\n\\nВи Адміністратор і Водій.\\n\\n<b>Команди:</b>\\n/generate - Згенерувати коди\\n/codes - Невикористані коди\\n/drivers - Список водіїв\\n/stats - Статистика\\n/setname ID ІМ'Я - Змінити ім'я`;\n      keyboard = [\n        [{ text: '💼 Я водій', web_app: { url: WEB_APP_URL + '/driver.html' } }],\n        [{ text: '🙋‍♂️ Я клієнт', web_app: { url: WEB_APP_URL + '/client.html' } }],\n        [{ text: '📊 Панель адміна', web_app: { url: WEB_APP_URL + '/admin.html' } }]\n      ];\n    } else if (user.role === 'driver') {\n      text = `Привіт, ${firstName}! 🚖\\n\\nВи водій. Приймайте замовлення та заробляйте!`;\n      keyboard = [\n        [{ text: '💼 Приймати замовлення', web_app: { url: WEB_APP_URL + '/driver.html' } }],\n        [{ text: '🙋‍♂️ Замовити для себе', web_app: { url: WEB_APP_URL + '/client.html' } }]\n      ];\n    } else {\n      text = `Вітаємо, ${firstName}! 🎉\\n\\n🚖 Швидко, зручно, надійно!\\n\\nДля реєстрації як водій - введіть код доступу (8 символів).`;\n      keyboard = [[{ text: '📱 Замовити послугу', web_app: { url: WEB_APP_URL + '/client.html' } }]];\n    }\n    \n    await bot.sendMessage(msg.chat.id, text, { \n      parse_mode: 'HTML',\n      reply_markup: { keyboard, resize_keyboard: true }\n    });\n  });\n\n  /**\n   * Команда /stats - статистика (тільки для адмінів)\n   */\n  bot.onText(/\\/stats/, async (msg) => {\n    if (!isAdmin(msg.from!.id)) {\n      await bot.sendMessage(msg.chat.id, '❌ Ця команда доступна тільки для адміністраторів');\n      return;\n    }\n    \n    const stats = await getAdminStats();\n    const text = `📊 <b>Статистика:</b>\\n\\nВсього замовлень: ${stats.totalOrders}\\nЗавершено: ${stats.completedOrders}\\nОчікують: ${stats.pendingOrders}\\nАктивних водіїв: ${stats.activeDrivers}\\nСередній рейтинг: ${stats.averageRating}`;\n    \n    await bot.sendMessage(msg.chat.id, text, { parse_mode: 'HTML' });\n  });\n\n  /**\n   * Команда /drivers - список водіїв (тільки для адмінів)\n   */\n  bot.onText(/\\/drivers/, async (msg) => {\n    if (!isAdmin(msg.from!.id)) {\n      await bot.sendMessage(msg.chat.id, '❌ Ця команда доступна тільки для адміністраторів');\n      return;\n    }\n    \n    const list = await getAllDriversList();\n    const text = list ? `📋 <b>Водії:</b>\\n\\n${list}` : '📋 Водіїв немає';\n    \n    await bot.sendMessage(msg.chat.id, text, { parse_mode: 'HTML' });\n  });\n\n  /**\n   * Команда /setname ID ІМ'Я - змінити ім'я водія (тільки для адмінів)\n   */\n  bot.onText(/\\/setname (\\S+) (.+)/, async (msg, match) => {\n    if (!isAdmin(msg.from!.id)) {\n      await bot.sendMessage(msg.chat.id, '❌ Ця команда доступна тільки для адміністраторів');\n      return;\n    }\n    \n    if (!match) return;\n    \n    const targetId = match[1];\n    const newName = match[2];\n    \n    const updated = await storage.updateUser(targetId, { name: newName });\n    \n    if (updated) {\n      await bot.sendMessage(msg.chat.id, `✅ Ім'я змінено на: <b>${newName}</b>`, { parse_mode: 'HTML' });\n    } else {\n      await bot.sendMessage(msg.chat.id, '❌ Користувача не знайдено', { parse_mode: 'HTML' });\n    }\n  });\n\n  /**\n   * Команда /generate [count] - згенерувати коди водіїв (тільки для адмінів)\n   */\n  bot.onText(/\\/generate(?:\\s+(\\d+))?/, async (msg, match) => {\n    if (!isAdmin(msg.from!.id)) {\n      await bot.sendMessage(msg.chat.id, '❌ Ця команда доступна тільки для адміністраторів');\n      return;\n    }\n    \n    const count = Math.min(10, Math.max(1, parseInt(match?.[1] || '1')));\n    const adminId = String(msg.from!.id);\n    \n    const codes: string[] = [];\n    for (let i = 0; i < count; i++) {\n      const code = await createDriverCode(adminId);\n      codes.push(code);\n    }\n    \n    const codesList = codes.map(c => `<code>${c}</code>`).join('\\n');\n    await bot.sendMessage(msg.chat.id, `✅ <b>Коди (${count}):</b>\\n\\n${codesList}`, { parse_mode: 'HTML' });\n  });\n\n  /**\n   * Команда /codes - показати невикористані коди (тільки для адмінів)\n   */\n  bot.onText(/\\/codes/, async (msg) => {\n    if (!isAdmin(msg.from!.id)) {\n      await bot.sendMessage(msg.chat.id, '❌ Ця команда доступна тільки для адміністраторів');\n      return;\n    }\n    \n    const unused = await getUnusedCodes();\n    \n    if (unused.length === 0) {\n      await bot.sendMessage(msg.chat.id, '📋 Немає доступних кодів.\\n\\nВикористайте /generate для створення нових кодів.', { parse_mode: 'HTML' });\n      return;\n    }\n    \n    const list = unused.map(c => `🎫 <code>${c}</code>`).join('\\n');\n    await bot.sendMessage(msg.chat.id, `📋 <b>Коди (${unused.length}):</b>\\n\\n${list}`, { parse_mode: 'HTML' });\n  });\n\n  /**\n   * Обробка callback_query - схвалення/відхилення водіїв\n   */\n  bot.on('callback_query', async (query) => {\n    if (!isAdmin(query.from.id)) {\n      await bot.answerCallbackQuery(query.id, { text: '❌ Недостатньо прав' });\n      return;\n    }\n    \n    const data = query.data;\n    if (!data) return;\n    \n    const [action, targetId] = data.split('_');\n    \n    if (action === 'approve') {\n      await storage.updateUser(targetId, { role: 'driver' });\n      await bot.sendMessage(parseInt(targetId), '✅ Схвалено! Ви тепер водій. Використовуйте /start для доступу до панелі водія.');\n      await bot.answerCallbackQuery(query.id, { text: '✅ Водія схвалено' });\n    } else if (action === 'reject') {\n      await storage.updateUser(targetId, { role: 'client' });\n      await bot.sendMessage(parseInt(targetId), '❌ Заявку відхилено. Ви залишаєтесь клієнтом.');\n      await bot.answerCallbackQuery(query.id, { text: '❌ Заявку відхилено' });\n    }\n  });\n\n  /**\n   * Обробка звичайних повідомлень - перевірка кодів водіїв\n   */\n  bot.on('message', async (msg) => {\n    // Пропускаємо команди\n    if (msg.text && msg.text.startsWith('/')) return;\n    \n    const senderId = String(msg.from!.id);\n    const messageText = msg.text;\n    \n    // Перевірка чи це код водія (8 символів, букви та цифри)\n    if (messageText && messageText.length === 8 && /^[A-Z0-9]+$/i.test(messageText)) {\n      const user = await getOrCreateUser(senderId, msg.from!.first_name);\n      \n      // Тільки клієнти можуть використовувати коди\n      if (user.role !== 'client') {\n        return;\n      }\n      \n      const codeUpper = messageText.toUpperCase();\n      const validation = await storage.validateAccessCode(codeUpper);\n      \n      if (!validation || validation.isUsed) {\n        await bot.sendMessage(msg.chat.id, '❌ Невірний або вже використаний код!', { parse_mode: 'HTML' });\n        return;\n      }\n      \n      // Відправляємо запит адміну на схвалення\n      const firstName = msg.from!.first_name || 'Користувач';\n      await bot.sendMessage(msg.chat.id, '✅ Код підтверджено! Очікуйте підтвердження адміністратора.', { parse_mode: 'HTML' });\n      \n      await bot.sendMessage(parseInt(ADMIN_ID), `🔔 <b>Нова заявка на роль водія:</b>\\n\\n👤 ${firstName}\\n🆔 <code>${senderId}</code>\\n🎫 Код: <code>${codeUpper}</code>`, {\n        parse_mode: 'HTML',\n        reply_markup: { \n          inline_keyboard: [[\n            { text: '✅ Схвалити', callback_data: `approve_${senderId}` },\n            { text: '❌ Відхилити', callback_data: `reject_${senderId}` }\n          ]] \n        }\n      });\n      \n      // Позначаємо код як використаний\n      await storage.markCodeAsUsed(codeUpper, senderId);\n    }\n  });\n\n  // Обробка помилок\n  bot.on('polling_error', (error) => {\n    console.error('Telegram bot polling error:', error);\n  });\n\n  return bot;\n}\n","size_bytes":15069},"shared/tariffs.ts":{"content":"export interface Tariff {\n  basePrice: number;\n  perKm: number;\n  name: string;\n}\n\nexport type TariffKey = 'Таксі 🚕' | 'Вантажний 🚚' | 'Кур\\'єр 📦' | 'Буксир 🪝';\n\nexport const TARIFFS: Record<TariffKey, Tariff> = {\n  'Таксі 🚕': { basePrice: 50, perKm: 15, name: 'Таксі' },\n  'Вантажний 🚚': { basePrice: 100, perKm: 25, name: 'Вантаж' },\n  'Кур\\'єр 📦': { basePrice: 80, perKm: 20, name: 'Кур\\'єр' },\n  'Буксир 🪝': { basePrice: 200, perKm: 30, name: 'Буксир' }\n};\n\nexport function calculatePrice(tariffKey: TariffKey, distanceKm: number): number {\n  const tariff = TARIFFS[tariffKey];\n  return Math.ceil(tariff.basePrice + tariff.perKm * distanceKm);\n}\n","size_bytes":746},"server/middleware/rate-limit.ts":{"content":"import type { Request, Response, NextFunction } from \"express\";\n\nconst RATE_LIMIT_WINDOW = 60000; // 1 minute\nconst MAX_ORDERS_PER_MINUTE = 5;\n\nexport const rateLimiter = new Map<string, number[]>();\n\nexport function checkRateLimit(userId: string): { allowed: boolean; message?: string } {\n  const now = Date.now();\n\n  if (!rateLimiter.has(userId)) {\n    rateLimiter.set(userId, []);\n  }\n\n  const userTimestamps = rateLimiter.get(userId)!;\n\n  // Очищаємо старі записи (старші за 1 хвилину)\n  const validTimestamps = userTimestamps.filter(\n    (timestamp) => now - timestamp < RATE_LIMIT_WINDOW\n  );\n  rateLimiter.set(userId, validTimestamps);\n\n  // Перевіряємо ліміт\n  if (validTimestamps.length >= MAX_ORDERS_PER_MINUTE) {\n    return {\n      allowed: false,\n      message: \"⏱️ Забагато замовлень! Спробуйте через хвилину.\",\n    };\n  }\n\n  // Додаємо новий timestamp\n  validTimestamps.push(now);\n  rateLimiter.set(userId, validTimestamps);\n\n  return { allowed: true };\n}\n\nconst ADMIN_IDS = [\"admin1\", \"7677921905\"];\n\nexport function rateLimitMiddleware(\n  req: Request,\n  res: Response,\n  next: NextFunction\n): void {\n  const internalRequest = req.headers[\"x-internal-request\"];\n  if (internalRequest) {\n    next();\n    return;\n  }\n\n  // Перевірка наявності body перед доступом до його властивостей\n  if (!req.body || typeof req.body !== 'object') {\n    next();\n    return;\n  }\n\n  const userId = req.body.clientId || req.body.userId;\n\n  if (!userId) {\n    next();\n    return;\n  }\n\n  if (ADMIN_IDS.includes(userId)) {\n    next();\n    return;\n  }\n\n  const rateCheck = checkRateLimit(userId);\n\n  if (!rateCheck.allowed) {\n    res.status(429).json({ error: rateCheck.message });\n    return;\n  }\n\n  next();\n}\n\nexport function getRateLimitInfo(userId: string): {\n  requestsInWindow: number;\n  remaining: number;\n  resetsIn: number;\n} {\n  const now = Date.now();\n  const userTimestamps = rateLimiter.get(userId) || [];\n  const validTimestamps = userTimestamps.filter(\n    (timestamp) => now - timestamp < RATE_LIMIT_WINDOW\n  );\n\n  const remaining = Math.max(0, MAX_ORDERS_PER_MINUTE - validTimestamps.length);\n  const oldestTimestamp = validTimestamps[0];\n  const resetsIn = oldestTimestamp\n    ? Math.ceil((oldestTimestamp + RATE_LIMIT_WINDOW - now) / 1000)\n    : 0;\n\n  return {\n    requestsInWindow: validTimestamps.length,\n    remaining,\n    resetsIn,\n  };\n}\n","size_bytes":2507},"client/src/components/rating-dialog.tsx":{"content":"import { useState } from \"react\";\nimport { Star } from \"lucide-react\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { useMutation } from \"@tanstack/react-query\";\n\ninterface RatingDialogProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  orderId: string;\n  driverName?: string;\n  onSuccess?: () => void;\n}\n\nexport function RatingDialog({\n  open,\n  onOpenChange,\n  orderId,\n  driverName = \"водія\",\n  onSuccess,\n}: RatingDialogProps) {\n  const [stars, setStars] = useState(5);\n  const [hoveredStars, setHoveredStars] = useState(0);\n  const [comment, setComment] = useState(\"\");\n\n  const ratingMutation = useMutation({\n    mutationFn: async (data: { stars: number; comment?: string }) => {\n      const response = await fetch(`/api/orders/${orderId}/rate`, {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify(data),\n      });\n\n      if (!response.ok) {\n        throw new Error(\"Failed to submit rating\");\n      }\n\n      return response.json();\n    },\n    onSuccess: () => {\n      onSuccess?.();\n      onOpenChange(false);\n      setStars(5);\n      setComment(\"\");\n    },\n  });\n\n  const handleSubmit = () => {\n    ratingMutation.mutate({\n      stars,\n      comment: comment.trim() || undefined,\n    });\n  };\n\n  return (\n    <Dialog open={open} onOpenChange={onOpenChange}>\n      <DialogContent className=\"sm:max-w-[425px]\">\n        <DialogHeader>\n          <DialogTitle>Оцініть водія</DialogTitle>\n          <DialogDescription>\n            Як вам сподобалась поїздка з {driverName}?\n          </DialogDescription>\n        </DialogHeader>\n\n        <div className=\"space-y-4 py-4\">\n          <div className=\"flex justify-center gap-2\">\n            {[1, 2, 3, 4, 5].map((star) => (\n              <button\n                key={star}\n                type=\"button\"\n                onClick={() => setStars(star)}\n                onMouseEnter={() => setHoveredStars(star)}\n                onMouseLeave={() => setHoveredStars(0)}\n                className=\"transition-transform hover:scale-110 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 rounded\"\n              >\n                <Star\n                  className={`w-10 h-10 ${\n                    star <= (hoveredStars || stars)\n                      ? \"fill-yellow-400 text-yellow-400\"\n                      : \"text-gray-300\"\n                  }`}\n                />\n              </button>\n            ))}\n          </div>\n\n          <div className=\"text-center text-sm text-muted-foreground\">\n            {stars === 1 && \"Погано\"}\n            {stars === 2 && \"Незадовільно\"}\n            {stars === 3 && \"Нормально\"}\n            {stars === 4 && \"Добре\"}\n            {stars === 5 && \"Відмінно\"}\n          </div>\n\n          <div className=\"space-y-2\">\n            <label htmlFor=\"comment\" className=\"text-sm font-medium\">\n              Коментар (опціонально)\n            </label>\n            <Textarea\n              id=\"comment\"\n              placeholder=\"Розкажіть про ваш досвід...\"\n              value={comment}\n              onChange={(e) => setComment(e.target.value)}\n              rows={4}\n              maxLength={500}\n            />\n            <p className=\"text-xs text-muted-foreground text-right\">\n              {comment.length}/500\n            </p>\n          </div>\n        </div>\n\n        <DialogFooter>\n          <Button\n            variant=\"outline\"\n            onClick={() => onOpenChange(false)}\n            disabled={ratingMutation.isPending}\n          >\n            Скасувати\n          </Button>\n          <Button\n            onClick={handleSubmit}\n            disabled={ratingMutation.isPending}\n          >\n            {ratingMutation.isPending ? \"Відправка...\" : \"Відправити оцінку\"}\n          </Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  );\n}\n","size_bytes":4189}},"version":2}